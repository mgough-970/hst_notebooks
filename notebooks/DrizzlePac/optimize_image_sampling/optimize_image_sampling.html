

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Optimizing the Image Sampling &#8212; HST Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/DrizzlePac/optimize_image_sampling/optimize_image_sampling';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Using updated astrometry solutions" href="../using_updated_astrometry_solutions/using_updated_astrometry_solutions.html" />
    <link rel="prev" title="Satellite Trail Masking Techniques" href="../mask_satellite/mask_satellite.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    STScI Notebook Repository Template
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ACS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ACS/README.html">ACS Notebooks</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_findsat_mrt/acs_findsat_mrt_example.html">Satellite trail detection in ACS/WFC data using acstools.findsat_mrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_saturation_trails/acs_saturation_trails.html">ACS Linearity with Saturated Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_cte_forward_model/acs_cte_forward_model_example.html">Pixel-based ACS/WFC CTE Forward Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_subarrays/acs_subarrays.html">ACS Image Reduction for Subarray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_sbc_dark_analysis/acs_sbc_dark_analysis.html">SBC Dark Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_reduction/acs_reduction.html">ACS/WFC Image Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_pixel_area_maps/acs_pixel_area_maps.html">Obtaining Pixel Area Maps for ACS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_polarization_tools/acs_polarization_tools.html">Using ACS Polarization Tools</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../COS/README.html">COS Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/Setup/Setup.html">Setting up your computer environment for working with COS data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/DataDl/DataDl.html">Downloading COS Data</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../COS/ViewData/ViewData.html">Viewing COS Data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/AsnFile/AsnFile.html">Modifying or Creating an Association File</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/CalCOS/CalCOS.html">Running the COS Data Pipeline (<code class="docutils literal notranslate"><span class="pre">CalCOS</span></code>)</a></li>






<li class="toctree-l1"><a class="reference internal" href="../../COS/SplitTag/SplitTag.html">Splitting COS Exposures into sub-exposures with <code class="docutils literal notranslate"><span class="pre">splittag</span></code></a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/DayNight/DayNight.html">Filtering out COS Data taken during the Day or Night</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/LSF/LSF.html">Working with the COS Line Spread Function (LSF)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../COS/Extract/Extract.html">Editing the extraction boxes in a spectral extraction file (<code class="docutils literal notranslate"><span class="pre">XTRACTAB</span></code>)</a></li>







</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DrizzlePac</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">DrizzlePac Jupyter Notebook Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Initialization/Initialization.html">DrizzlePac Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../align_to_catalogs/align_to_catalogs.html">Aligning HST images to an absolute reference catalog</a></li>



<li class="toctree-l1"><a class="reference internal" href="../align_multiple_visits/align_multiple_visits.html">Optimizing Image Alignment for Multiple HST Visits</a></li>

<li class="toctree-l1"><a class="reference internal" href="../align_sparse_fields/align_sparse_fields.html">Aligning Deep Exposures of Sparse Fields</a></li>








<li class="toctree-l1"><a class="reference internal" href="../drizzle_wfpc2/drizzle_wfpc2.html">Drizzling WFPC2 Images to use a Single Zeropoint</a></li>

<li class="toctree-l1"><a class="reference internal" href="../mask_satellite/mask_satellite.html">Satellite Trail Masking Techniques</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Optimizing the Image Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_updated_astrometry_solutions/using_updated_astrometry_solutions.html">Using updated astrometry solutions</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NICMOS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NICMOS/nicmos_unit_conversion/nicmos_unit_conversion.html">Programmatic Replacements for NICMOS Units Conversion Form</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STIS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../STIS/README.html">STIS-Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/view_data/view_data.html">Viewing STIS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/extraction/1D_Extraction.html">1D Spectra Extraction <a class="tocSkip"></a></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/hst_notebooks/blob/main/notebooks/DrizzlePac/optimize_image_sampling/optimize_image_sampling.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/DrizzlePac/optimize_image_sampling/optimize_image_sampling.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/DrizzlePac/optimize_image_sampling/optimize_image_sampling.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Optimizing the Image Sampling</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-the-data">1. Description of the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dithering">2. Dithering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#drizzling">3. Drizzling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#results">4. Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizing-the-final-pixfrac-parameter">5. Optimizing the <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> parameter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-thoughts">6. Final thoughts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="optimizing-the-image-sampling">
<h1>Optimizing the Image Sampling<a class="headerlink" href="#optimizing-the-image-sampling" title="Permalink to this heading">#</a></h1>
<div class="alert-danger">Note: The notebook in this repository 'Initialization.ipynb' goes over many of the basic concepts such as the setup of the environment/package installation and should be read first if you are new to HST images, DrizzlePac, or Astroquery.</div><section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>This example was written to help users better understand the subtleties in improving image sampling for dithered data. One of the powers of the <em>drizzling</em> algorithm is that, given properly dithered images, it can restore much of the information lost due to undersampled images (<a class="reference external" href="http://iopscience.iop.org/article/10.1086/338393/pdf">Fruchter and Hook, 2002</a>).</p>
<p>This work is based on <a class="reference external" href="http://www.stsci.edu/hst/acs/documents/isrs/isr1501.pdf">ISR ACS 2015-01</a>, which contains a more detailed discussion than presented here.</p>
<p>In practice, this requires the use of <code class="docutils literal notranslate"><span class="pre">Astrodrizzle</span></code> task within the <em>Drizzlepac</em> package. This example will cover the following topics:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. Description of the Data
2. Run astrodrizzle several times using different settings for the &#39;final_pixfrac&#39; and &#39;final_scale&#39; parameters
3. Compare and evaluate results of using different &#39;final_pixfrac&#39; and &#39;final_scale&#39; values
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astroquery.mast</span> <span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">LogStretch</span><span class="p">,</span><span class="n">ImageNormalize</span><span class="p">,</span><span class="n">LinearStretch</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">wcs</span>
<span class="kn">import</span> <span class="nn">drizzlepac</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following task in the stsci.skypac package can be run with TEAL:
                                    skymatch                                    
The following tasks in the drizzlepac package can be run with TEAL:
    astrodrizzle       config_testbed      imagefindpars           mapreg       
       photeq            pixreplace           pixtopix            pixtosky      
  refimagefindpars       resetbits          runastrodriz          skytopix      
     tweakback            tweakreg           updatenpol
</pre></div>
</div>
</div>
</div>
</section>
<section id="description-of-the-data">
<h2>1. Description of the data<a class="headerlink" href="#description-of-the-data" title="Permalink to this heading">#</a></h2>
<p>Four images of the spiral galaxy NGC 3370 (Program 11570) were acquired using the WFC3/IR F160W imaging filter. The <code class="docutils literal notranslate"><span class="pre">WFC3-IR-DITHERBOX-MIN</span></code> dither pattern designed to provide optimal sampling of the PSF was used.</p>
<p>Data are downloaded using the <code class="docutils literal notranslate"><span class="pre">astroquery</span></code> API to access the <a class="reference external" href="http://archive.stsci.edu">MAST</a> archive. The <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code> <a class="reference external" href="http://astroquery.readthedocs.io/en/latest/mast/mast.html">documentation</a> has more examples for how to find and download data from MAST. For this example, the caibrated FLT exposures from visit 19 will be downloaded.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Querying MAST and downloading files.</span>
<span class="n">obs_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ib1f19010&#39;</span><span class="p">]</span>
<span class="n">obs_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="n">obs_ids</span><span class="p">,</span> <span class="n">obstype</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

<span class="n">download_tab</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">obs_table</span><span class="p">[</span><span class="s1">&#39;obsid&#39;</span><span class="p">],</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FLT&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits to ./mastDownload/HST/hst_11570_19_wfc3_ir_f160w_ib1f19l6/hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits to ./mastDownload/HST/hst_11570_19_wfc3_ir_f160w_ib1f19l7/hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits to ./mastDownload/HST/hst_11570_19_wfc3_ir_f160w_ib1f19l9/hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits to ./mastDownload/HST/hst_11570_19_wfc3_ir_f160w_ib1f19la/hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ib1f19l6q_flt.fits to ./mastDownload/HST/ib1f19l6q/ib1f19l6q_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ib1f19l7q_flt.fits to ./mastDownload/HST/ib1f19l7q/ib1f19l7q_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ib1f19l9q_flt.fits to ./mastDownload/HST/ib1f19l9q/ib1f19l9q_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ib1f19laq_flt.fits to ./mastDownload/HST/ib1f19laq/ib1f19laq_flt.fits ... [Done]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cleaning up directories after dowloading from MAST</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">download_tab</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">]:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
        
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s1">&#39;mastDownload&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dithering">
<h2>2. Dithering<a class="headerlink" href="#dithering" title="Permalink to this heading">#</a></h2>
<p>For the <em>drizzle</em> algorithm to work optimally, observations need to be dithered so that the PSF is optimally sampled. The code below creates plots to show the dithering of each of the images in the association. The plot on the left shows how the images were dithered on the sky (the POSTARG). The plot on the right shows how the offsets translate to pixel phase (e.g. subpixel position).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flt_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">)</span>

<span class="n">plate_scale</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getval</span><span class="p">(</span><span class="n">flt_files</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;idcscale&#39;</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Plate scale: </span><span class="si">{:&gt;6.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plate_scale</span><span class="p">))</span>
<span class="n">postarg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flt_files</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">postarg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flt_files</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">x_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flt_files</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">y_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flt_files</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">im</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flt_files</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
        <span class="n">postarg1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;postarg1&#39;</span><span class="p">]</span>
        <span class="n">postarg2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;postarg2&#39;</span><span class="p">]</span>
        <span class="n">x_phase</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">modf</span><span class="p">(</span><span class="n">postarg1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">plate_scale</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_phase</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">modf</span><span class="p">(</span><span class="n">postarg2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">plate_scale</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">postarg1</span><span class="p">,</span> <span class="n">postarg2</span><span class="p">,</span> <span class="s1">&#39;k+-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;arcsec&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;arcsec&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_phase</span><span class="p">,</span> <span class="n">y_phase</span><span class="p">,</span> <span class="s1">&#39;k+-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X pixel phase&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y pixel phase&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plate scale: 0.1283
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Y pixel phase&#39;)
</pre></div>
</div>
<img alt="../../../_images/39bd214a1e5da859b05b55d55817d79d6445b6ddc17a8cf92c77e98a6aadb287.png" src="../../../_images/39bd214a1e5da859b05b55d55817d79d6445b6ddc17a8cf92c77e98a6aadb287.png" />
</div>
</div>
</section>
<section id="drizzling">
<h2>3. Drizzling<a class="headerlink" href="#drizzling" title="Permalink to this heading">#</a></h2>
<p>Before drizzling can be performed, a plate scale for the output image should be chosen. This will usually be dictated by the science needs. In theory, critical sampling of a PSF occurs with 2.355 pixels. The FWHM of the WFC3/IR detector at 1600 nm is ~0.151” (Table 7.5 of <a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/handbooks/currentIHB/c07_ir07.html">WFC Instrument Handbook</a>). Using these values, a plate scale of 0.065”/pix will be selected for the drizzled output frame, approximately half of the native plate scale (0.1283”/pix).</p>
<p>The mechanism by which the <em>drizzle</em> algorithm improves sampling in the output image is by shrinking the input pixels before adding them to the output pixel grid (see Figure 2 in <a class="reference external" href="http://iopscience.iop.org/article/10.1086/338393/pdf">Fruchter and Hook (2002)</a>). In practice this process is controlled in the <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> package by adjusting the <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> parameter, which is the fractional size of the pixel to be used.
Below <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> is called twice. The first time, no changes are made to the plate scale or the size of the drop. In the second call, the plate scale and pixfrac are reduced. For a four point dither stack, a <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value of 0.8 is usually optimal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drizzlepac</span><span class="o">.</span><span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">,</span>
                                     <span class="n">output</span><span class="o">=</span><span class="s1">&#39;f160w_noopt&#39;</span><span class="p">,</span>
                                     <span class="n">runfile</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                     <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">build</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">driz_sep_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                     <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                     <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">final_rot</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="n">drizzlepac</span><span class="o">.</span><span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">,</span>
                                     <span class="n">output</span><span class="o">=</span><span class="s1">&#39;f160w_opt&#39;</span><span class="p">,</span>
                                     <span class="n">runfile</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                     <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">build</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">driz_sep_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                     <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                     <span class="n">final_pixfrac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                                     <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">final_rot</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                                     <span class="n">final_scale</span><span class="o">=</span><span class="mf">0.065</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:43:53.62 (14/08/2023)

==== Processing Step  Initialization  started at  19:43:53.62 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 591.9026595871557  535.7285496201226  
CD1_1 CD1_2  : -3.5625000794728566e-05  5.66450129404238e-22  
CD2_1 CD2_2  : 3.1747003373918613e-22  3.5625000794728566e-05  
NAXIS : 1184  1072
********************************************************************************
*
*  Estimated memory usage:  up to 44 Mb.
*  Output image size:       1184 X 1072 pixels. 
*  Output image file:       ~ 14 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:43:55.608 (14/08/2023)
==== Processing Step  Static Mask  started at  19:43:55.609 (14/08/2023)

==== Processing Step Static Mask finished at 19:43:55.868 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:43:55.869 (14/08/2023)

***** skymatch started on 2023-08-14 19:43:56.061218
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:43:56.619219
TOTAL RUN TIME: 0:00:00.558001
==== Processing Step Subtract Sky finished at 19:43:56.81 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:43:56.812 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits 
hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_wht.fitsWriting out image to disk:
 ib1f19l6q_single_wht.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits-Generating simple FITS output: ib1f19l9q_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Writing out image to disk: Writing out image to disk:ib1f19laq_single_sci.fits
 ib1f19l9q_single_sci.fits
Writing out image to disk: Writing out image to disk:ib1f19laq_single_wht.fits 
ib1f19l9q_single_wht.fits
==== Processing Step Separate Drizzle finished at 19:44:00.890 (14/08/2023)
==== Processing Step  Create Median  started at  19:44:00.891 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_noopt_med.fits&#39;
==== Processing Step Create Median finished at 19:44:01.732 (14/08/2023)
==== Processing Step  Blot  started at  19:44:01.73 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:44:04.44 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:44:04.442 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:44:08.913 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:44:08.932 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 591.9026595871557  535.7285496201226  
CD1_1 CD1_2  : -3.5625000794728566e-05  5.66450129404238e-22  
CD2_1 CD2_2  : 3.1747003373918613e-22  3.5625000794728566e-05  
NAXIS : 1184  1072
-Generating multi-extension output file:  f160w_noopt_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_noopt_drz.fits
==== Processing Step Final Drizzle finished at 19:44:13.934 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:44:13.935 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.9812 sec.
            Static Mask          0.2590 sec.
           Subtract Sky          0.9422 sec.
       Separate Drizzle          4.0777 sec.
          Create Median          0.8408 sec.
                   Blot          2.7085 sec.
                Driz_CR          4.4711 sec.
          Final Drizzle          5.0016 sec.
   ====================          ====================
                  Total          20.2820 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:44:14.014 (14/08/2023)

==== Processing Step  Initialization  started at  19:44:14.01 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:44:16.05 (14/08/2023)
==== Processing Step  Static Mask  started at  19:44:16.054 (14/08/2023)

==== Processing Step Static Mask finished at 19:44:16.29 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:44:16.293 (14/08/2023)

***** skymatch started on 2023-08-14 19:44:16.479238
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:44:17.008261
TOTAL RUN TIME: 0:00:00.529023
==== Processing Step Subtract Sky finished at 19:44:17.204 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:44:17.205 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits 
hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_wht.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
==== Processing Step Separate Drizzle finished at 19:44:21.276 (14/08/2023)
==== Processing Step  Create Median  started at  19:44:21.27 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_opt_med.fits&#39;
==== Processing Step Create Median finished at 19:44:22.052 (14/08/2023)
==== Processing Step  Blot  started at  19:44:22.053 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:44:24.768 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:44:24.769 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:44:29.161 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:44:29.177 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_opt_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_opt_drz.fits
==== Processing Step Final Drizzle finished at 19:44:35.510 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:44:35.511 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          2.0389 sec.
            Static Mask          0.2387 sec.
           Subtract Sky          0.9110 sec.
       Separate Drizzle          4.0704 sec.
          Create Median          0.7753 sec.
                   Blot          2.7154 sec.
                Driz_CR          4.3922 sec.
          Final Drizzle          6.3335 sec.
   ====================          ====================
                  Total          21.4753 sec.

No trailer file saved...
</pre></div>
</div>
</div>
</div>
</section>
<section id="results">
<h2>4. Results<a class="headerlink" href="#results" title="Permalink to this heading">#</a></h2>
<p>The drizzled science and weight images produced from the first call to AstroDrizzle with no optimization of the plate scale and pixfrac are plotted below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;f160w_noopt_drz.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
    <span class="n">im1wcs</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
    <span class="n">sci1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wht1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
        
<span class="n">norm1</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">sci1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="n">LogStretch</span><span class="p">())</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">im1wcs</span><span class="p">})</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci1</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wht1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f4dd73d44d0&gt;
</pre></div>
</div>
<img alt="../../../_images/d3434c4d59802cf620615fe2ebe3b3776812b7d8a896a3d246bc05a893375e6c.png" src="../../../_images/d3434c4d59802cf620615fe2ebe3b3776812b7d8a896a3d246bc05a893375e6c.png" />
</div>
</div>
<p>The drizzled science image is on the left and the associated weight image is on the right, both without optimization of the plate scale and pixfrac.</p>
<p>To compare, the figure plotted below shows close ups of the same part of the sky from the two drizzled products.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radeclims</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">pixel_to_skycoord</span><span class="p">([</span><span class="mi">825</span><span class="p">,</span> <span class="mi">875</span><span class="p">],</span> <span class="p">[</span><span class="mi">930</span><span class="p">,</span> <span class="mi">980</span><span class="p">],</span> <span class="n">im1wcs</span><span class="p">)</span>

<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;f160w_opt_drz.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
    <span class="n">im2wcs</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
    <span class="n">sci2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wht2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">norm2</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">sci2</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="n">LogStretch</span><span class="p">())</span>
    
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">im1wcs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci1</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im1wcs</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im1wcs</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">im2wcs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im2wcs</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im2wcs</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>                  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1835.4481178795015, 1934.1019662338267)
</pre></div>
</div>
<img alt="../../../_images/bb33ce31dee034f45849d5197298d63e627c55fcfd641800a553ff174ef8cdb7.png" src="../../../_images/bb33ce31dee034f45849d5197298d63e627c55fcfd641800a553ff174ef8cdb7.png" />
</div>
</div>
<p>The image on the left is without improved plate scale and pixfrac, and shows that the detector undersamples the PSF. The image on the right is the image with improved parameters where the resolution is greatly improved.</p>
</section>
<section id="optimizing-the-final-pixfrac-parameter">
<h2>5. Optimizing the <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> parameter<a class="headerlink" href="#optimizing-the-final-pixfrac-parameter" title="Permalink to this heading">#</a></h2>
<p>While the optimized <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> in the example above was chosen from experience with using a four-point dither, the value that should be used is not known <em>a priori</em>. The value could be different depending on several factors. For example, if the number of images is greater than four, the value used for <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> could be smaller since more images are available to fill in holes in the output grid. On the other hand, it is possible that no dithering was used during the observations. In that case, <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> should be left at 1.0, since shrinking the size of the drop could be detrimental.</p>
<p>Below, a series of experiments will be run to determine the best <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value for the selected output plate scale, by varying pixfrac in steps of 0.1 over a range of values from 0.1 to 1.0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pixfracs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pixfrac</span> <span class="ow">in</span> <span class="n">pixfracs</span><span class="p">:</span>
    <span class="n">outname</span> <span class="o">=</span> <span class="s1">&#39;f160w_</span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pixfrac</span><span class="p">)</span>
    <span class="n">drizzlepac</span><span class="o">.</span><span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">,</span>
                                         <span class="n">output</span><span class="o">=</span><span class="n">outname</span><span class="p">,</span>
                                         <span class="n">runfile</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                         <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                         <span class="n">build</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                         <span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">driz_sep_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                         <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                         <span class="n">final_pixfrac</span><span class="o">=</span><span class="n">pixfrac</span><span class="p">,</span>
                                         <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">final_rot</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                                         <span class="n">final_scale</span><span class="o">=</span><span class="mf">0.065</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:44:38.579 (14/08/2023)

==== Processing Step  Initialization  started at  19:44:38.579 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:44:40.548 (14/08/2023)
==== Processing Step  Static Mask  started at  19:44:40.54 (14/08/2023)

==== Processing Step Static Mask finished at 19:44:40.76 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:44:40.76 (14/08/2023)

***** skymatch started on 2023-08-14 19:44:40.942959
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:44:41.449426
TOTAL RUN TIME: 0:00:00.506467
==== Processing Step Subtract Sky finished at 19:44:41.631 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:44:41.632 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]Deleted all instances of WCS with key C in extensions [0]

Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits-Generating simple FITS output: ib1f19l6q_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fitsWriting out image to disk:
 ib1f19l7q_single_wht.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: Writing out image to disk:ib1f19l9q_single_sci.fits ib1f19laq_single_sci.fits

Writing out image to disk:Writing out image to disk:  ib1f19l9q_single_wht.fitsib1f19laq_single_wht.fits

==== Processing Step Separate Drizzle finished at 19:44:45.712 (14/08/2023)
==== Processing Step  Create Median  started at  19:44:45.715 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.1_med.fits&#39;
==== Processing Step Create Median finished at 19:44:46.499 (14/08/2023)
==== Processing Step  Blot  started at  19:44:46.50 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:44:49.380 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:44:49.381 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fitsCreating output: ib1f19l6q_sci1_crmask.fits

Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:44:53.801 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:44:53.824 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.1_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.1_drz.fits
==== Processing Step Final Drizzle finished at 19:44:58.048 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:44:58.049 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.9690 sec.
            Static Mask          0.2185 sec.
           Subtract Sky          0.8629 sec.
       Separate Drizzle          4.0799 sec.
          Create Median          0.7843 sec.
                   Blot          2.8805 sec.
                Driz_CR          4.4200 sec.
          Final Drizzle          4.2242 sec.
   ====================          ====================
                  Total          19.4394 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:44:58.131 (14/08/2023)

==== Processing Step  Initialization  started at  19:44:58.131 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:45:00.188 (14/08/2023)
==== Processing Step  Static Mask  started at  19:45:00.189 (14/08/2023)

==== Processing Step Static Mask finished at 19:45:00.420 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:45:00.421 (14/08/2023)

***** skymatch started on 2023-08-14 19:45:00.612821
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:45:01.153534
TOTAL RUN TIME: 0:00:00.540713
==== Processing Step Subtract Sky finished at 19:45:01.37 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:45:01.373 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk:Writing out image to disk:  hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fitshst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits

Writing out image to disk:Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
 hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 19:45:05.465 (14/08/2023)
==== Processing Step  Create Median  started at  19:45:05.467 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.2_med.fits&#39;
==== Processing Step Create Median finished at 19:45:06.234 (14/08/2023)
==== Processing Step  Blot  started at  19:45:06.235 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:45:08.952 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:45:08.953 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:45:13.375 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:45:13.393 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.2_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.2_drz.fits
==== Processing Step Final Drizzle finished at 19:45:18.113 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:45:18.114 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          2.0572 sec.
            Static Mask          0.2309 sec.
           Subtract Sky          0.9513 sec.
       Separate Drizzle          4.0924 sec.
          Create Median          0.7670 sec.
                   Blot          2.7176 sec.
                Driz_CR          4.4220 sec.
          Final Drizzle          4.7203 sec.
   ====================          ====================
                  Total          19.9587 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:45:18.194 (14/08/2023)

==== Processing Step  Initialization  started at  19:45:18.194 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:45:20.117 (14/08/2023)
==== Processing Step  Static Mask  started at  19:45:20.118 (14/08/2023)

==== Processing Step Static Mask finished at 19:45:20.365 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:45:20.366 (14/08/2023)

***** skymatch started on 2023-08-14 19:45:20.561423
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:45:21.114970
TOTAL RUN TIME: 0:00:00.553547
==== Processing Step Subtract Sky finished at 19:45:21.494 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:45:21.495 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk:Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits

Writing out image to disk: Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
 hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk:Writing out image to disk:  ib1f19l6q_single_wht.fitsib1f19l7q_single_wht.fits

-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 19:45:25.579 (14/08/2023)
==== Processing Step  Create Median  started at  19:45:25.580 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.3_med.fits&#39;
==== Processing Step Create Median finished at 19:45:26.36 (14/08/2023)
==== Processing Step  Blot  started at  19:45:26.365 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:45:29.108 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:45:29.109 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:45:33.521 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:45:33.545 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.3_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.3_drz.fits
==== Processing Step Final Drizzle finished at 19:45:38.478 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:45:38.479 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.9233 sec.
            Static Mask          0.2470 sec.
           Subtract Sky          1.1276 sec.
       Separate Drizzle          4.0839 sec.
          Create Median          0.7844 sec.
                   Blot          2.7430 sec.
                Driz_CR          4.4118 sec.
          Final Drizzle          4.9333 sec.
   ====================          ====================
                  Total          20.2543 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:45:38.562 (14/08/2023)

==== Processing Step  Initialization  started at  19:45:38.562 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:45:40.543 (14/08/2023)
==== Processing Step  Static Mask  started at  19:45:40.544 (14/08/2023)

==== Processing Step Static Mask finished at 19:45:40.782 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:45:40.782 (14/08/2023)

***** skymatch started on 2023-08-14 19:45:40.971674
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:45:41.524240
TOTAL RUN TIME: 0:00:00.552566
==== Processing Step Subtract Sky finished at 19:45:41.718 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:45:41.719 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk:Writing out image to disk:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fitshst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits

Writing out image to disk: Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fitshst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits

-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk:Deleted all instances of WCS with key C in extensions [0] hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits

Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits-Generating simple FITS output: ib1f19l7q_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Writing out image to disk: ib1f19l9q_single_sci.fitsDeleted all instances of WCS with key B in extensions [0]

Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 19:45:45.800 (14/08/2023)
==== Processing Step  Create Median  started at  19:45:45.802 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.4_med.fits&#39;
==== Processing Step Create Median finished at 19:45:46.606 (14/08/2023)
==== Processing Step  Blot  started at  19:45:46.607 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:45:49.553 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:45:49.554 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:45:53.95 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:45:53.968 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.4_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.4_drz.fits
==== Processing Step Final Drizzle finished at 19:45:58.917 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:45:58.918 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.9806 sec.
            Static Mask          0.2380 sec.
           Subtract Sky          0.9356 sec.
       Separate Drizzle          4.0816 sec.
          Create Median          0.8042 sec.
                   Blot          2.9466 sec.
                Driz_CR          4.3972 sec.
          Final Drizzle          4.9490 sec.
   ====================          ====================
                  Total          20.3327 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:45:59.003 (14/08/2023)

==== Processing Step  Initialization  started at  19:45:59.003 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:46:01.11 (14/08/2023)
==== Processing Step  Static Mask  started at  19:46:01.116 (14/08/2023)

==== Processing Step Static Mask finished at 19:46:01.363 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:46:01.364 (14/08/2023)

***** skymatch started on 2023-08-14 19:46:01.556278
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:46:02.102459
TOTAL RUN TIME: 0:00:00.546181
==== Processing Step Subtract Sky finished at 19:46:02.292 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:46:02.29 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]Deleted all instances of WCS with key C in extensions [0]

Writing out image to disk:Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits 
hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk:Writing out image to disk:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits-Generating simple FITS output: ib1f19l7q_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key B in extensions [0]Writing out image to disk: Writing out image to disk:ib1f19l7q_single_sci.fits
 ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 19:46:06.39 (14/08/2023)
==== Processing Step  Create Median  started at  19:46:06.399 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.5_med.fits&#39;
==== Processing Step Create Median finished at 19:46:07.181 (14/08/2023)
==== Processing Step  Blot  started at  19:46:07.181 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:46:09.906 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:46:09.907 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:46:14.320 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:46:14.340 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.5_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.5_drz.fits
==== Processing Step Final Drizzle finished at 19:46:19.653 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:46:19.654 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          2.1113 sec.
            Static Mask          0.2472 sec.
           Subtract Sky          0.9283 sec.
       Separate Drizzle          4.1048 sec.
          Create Median          0.7819 sec.
                   Blot          2.7248 sec.
                Driz_CR          4.4130 sec.
          Final Drizzle          5.3131 sec.
   ====================          ====================
                  Total          20.6245 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:46:19.740 (14/08/2023)

==== Processing Step  Initialization  started at  19:46:19.74 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:46:21.799 (14/08/2023)
==== Processing Step  Static Mask  started at  19:46:21.800 (14/08/2023)

==== Processing Step Static Mask finished at 19:46:22.045 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:46:22.046 (14/08/2023)

***** skymatch started on 2023-08-14 19:46:22.243649
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:46:22.794266
TOTAL RUN TIME: 0:00:00.550617
==== Processing Step Subtract Sky finished at 19:46:22.996 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:46:22.997 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: Writing out image to disk: ib1f19l6q_single_sci.fits
ib1f19l7q_single_sci.fits
Writing out image to disk: Writing out image to disk:ib1f19l6q_single_wht.fits 
ib1f19l7q_single_wht.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 19:46:27.076 (14/08/2023)
==== Processing Step  Create Median  started at  19:46:27.078 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.6_med.fits&#39;
==== Processing Step Create Median finished at 19:46:27.858 (14/08/2023)
==== Processing Step  Blot  started at  19:46:27.858 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:46:30.562 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:46:30.56 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:46:34.956 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:46:34.97 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.6_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.6_drz.fits
==== Processing Step Final Drizzle finished at 19:46:40.543 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:46:40.544 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          2.0579 sec.
            Static Mask          0.2455 sec.
           Subtract Sky          0.9498 sec.
       Separate Drizzle          4.0796 sec.
          Create Median          0.7801 sec.
                   Blot          2.7040 sec.
                Driz_CR          4.3929 sec.
          Final Drizzle          5.5695 sec.
   ====================          ====================
                  Total          20.7792 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:46:40.621 (14/08/2023)

==== Processing Step  Initialization  started at  19:46:40.621 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:46:42.462 (14/08/2023)
==== Processing Step  Static Mask  started at  19:46:42.463 (14/08/2023)

==== Processing Step Static Mask finished at 19:46:42.689 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:46:42.690 (14/08/2023)

***** skymatch started on 2023-08-14 19:46:42.879081
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:46:43.406661
TOTAL RUN TIME: 0:00:00.527580
==== Processing Step Subtract Sky finished at 19:46:43.6 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:46:43.60 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]Deleted all instances of WCS with key C in extensions [0]

Writing out image to disk:Writing out image to disk:  hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fitshst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits

Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 19:46:47.682 (14/08/2023)
==== Processing Step  Create Median  started at  19:46:47.684 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.7_med.fits&#39;
==== Processing Step Create Median finished at 19:46:48.429 (14/08/2023)
==== Processing Step  Blot  started at  19:46:48.430 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:46:51.250 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:46:51.250 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:46:55.66 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:46:55.681 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.7_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.7_drz.fits
==== Processing Step Final Drizzle finished at 19:47:01.487 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:47:01.48 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.8407 sec.
            Static Mask          0.2264 sec.
           Subtract Sky          0.9118 sec.
       Separate Drizzle          4.0797 sec.
          Create Median          0.7458 sec.
                   Blot          2.8195 sec.
                Driz_CR          4.4147 sec.
          Final Drizzle          5.8059 sec.
   ====================          ====================
                  Total          20.8445 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:47:01.579 (14/08/2023)

==== Processing Step  Initialization  started at  19:47:01.580 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:47:03.731 (14/08/2023)
==== Processing Step  Static Mask  started at  19:47:03.732 (14/08/2023)

==== Processing Step Static Mask finished at 19:47:03.974 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:47:03.974 (14/08/2023)

***** skymatch started on 2023-08-14 19:47:04.167644
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:47:04.711875
TOTAL RUN TIME: 0:00:00.544231
==== Processing Step Subtract Sky finished at 19:47:04.903 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:47:04.90 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Writing out image to disk:
 ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l9q_single_wht.fitsWriting out image to disk: ib1f19laq_single_wht.fits

==== Processing Step Separate Drizzle finished at 19:47:08.988 (14/08/2023)
==== Processing Step  Create Median  started at  19:47:08.989 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.8_med.fits&#39;
==== Processing Step Create Median finished at 19:47:09.777 (14/08/2023)
==== Processing Step  Blot  started at  19:47:09.777 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:47:12.682 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:47:12.683 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:47:17.122 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:47:17.14 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.8_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.8_drz.fits
==== Processing Step Final Drizzle finished at 19:47:23.179 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:47:23.179 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          2.1519 sec.
            Static Mask          0.2412 sec.
           Subtract Sky          0.9287 sec.
       Separate Drizzle          4.0840 sec.
          Create Median          0.7877 sec.
                   Blot          2.9050 sec.
                Driz_CR          4.4388 sec.
          Final Drizzle          6.0356 sec.
   ====================          ====================
                  Total          21.5728 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:47:23.269 (14/08/2023)

==== Processing Step  Initialization  started at  19:47:23.269 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:47:25.374 (14/08/2023)
==== Processing Step  Static Mask  started at  19:47:25.375 (14/08/2023)

==== Processing Step Static Mask finished at 19:47:25.613 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:47:25.614 (14/08/2023)

***** skymatch started on 2023-08-14 19:47:25.804362
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:47:26.360230
TOTAL RUN TIME: 0:00:00.555868
==== Processing Step Subtract Sky finished at 19:47:26.561 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:47:26.562 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fitsWriting out image to disk:
 hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key C in extensions [0]Deleted all instances of WCS with key C in extensions [0]

Writing out image to disk:Writing out image to disk:  hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fitshst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits

Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 19:47:30.642 (14/08/2023)
==== Processing Step  Create Median  started at  19:47:30.64 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.9_med.fits&#39;
==== Processing Step Create Median finished at 19:47:31.46 (14/08/2023)
==== Processing Step  Blot  started at  19:47:31.461 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:47:34.2 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:47:34.281 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:47:38.727 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:47:38.744 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.9_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.9_drz.fits
==== Processing Step Final Drizzle finished at 19:47:45.364 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:47:45.365 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          2.1049 sec.
            Static Mask          0.2379 sec.
           Subtract Sky          0.9470 sec.
       Separate Drizzle          4.0800 sec.
          Create Median          0.8173 sec.
                   Blot          2.8187 sec.
                Driz_CR          4.4460 sec.
          Final Drizzle          6.6202 sec.
   ====================          ====================
                  Total          22.0720 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 19:47:45.448 (14/08/2023)

==== Processing Step  Initialization  started at  19:47:45.448 (14/08/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 128 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         2
*
********************************************************************************
==== Processing Step Initialization finished at 19:47:47.445 (14/08/2023)
==== Processing Step  Static Mask  started at  19:47:47.446 (14/08/2023)

==== Processing Step Static Mask finished at 19:47:47.6 (14/08/2023)
==== Processing Step  Subtract Sky  started at  19:47:47.692 (14/08/2023)

***** skymatch started on 2023-08-14 19:47:47.893632
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-08-14 19:47:48.416591
TOTAL RUN TIME: 0:00:00.522959
==== Processing Step Subtract Sky finished at 19:47:48.607 (14/08/2023)
==== Processing Step  Separate Drizzle  started at  19:47:48.608 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
 Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Writing out image to disk:
 ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits-Generating simple FITS output: ib1f19laq_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l9q_single_wht.fitsWriting out image to disk:
 ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 19:47:52.690 (14/08/2023)
==== Processing Step  Create Median  started at  19:47:52.692 (14/08/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_1.0_med.fits&#39;
==== Processing Step Create Median finished at 19:47:53.435 (14/08/2023)
==== Processing Step  Blot  started at  19:47:53.436 (14/08/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 19:47:56.01 (14/08/2023)
==== Processing Step  Driz_CR  started at  19:47:56.014 (14/08/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 19:48:00.445 (14/08/2023)
==== Processing Step  Final Drizzle  started at  19:48:00.468 (14/08/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_1.0_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_1.0_drz.fits
==== Processing Step Final Drizzle finished at 19:48:07.561 (14/08/2023)

AstroDrizzle Version 3.5.1 is finished processing at 19:48:07.56 (14/08/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.9967 sec.
            Static Mask          0.2448 sec.
           Subtract Sky          0.9159 sec.
       Separate Drizzle          4.0819 sec.
          Create Median          0.7433 sec.
                   Blot          2.5780 sec.
                Driz_CR          4.4308 sec.
          Final Drizzle          7.0931 sec.
   ====================          ====================
                  Total          22.0846 sec.

No trailer file saved...
</pre></div>
</div>
</div>
</div>
<p>When evaluating what value to use for <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code>, <em>THERE IS NO SINGLE METRIC THAT INDICATES WHAT VALUE TO USE</em>, and several factors should be taken into account. The general philosophy is that the chosen value should improve the resolution of the image as much as possible, without causing any adverse effects.</p>
<p>The first thing to look for is an excessive number of holes in the science and weight images. The figure below shows the central region of the science and weight images produced by three different <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;f160w_0.1_drz.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu1</span><span class="p">:</span>
    <span class="n">sci1</span> <span class="o">=</span> <span class="n">hdu1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wht1</span> <span class="o">=</span> <span class="n">hdu1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;f160w_0.8_drz.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu2</span><span class="p">:</span>
    <span class="n">sci2</span> <span class="o">=</span> <span class="n">hdu2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wht2</span> <span class="o">=</span> <span class="n">hdu2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;f160w_1.0_drz.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu3</span><span class="p">:</span>
    <span class="n">sci3</span> <span class="o">=</span> <span class="n">hdu3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wht3</span> <span class="o">=</span> <span class="n">hdu3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">norm3</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">wht2</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="n">LinearStretch</span><span class="p">())</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci1</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1640</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="s1">&#39;final_pixfrac=0.1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1640</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="s1">&#39;final_pixfrac=0.8&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci3</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1640</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="s1">&#39;final_pixfrac=1.0&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wht1</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wht2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wht3</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im2wcs</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im2wcs</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1835.4481178795015, 1934.1019662338267)
</pre></div>
</div>
<img alt="../../../_images/dfce71277cff4fa4c9bcd5fb85d179715bd18de4fc3440cc36f9c500b4f33f02.png" src="../../../_images/dfce71277cff4fa4c9bcd5fb85d179715bd18de4fc3440cc36f9c500b4f33f02.png" />
</div>
</div>
<p>This figure above shows the central region of the science and weight images produced by <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> values (left to right) of 0.1, 0.8 and 1.0. The top row is the science frame, the bottom is the weight image. The science image with the smallest <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value of 0.1 shows a noisy background and holes in the image where no input pixels fall into the output grid because pixfrac is too small. Inspection of the weight map corresponding to the smallest <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value shows many places with weights of zero, indicating that a <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value of 0.1 is clearly too small and was only included in this example for illustrative purposes.</p>
<p>Another piece of information that can be useful is the amount of noise in the weight image. As suggested in the <a class="reference external" href="http://www.stsci.edu/hst/HST_overview/documents/dither_handbook">HST Dither Handbook</a> Chapter 5 and in the <a class="reference external" href="http://documents.stsci.edu/hst/HST_overview/documents/DrizzlePac/ch64.html#586267">DrizzlePac Handbook</a> Section 6.3.3, statistics performed on the drizzled weight image should yield a RMS/median value less than ~0.2. This threshold controls the trade-off between improving image resolution versus increasing background noise due to pixel resampling.</p>
<p>The figure below shows the RMS/median as a function of <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code>. One should take care to use the same region in the weight image as the region where the object of interest is located in the science image. If one is using the entire image for scientific analysis, then one should measure the statistics of the weight image where there is more variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">whtlist</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;f160w_0.[0-9]*drz.fits&#39;</span><span class="p">)</span>

<span class="n">std_med</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">whtlist</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">fraclist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">whtlist</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">xlims</span> <span class="o">=</span> <span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im1wcs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">ylims</span> <span class="o">=</span> <span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im1wcs</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1">#Loop that measures statistics, also some information gathering</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">im</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">whtlist</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
        <span class="n">wht</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;TARGNAME&#39;</span><span class="p">]</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;D001SCAL&#39;</span><span class="p">])</span>
        <span class="n">nimg</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;NDRIZIM&#39;</span><span class="p">]</span>
    <span class="n">wht_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">wht</span><span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">wht_med</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">wht</span><span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">std_med</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">wht_std</span> <span class="o">/</span> <span class="n">wht_med</span>
    <span class="n">fraclist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;D001PIXF&#39;</span><span class="p">]</span>

<span class="c1">#Plotting commands              </span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.025</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.025</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fraclist</span><span class="p">,</span> <span class="n">std_med</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;pixfrac&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;rms/median&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="s1">&#39;Scale=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nimg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; images&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.1, 0.35, &#39;8 images&#39;)
</pre></div>
</div>
<img alt="../../../_images/13649411299d9298e8949eb6c1030e3295f5db78fdd4960a9a516a2c980f0377.png" src="../../../_images/13649411299d9298e8949eb6c1030e3295f5db78fdd4960a9a516a2c980f0377.png" />
</div>
</div>
<p>The RMS/median increases steadily up to pixfrac of 0.6, where there is a change in the slope of the function, indicating that something odd might be happening beyond that point. Even though the RMS remains below 20% of the median all the way to <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> of 0.1, the higher slope in the curve combined with the information from inspection of the science images themselvse (the evidence of holes) indicates that the pixfrac should remain &gt;0.6.</p>
</section>
<section id="final-thoughts">
<h2>6. Final thoughts<a class="headerlink" href="#final-thoughts" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value has to be small enough to avoid degrading the combined output image, but large enough that when all images are ”dropped” onto the final frame, coverage of the output frame is fairly uniform. In general, <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> should be slightly larger than the final output scale to allow some ”spillover” to adjacent pixels. This will help avoid ”holes” in the final product when a given pixel has been flagged as ”bad” in several frames. As a rule of thumb, statistics performed on the drizzled weight image in the region of interest should yield an RMS value (standard deviation) that is less than 20% of the median value. This threshold is a balance between the benefits of improving the image resolution at the expense of increasing noise in the background.</p>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this heading">#</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Author: R. Avila, STScI ACS Team  
Updated: December 12, 2018
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/hst_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/DrizzlePac/optimize_image_sampling"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../mask_satellite/mask_satellite.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Satellite Trail Masking Techniques</p>
      </div>
    </a>
    <a class="right-next"
       href="../using_updated_astrometry_solutions/using_updated_astrometry_solutions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Using updated astrometry solutions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-the-data">1. Description of the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dithering">2. Dithering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#drizzling">3. Drizzling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#results">4. Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizing-the-final-pixfrac-parameter">5. Optimizing the <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> parameter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-thoughts">6. Final thoughts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>