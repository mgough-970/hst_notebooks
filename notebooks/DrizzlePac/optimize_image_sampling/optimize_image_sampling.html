

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Optimizing the Image Sampling &#8212; HST Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/DrizzlePac/optimize_image_sampling/optimize_image_sampling';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Sky Matching" href="../sky_matching/sky_matching.html" />
    <link rel="prev" title="Satellite Trail Masking Techniques" href="../mask_satellite/mask_satellite.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="HST Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="HST Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    STScI HST Notebook Repository HQ
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ACS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ACS/README.html">ACS Notebooks</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_findsat_mrt/acs_findsat_mrt_example.html">Satellite trail detection in ACS/WFC data using acstools.findsat_mrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_saturation_trails/acs_saturation_trails.html">ACS Linearity with Saturated Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_cte_forward_model/acs_cte_forward_model_example.html">Pixel-based ACS/WFC CTE Forward Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_subarrays/acs_subarrays.html">ACS Image Reduction for Subarray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_sbc_dark_analysis/acs_sbc_dark_analysis.html">SBC Dark Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_reduction/acs_reduction.html">ACS/WFC Image Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_pixel_area_maps/acs_pixel_area_maps.html">Obtaining Pixel Area Maps for ACS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_polarization_tools/acs_polarization_tools.html">Using ACS Polarization Tools</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../COS/README.html">COS Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/Setup/Setup.html">Setting up your computer environment for working with COS data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/DataDl/DataDl.html">Downloading COS Data</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../COS/ViewData/ViewData.html">Viewing COS Data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/AsnFile/AsnFile.html">Modifying or Creating an Association File</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/CalCOS/CalCOS.html">Running the COS Data Pipeline (<code class="docutils literal notranslate"><span class="pre">CalCOS</span></code>)</a></li>






<li class="toctree-l1"><a class="reference internal" href="../../COS/SplitTag/SplitTag.html">Splitting COS Exposures into sub-exposures with <code class="docutils literal notranslate"><span class="pre">splittag</span></code></a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/DayNight/DayNight.html">Filtering out COS Data taken during the Day or Night</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/LSF/LSF.html">Working with the COS Line Spread Function (LSF)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../COS/Extract/Extract.html">Editing the extraction boxes in a spectral extraction file (<code class="docutils literal notranslate"><span class="pre">XTRACTAB</span></code>)</a></li>







</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DrizzlePac</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../README.html">DrizzlePac Jupyter Notebook Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Initialization/Initialization.html">DrizzlePac Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../align_to_catalogs/align_to_catalogs.html">Aligning HST images to an absolute reference catalog</a></li>



<li class="toctree-l1"><a class="reference internal" href="../align_multiple_visits/align_multiple_visits.html">Optimizing Image Alignment for Multiple HST Visits</a></li>

<li class="toctree-l1"><a class="reference internal" href="../align_sparse_fields/align_sparse_fields.html">Aligning Deep Exposures of Sparse Fields</a></li>








<li class="toctree-l1"><a class="reference internal" href="../drizzle_wfpc2/drizzle_wfpc2.html">Drizzling WFPC2 Images to use a Single Zeropoint</a></li>

<li class="toctree-l1"><a class="reference internal" href="../mask_satellite/mask_satellite.html">Satellite Trail Masking Techniques</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Optimizing the Image Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sky_matching/sky_matching.html">Sky Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use_ds9_regions_in_tweakreg/use_ds9_regions_in_tweakreg.html">Using DS9 Regions to Include and Exclude Sources in HST Image Alignment with TWEAKREG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_updated_astrometry_solutions/using_updated_astrometry_solutions.html">Using updated astrometry solutions</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HASP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../HASP/Setup/Setup.html">Inputting User Data using the Hubble Advanced Spectral Products Script</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NICMOS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NICMOS/nicmos_unit_conversion/nicmos_unit_conversion.html">Programmatic Replacements for NICMOS Units Conversion Form</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STIS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../STIS/README.html">STIS-Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/cross-correlation/cross-correlation.html">Correcting for Missing Wavecals with Cross-Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/custom_ccd_darks/custom_ccd_darks.html">Custom CCD Darks <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/drizpac_notebook/STIS_DrizzlePac_Tutorial.html">STIS DrizzlePac Tutorial <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/CoronagraphyViz/STIS_Coronagraphy_Visualization_v2.html">STIS Coronagraphy Visualization Tool (v2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/calstis/calstis_2d_ccd.html">Calstis 2-D CCD Data Reduction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/target_acquisition/target_acquisition.html">Evaluating STIS Target Acquisitions <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/view_data/view_data.html">Viewing STIS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/extraction/1D_Extraction.html">1D Spectra Extraction <a class="tocSkip"></a></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">WFC3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/README.html">WFC3 Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/calwf3_recalibration/calwf3_recal_tvb.html">Manual Recalibration with calwf3: Turning off the IR Linear Ramp Fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/calwf3_v1.0_cte/calwf3_with_v1.0_PCTE.html">Processing WFC3/UVIS Data with <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Using the v1.0 CTE-Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/exception_report/wfc3_exception_report.html">Exception Report Checklist - WFC3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/image_displayer_analyzer/wfc3_image_displayer_analyzer.html">WFC3 Image Displayer &amp; Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_ima_visualization/IR_IMA_Visualization_with_an_Example_of_Time_Variable_Background.html">WFC3/IR IMA Visualization Tools with An Example of Time Variable Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_scattered_light_calwf3_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_Using_calwf3_to_Mask_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Using <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> to Mask Bad Reads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_scattered_light_manual_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_by_Manually_Subtracting_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Manually Subtracting Bad Reads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/persistence/wfc3_ir_persistence.html">Masking Persistence in WFC3/IR Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/tvb_flattenramp/TVB_flattenramp_notebook.html">Correcting for Helium Line Emission Background in IR Exposures using the “Flatten-Ramp” Technique</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/photometry_examples/phot_examples.html">Synthetic Photometry Examples for WFC3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/uvis_pam_corrections/WFC3_UVIS_Pixel_Area_Map_Corrections_for_Subarrays.html">WFC3/UVIS Pixel Area Map Corrections for Subarrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/uvis_time_dependent_photometry/uvis_timedep_phot.html">WFC3/UVIS Time-dependent Photometry</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/hst_notebooks/blob/main/notebooks/DrizzlePac/optimize_image_sampling/optimize_image_sampling.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/DrizzlePac/optimize_image_sampling/optimize_image_sampling.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/DrizzlePac/optimize_image_sampling/optimize_image_sampling.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Optimizing the Image Sampling</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-the-data">1. Description of the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dithering">2. Dithering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#drizzling">3. Drizzling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#results">4. Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizing-the-final-pixfrac-parameter">5. Optimizing the <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> parameter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-thoughts">6. Final thoughts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="optimizing-the-image-sampling">
<h1>Optimizing the Image Sampling<a class="headerlink" href="#optimizing-the-image-sampling" title="Permalink to this heading">#</a></h1>
<div class="alert-danger">Note: The notebook in this repository 'Initialization.ipynb' goes over many of the basic concepts such as the setup of the environment/package installation and should be read first if you are new to HST images, DrizzlePac, or Astroquery.</div><section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>This example was written to help users better understand the subtleties in improving image sampling for dithered data. One of the powers of the <em>drizzling</em> algorithm is that, given properly dithered images, it can restore much of the information lost due to undersampled images (<a class="reference external" href="http://iopscience.iop.org/article/10.1086/338393/pdf">Fruchter and Hook, 2002</a>).</p>
<p>This work is based on <a class="reference external" href="http://www.stsci.edu/hst/acs/documents/isrs/isr1501.pdf">ISR ACS 2015-01</a>, which contains a more detailed discussion than presented here.</p>
<p>In practice, this requires the use of <code class="docutils literal notranslate"><span class="pre">Astrodrizzle</span></code> task within the <em>Drizzlepac</em> package. This example will cover the following topics:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1. Description of the Data
2. Run astrodrizzle several times using different settings for the &#39;final_pixfrac&#39; and &#39;final_scale&#39; parameters
3. Compare and evaluate results of using different &#39;final_pixfrac&#39; and &#39;final_scale&#39; values
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astroquery.mast</span> <span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">LogStretch</span><span class="p">,</span><span class="n">ImageNormalize</span><span class="p">,</span><span class="n">LinearStretch</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">wcs</span>
<span class="kn">import</span> <span class="nn">drizzlepac</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following task in the stsci.skypac package can be run with TEAL:
                                    skymatch                                    
The following tasks in the drizzlepac package can be run with TEAL:
    astrodrizzle       config_testbed      imagefindpars           mapreg       
       photeq            pixreplace           pixtopix            pixtosky      
  refimagefindpars       resetbits          runastrodriz          skytopix      
     tweakback            tweakreg           updatenpol
</pre></div>
</div>
</div>
</div>
</section>
<section id="description-of-the-data">
<h2>1. Description of the data<a class="headerlink" href="#description-of-the-data" title="Permalink to this heading">#</a></h2>
<p>Four images of the spiral galaxy NGC 3370 (Program 11570) were acquired using the WFC3/IR F160W imaging filter. The <code class="docutils literal notranslate"><span class="pre">WFC3-IR-DITHERBOX-MIN</span></code> dither pattern designed to provide optimal sampling of the PSF was used.</p>
<p>Data are downloaded using the <code class="docutils literal notranslate"><span class="pre">astroquery</span></code> API to access the <a class="reference external" href="http://archive.stsci.edu">MAST</a> archive. The <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code> <a class="reference external" href="http://astroquery.readthedocs.io/en/latest/mast/mast.html">documentation</a> has more examples for how to find and download data from MAST. For this example, the caibrated FLT exposures from visit 19 will be downloaded.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Querying MAST and downloading files.</span>
<span class="n">obs_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ib1f19010&#39;</span><span class="p">]</span>
<span class="n">obs_table</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span><span class="n">obs_id</span><span class="o">=</span><span class="n">obs_ids</span><span class="p">,</span> <span class="n">obstype</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

<span class="n">download_tab</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span><span class="n">obs_table</span><span class="p">[</span><span class="s1">&#39;obsid&#39;</span><span class="p">],</span> <span class="n">mrp_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;FLT&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits to ./mastDownload/HST/hst_11570_19_wfc3_ir_f160w_ib1f19l6/hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits to ./mastDownload/HST/hst_11570_19_wfc3_ir_f160w_ib1f19l7/hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits to ./mastDownload/HST/hst_11570_19_wfc3_ir_f160w_ib1f19l9/hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits to ./mastDownload/HST/hst_11570_19_wfc3_ir_f160w_ib1f19la/hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ib1f19l6q_flt.fits to ./mastDownload/HST/ib1f19l6q/ib1f19l6q_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ib1f19l7q_flt.fits to ./mastDownload/HST/ib1f19l7q/ib1f19l7q_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ib1f19l9q_flt.fits to ./mastDownload/HST/ib1f19l9q/ib1f19l9q_flt.fits ... [Done]
Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/ib1f19laq_flt.fits to ./mastDownload/HST/ib1f19laq/ib1f19laq_flt.fits ... [Done]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cleaning up directories after dowloading from MAST</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">download_tab</span><span class="p">[</span><span class="s1">&#39;Local Path&#39;</span><span class="p">]:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
        
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s1">&#39;mastDownload&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="dithering">
<h2>2. Dithering<a class="headerlink" href="#dithering" title="Permalink to this heading">#</a></h2>
<p>For the <em>drizzle</em> algorithm to work optimally, observations need to be dithered so that the PSF is optimally sampled. The code below creates plots to show the dithering of each of the images in the association. The plot on the left shows how the images were dithered on the sky (the POSTARG). The plot on the right shows how the offsets translate to pixel phase (e.g. subpixel position).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flt_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">)</span>

<span class="n">plate_scale</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getval</span><span class="p">(</span><span class="n">flt_files</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;idcscale&#39;</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Plate scale: </span><span class="si">{:&gt;6.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">plate_scale</span><span class="p">))</span>
<span class="n">postarg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flt_files</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">postarg2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flt_files</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">x_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flt_files</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="n">y_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flt_files</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">im</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">flt_files</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
        <span class="n">postarg1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;postarg1&#39;</span><span class="p">]</span>
        <span class="n">postarg2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;postarg2&#39;</span><span class="p">]</span>
        <span class="n">x_phase</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">modf</span><span class="p">(</span><span class="n">postarg1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">plate_scale</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y_phase</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">modf</span><span class="p">(</span><span class="n">postarg2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">plate_scale</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">postarg1</span><span class="p">,</span> <span class="n">postarg2</span><span class="p">,</span> <span class="s1">&#39;k+-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;arcsec&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;arcsec&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_phase</span><span class="p">,</span> <span class="n">y_phase</span><span class="p">,</span> <span class="s1">&#39;k+-&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X pixel phase&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y pixel phase&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;large&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plate scale: 0.1283
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Y pixel phase&#39;)
</pre></div>
</div>
<img alt="../../../_images/e3bad23fce80882f177f62be4ba80ec1066e417b6ae1d2878e2665e213638ab6.png" src="../../../_images/e3bad23fce80882f177f62be4ba80ec1066e417b6ae1d2878e2665e213638ab6.png" />
</div>
</div>
</section>
<section id="drizzling">
<h2>3. Drizzling<a class="headerlink" href="#drizzling" title="Permalink to this heading">#</a></h2>
<p>Before drizzling can be performed, a plate scale for the output image should be chosen. This will usually be dictated by the science needs. In theory, critical sampling of a PSF occurs with 2.355 pixels. The FWHM of the WFC3/IR detector at 1600 nm is ~0.151” (Table 7.5 of <a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/handbooks/currentIHB/c07_ir07.html">WFC Instrument Handbook</a>). Using these values, a plate scale of 0.065”/pix will be selected for the drizzled output frame, approximately half of the native plate scale (0.1283”/pix).</p>
<p>The mechanism by which the <em>drizzle</em> algorithm improves sampling in the output image is by shrinking the input pixels before adding them to the output pixel grid (see Figure 2 in <a class="reference external" href="http://iopscience.iop.org/article/10.1086/338393/pdf">Fruchter and Hook (2002)</a>). In practice this process is controlled in the <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> package by adjusting the <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> parameter, which is the fractional size of the pixel to be used.
Below <code class="docutils literal notranslate"><span class="pre">AstroDrizzle</span></code> is called twice. The first time, no changes are made to the plate scale or the size of the drop. In the second call, the plate scale and pixfrac are reduced. For a four point dither stack, a <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value of 0.8 is usually optimal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">drizzlepac</span><span class="o">.</span><span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">,</span>
                                     <span class="n">output</span><span class="o">=</span><span class="s1">&#39;f160w_noopt&#39;</span><span class="p">,</span>
                                     <span class="n">runfile</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                     <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">build</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">driz_sep_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                     <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                     <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">final_rot</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

<span class="n">drizzlepac</span><span class="o">.</span><span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">,</span>
                                     <span class="n">output</span><span class="o">=</span><span class="s1">&#39;f160w_opt&#39;</span><span class="p">,</span>
                                     <span class="n">runfile</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                     <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">build</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">driz_sep_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                     <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                     <span class="n">final_pixfrac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                                     <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">final_rot</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                                     <span class="n">final_scale</span><span class="o">=</span><span class="mf">0.065</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:13:48.226 (17/11/2023)

==== Processing Step  Initialization  started at  20:13:48.226 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 591.9026595871557  535.7285496201226  
CD1_1 CD1_2  : -3.5625000794728566e-05  5.66450129404238e-22  
CD2_1 CD2_2  : 3.1747003373918613e-22  3.5625000794728566e-05  
NAXIS : 1184  1072
********************************************************************************
*
*  Estimated memory usage:  up to 89 Mb.
*  Output image size:       1184 X 1072 pixels. 
*  Output image file:       ~ 14 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:13:49.350 (17/11/2023)
==== Processing Step  Static Mask  started at  20:13:49.351 (17/11/2023)

==== Processing Step Static Mask finished at 20:13:49.487 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:13:49.488 (17/11/2023)

***** skymatch started on 2023-11-17 20:13:49.588512
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:13:49.915085
TOTAL RUN TIME: 0:00:00.326573
==== Processing Step Subtract Sky finished at 20:13:50.014 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:13:50.015 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk:Deleted all instances of WCS with key C in extensions [0]Writing out image to disk:
 hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
 hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fitsWriting out image to disk:
 hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fitsWriting out image to disk:
 hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Deleted all instances of WCS with key B in extensions [0]Writing out image to disk:
 ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: Writing out image to disk:ib1f19l6q_single_wht.fits
 ib1f19l7q_single_wht.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:13:52.069 (17/11/2023)
==== Processing Step  Create Median  started at  20:13:52.070 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_noopt_med.fits&#39;
==== Processing Step Create Median finished at 20:13:52.523 (17/11/2023)
==== Processing Step  Blot  started at  20:13:52.523 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:13:54.079 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:13:54.079 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:13:56.372 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:13:56.383 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 591.9026595871557  535.7285496201226  
CD1_1 CD1_2  : -3.5625000794728566e-05  5.66450129404238e-22  
CD2_1 CD2_2  : 3.1747003373918613e-22  3.5625000794728566e-05  
NAXIS : 1184  1072
-Generating multi-extension output file:  f160w_noopt_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_noopt_drz.fits
==== Processing Step Final Drizzle finished at 20:13:59.306 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:13:59.306 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.1240 sec.
            Static Mask          0.1367 sec.
           Subtract Sky          0.5263 sec.
       Separate Drizzle          2.0542 sec.
          Create Median          0.4528 sec.
                   Blot          1.5558 sec.
                Driz_CR          2.2930 sec.
          Final Drizzle          2.9232 sec.
   ====================          ====================
                  Total          11.0660 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:13:59.351 (17/11/2023)

==== Processing Step  Initialization  started at  20:13:59.352 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:14:00.50 (17/11/2023)
==== Processing Step  Static Mask  started at  20:14:00.507 (17/11/2023)

==== Processing Step Static Mask finished at 20:14:00.632 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:14:00.633 (17/11/2023)

***** skymatch started on 2023-11-17 20:14:00.732676
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:14:01.039489
TOTAL RUN TIME: 0:00:00.306813
==== Processing Step Subtract Sky finished at 20:14:01.141 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:14:01.141 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk:Writing out image to disk:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fitshst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits

Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fitsWriting out image to disk: 
hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: Writing out image to disk:ib1f19l7q_single_sci.fits 
ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk: ib1f19l9q_single_wht.fitsWriting out image to disk:
 ib1f19laq_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:14:03.188 (17/11/2023)
==== Processing Step  Create Median  started at  20:14:03.189 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_opt_med.fits&#39;
==== Processing Step Create Median finished at 20:14:03.617 (17/11/2023)
==== Processing Step  Blot  started at  20:14:03.617 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:14:05.194 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:14:05.194 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:14:07.420 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:14:07.430 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_opt_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_opt_drz.fits
==== Processing Step Final Drizzle finished at 20:14:11.097 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:14:11.0 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.1547 sec.
            Static Mask          0.1252 sec.
           Subtract Sky          0.5080 sec.
       Separate Drizzle          2.0467 sec.
          Create Median          0.4284 sec.
                   Blot          1.5761 sec.
                Driz_CR          2.2257 sec.
          Final Drizzle          3.6666 sec.
   ====================          ====================
                  Total          11.7314 sec.

No trailer file saved...
</pre></div>
</div>
</div>
</div>
</section>
<section id="results">
<h2>4. Results<a class="headerlink" href="#results" title="Permalink to this heading">#</a></h2>
<p>The drizzled science and weight images produced from the first call to AstroDrizzle with no optimization of the plate scale and pixfrac are plotted below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;f160w_noopt_drz.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
    <span class="n">im1wcs</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
    <span class="n">sci1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wht1</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
        
<span class="n">norm1</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">sci1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="n">LogStretch</span><span class="p">())</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">im1wcs</span><span class="p">})</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci1</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wht1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f60dba80c10&gt;
</pre></div>
</div>
<img alt="../../../_images/d3434c4d59802cf620615fe2ebe3b3776812b7d8a896a3d246bc05a893375e6c.png" src="../../../_images/d3434c4d59802cf620615fe2ebe3b3776812b7d8a896a3d246bc05a893375e6c.png" />
</div>
</div>
<p>The drizzled science image is on the left and the associated weight image is on the right, both without optimization of the plate scale and pixfrac.</p>
<p>To compare, the figure plotted below shows close ups of the same part of the sky from the two drizzled products.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">radeclims</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">pixel_to_skycoord</span><span class="p">([</span><span class="mi">825</span><span class="p">,</span> <span class="mi">875</span><span class="p">],</span> <span class="p">[</span><span class="mi">930</span><span class="p">,</span> <span class="mi">980</span><span class="p">],</span> <span class="n">im1wcs</span><span class="p">)</span>

<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;f160w_opt_drz.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
    <span class="n">im2wcs</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
    <span class="n">sci2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wht2</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">norm2</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">sci2</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="n">LogStretch</span><span class="p">())</span>
    
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">im1wcs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci1</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im1wcs</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im1wcs</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">im2wcs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im2wcs</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im2wcs</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>                  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1835.4481178795015, 1934.1019662338267)
</pre></div>
</div>
<img alt="../../../_images/bb33ce31dee034f45849d5197298d63e627c55fcfd641800a553ff174ef8cdb7.png" src="../../../_images/bb33ce31dee034f45849d5197298d63e627c55fcfd641800a553ff174ef8cdb7.png" />
</div>
</div>
<p>The image on the left is without improved plate scale and pixfrac, and shows that the detector undersamples the PSF. The image on the right is the image with improved parameters where the resolution is greatly improved.</p>
</section>
<section id="optimizing-the-final-pixfrac-parameter">
<h2>5. Optimizing the <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> parameter<a class="headerlink" href="#optimizing-the-final-pixfrac-parameter" title="Permalink to this heading">#</a></h2>
<p>While the optimized <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> in the example above was chosen from experience with using a four-point dither, the value that should be used is not known <em>a priori</em>. The value could be different depending on several factors. For example, if the number of images is greater than four, the value used for <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> could be smaller since more images are available to fill in holes in the output grid. On the other hand, it is possible that no dithering was used during the observations. In that case, <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> should be left at 1.0, since shrinking the size of the drop could be detrimental.</p>
<p>Below, a series of experiments will be run to determine the best <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value for the selected output plate scale, by varying pixfrac in steps of 0.1 over a range of values from 0.1 to 1.0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pixfracs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">pixfrac</span> <span class="ow">in</span> <span class="n">pixfracs</span><span class="p">:</span>
    <span class="n">outname</span> <span class="o">=</span> <span class="s1">&#39;f160w_</span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pixfrac</span><span class="p">)</span>
    <span class="n">drizzlepac</span><span class="o">.</span><span class="n">astrodrizzle</span><span class="o">.</span><span class="n">AstroDrizzle</span><span class="p">(</span><span class="s1">&#39;*flt.fits&#39;</span><span class="p">,</span>
                                         <span class="n">output</span><span class="o">=</span><span class="n">outname</span><span class="p">,</span>
                                         <span class="n">runfile</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                                         <span class="n">context</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                         <span class="n">build</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">preserve</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                         <span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">driz_sep_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                         <span class="n">final_bits</span><span class="o">=</span><span class="s1">&#39;64,512&#39;</span><span class="p">,</span>
                                         <span class="n">final_pixfrac</span><span class="o">=</span><span class="n">pixfrac</span><span class="p">,</span>
                                         <span class="n">final_wcs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                         <span class="n">final_rot</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                                         <span class="n">final_scale</span><span class="o">=</span><span class="mf">0.065</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:14:13.22 (17/11/2023)

==== Processing Step  Initialization  started at  20:14:13.223 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:14:14.371 (17/11/2023)
==== Processing Step  Static Mask  started at  20:14:14.372 (17/11/2023)

==== Processing Step Static Mask finished at 20:14:14.493 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:14:14.494 (17/11/2023)

***** skymatch started on 2023-11-17 20:14:14.594981
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:14:14.895247
TOTAL RUN TIME: 0:00:00.300266
==== Processing Step Subtract Sky finished at 20:14:14.994 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:14:14.995 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fitsWriting out image to disk:
 Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits

Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits 
hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fitsWriting out image to disk: 
hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: Writing out image to disk:ib1f19l7q_single_sci.fits 
ib1f19l6q_single_sci.fitsWriting out image to disk:
 ib1f19laq_single_sci.fitsWriting out image to disk:
 ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_wht.fitsWriting out image to disk:
ib1f19l6q_single_wht.fits 
Writing out image to disk: ib1f19laq_single_wht.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:14:17.04 (17/11/2023)
==== Processing Step  Create Median  started at  20:14:17.047 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.1_med.fits&#39;
==== Processing Step Create Median finished at 20:14:17.480 (17/11/2023)
==== Processing Step  Blot  started at  20:14:17.480 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:14:19.046 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:14:19.047 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:14:21.29 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:14:21.306 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.1_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.1_drz.fits
==== Processing Step Final Drizzle finished at 20:14:23.769 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:14:23.77 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.1483 sec.
            Static Mask          0.1219 sec.
           Subtract Sky          0.5002 sec.
       Separate Drizzle          2.0514 sec.
          Create Median          0.4330 sec.
                   Blot          1.5659 sec.
                Driz_CR          2.2485 sec.
          Final Drizzle          2.4628 sec.
   ====================          ====================
                  Total          10.5319 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:14:23.8 (17/11/2023)

==== Processing Step  Initialization  started at  20:14:23.816 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:14:24.881 (17/11/2023)
==== Processing Step  Static Mask  started at  20:14:24.881 (17/11/2023)

==== Processing Step Static Mask finished at 20:14:25.007 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:14:25.008 (17/11/2023)

***** skymatch started on 2023-11-17 20:14:25.220661
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:14:25.525031
TOTAL RUN TIME: 0:00:00.304370
==== Processing Step Subtract Sky finished at 20:14:25.625 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:14:25.625 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk:Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits

Writing out image to disk:Deleted all instances of WCS with key C in extensions [0] hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits

Writing out image to disk:Writing out image to disk:  Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits

Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits-Generating simple FITS output: ib1f19l7q_single_sci.fits

-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk:Writing out image to disk:Deleted all instances of WCS with key B in extensions [0] 
 Writing out image to disk:ib1f19l6q_single_sci.fits ib1f19l7q_single_sci.fits

ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk:Writing out image to disk: Writing out image to disk:ib1f19l7q_single_wht.fits  
ib1f19l6q_single_wht.fits
ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:14:27.678 (17/11/2023)
==== Processing Step  Create Median  started at  20:14:27.679 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.2_med.fits&#39;
==== Processing Step Create Median finished at 20:14:28.114 (17/11/2023)
==== Processing Step  Blot  started at  20:14:28.115 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:14:29.679 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:14:29.6 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fitsCreating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:14:31.919 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:14:31.930 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.2_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.2_drz.fits
==== Processing Step Final Drizzle finished at 20:14:34.563 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:14:34.563 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.0650 sec.
            Static Mask          0.1263 sec.
           Subtract Sky          0.6169 sec.
       Separate Drizzle          2.0529 sec.
          Create Median          0.4351 sec.
                   Blot          1.5639 sec.
                Driz_CR          2.2395 sec.
          Final Drizzle          2.6331 sec.
   ====================          ====================
                  Total          10.7328 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:14:34.611 (17/11/2023)

==== Processing Step  Initialization  started at  20:14:34.61 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:14:35.693 (17/11/2023)
==== Processing Step  Static Mask  started at  20:14:35.693 (17/11/2023)

==== Processing Step Static Mask finished at 20:14:35.818 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:14:35.818 (17/11/2023)

***** skymatch started on 2023-11-17 20:14:36.019282
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:14:36.322135
TOTAL RUN TIME: 0:00:00.302853
==== Processing Step Subtract Sky finished at 20:14:36.422 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:14:36.422 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Writing out image to disk:
 ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:14:38.474 (17/11/2023)
==== Processing Step  Create Median  started at  20:14:38.475 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.3_med.fits&#39;
==== Processing Step Create Median finished at 20:14:38.905 (17/11/2023)
==== Processing Step  Blot  started at  20:14:38.905 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:14:40.467 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:14:40.467 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:14:42.713 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:14:42.724 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.3_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.3_drz.fits
==== Processing Step Final Drizzle finished at 20:14:45.516 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:14:45.51 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.0818 sec.
            Static Mask          0.1244 sec.
           Subtract Sky          0.6035 sec.
       Separate Drizzle          2.0520 sec.
          Create Median          0.4297 sec.
                   Blot          1.5616 sec.
                Driz_CR          2.2458 sec.
          Final Drizzle          2.7921 sec.
   ====================          ====================
                  Total          10.8909 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:14:45.563 (17/11/2023)

==== Processing Step  Initialization  started at  20:14:45.563 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:14:46.625 (17/11/2023)
==== Processing Step  Static Mask  started at  20:14:46.625 (17/11/2023)

==== Processing Step Static Mask finished at 20:14:46.749 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:14:46.749 (17/11/2023)

***** skymatch started on 2023-11-17 20:14:46.849208
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:14:47.156757
TOTAL RUN TIME: 0:00:00.307549
==== Processing Step Subtract Sky finished at 20:14:47.259 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:14:47.260 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fitsWriting out image to disk: Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits


Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
Writing out image to disk: Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits

-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk:Writing out image to disk: ib1f19l6q_single_sci.fits
 ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk:ib1f19l7q_single_wht.fits 
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:14:49.309 (17/11/2023)
==== Processing Step  Create Median  started at  20:14:49.309 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.4_med.fits&#39;
==== Processing Step Create Median finished at 20:14:49.748 (17/11/2023)
==== Processing Step  Blot  started at  20:14:49.748 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:14:51.413 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:14:51.414 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:14:53.640 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:14:53.650 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.4_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.4_drz.fits
==== Processing Step Final Drizzle finished at 20:14:56.548 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:14:56.549 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.0613 sec.
            Static Mask          0.1236 sec.
           Subtract Sky          0.5098 sec.
       Separate Drizzle          2.0491 sec.
          Create Median          0.4384 sec.
                   Blot          1.6653 sec.
                Driz_CR          2.2257 sec.
          Final Drizzle          2.8979 sec.
   ====================          ====================
                  Total          10.9711 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:14:56.59 (17/11/2023)

==== Processing Step  Initialization  started at  20:14:56.596 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:14:57.6 (17/11/2023)
==== Processing Step  Static Mask  started at  20:14:57.662 (17/11/2023)

==== Processing Step Static Mask finished at 20:14:57.78 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:14:57.788 (17/11/2023)

***** skymatch started on 2023-11-17 20:14:57.888474
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:14:58.192983
TOTAL RUN TIME: 0:00:00.304509
==== Processing Step Subtract Sky finished at 20:14:58.296 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:14:58.297 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Deleted all instances of WCS with key C in extensions [0]Writing out image to disk:
 hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fitshst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits

Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits-Generating simple FITS output: ib1f19l7q_single_sci.fits

-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: Writing out image to disk:ib1f19l6q_single_sci.fits
 ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fitsWriting out image to disk:
 Writing out image to disk:ib1f19l7q_single_wht.fits 
ib1f19l9q_single_wht.fits
Writing out image to disk:
 ib1f19laq_single_wht.fits==== Processing Step Separate Drizzle finished at 20:15:00.345 (17/11/2023)
==== Processing Step  Create Median  started at  20:15:00.346 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.5_med.fits&#39;
==== Processing Step Create Median finished at 20:15:00.774 (17/11/2023)
==== Processing Step  Blot  started at  20:15:00.774 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:15:02.453 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:15:02.453 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:15:04.676 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:15:04.688 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.5_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.5_drz.fits
==== Processing Step Final Drizzle finished at 20:15:07.660 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:15:07.661 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.0652 sec.
            Static Mask          0.1256 sec.
           Subtract Sky          0.5084 sec.
       Separate Drizzle          2.0486 sec.
          Create Median          0.4278 sec.
                   Blot          1.6783 sec.
                Driz_CR          2.2234 sec.
          Final Drizzle          2.9726 sec.
   ====================          ====================
                  Total          11.0499 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:15:07.710 (17/11/2023)

==== Processing Step  Initialization  started at  20:15:07.711 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:15:08.919 (17/11/2023)
==== Processing Step  Static Mask  started at  20:15:08.919 (17/11/2023)

==== Processing Step Static Mask finished at 20:15:09.046 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:15:09.04 (17/11/2023)

***** skymatch started on 2023-11-17 20:15:09.150482
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:15:09.463814
TOTAL RUN TIME: 0:00:00.313332
==== Processing Step Subtract Sky finished at 20:15:09.568 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:15:09.568 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fitsWriting out image to disk:
 hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits 
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits-Generating simple FITS output: ib1f19l9q_single_sci.fits

-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk:Writing out image to disk: ib1f19l9q_single_wht.fits 
ib1f19l7q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:15:11.624 (17/11/2023)
==== Processing Step  Create Median  started at  20:15:11.625 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.6_med.fits&#39;
==== Processing Step Create Median finished at 20:15:12.062 (17/11/2023)
==== Processing Step  Blot  started at  20:15:12.062 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:15:13.755 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:15:13.755 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:15:16.019 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:15:16.035 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.6_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.6_drz.fits
==== Processing Step Final Drizzle finished at 20:15:19.173 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:15:19.174 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.2081 sec.
            Static Mask          0.1262 sec.
           Subtract Sky          0.5219 sec.
       Separate Drizzle          2.0556 sec.
          Create Median          0.4366 sec.
                   Blot          1.6929 sec.
                Driz_CR          2.2639 sec.
          Final Drizzle          3.1386 sec.
   ====================          ====================
                  Total          11.4439 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:15:19.222 (17/11/2023)

==== Processing Step  Initialization  started at  20:15:19.222 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:15:20.399 (17/11/2023)
==== Processing Step  Static Mask  started at  20:15:20.399 (17/11/2023)

==== Processing Step Static Mask finished at 20:15:20.525 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:15:20.526 (17/11/2023)

***** skymatch started on 2023-11-17 20:15:20.626975
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:15:20.933662
TOTAL RUN TIME: 0:00:00.306687
==== Processing Step Subtract Sky finished at 20:15:21.036 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:15:21.037 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits

-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key B in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:15:23.093 (17/11/2023)
==== Processing Step  Create Median  started at  20:15:23.094 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.7_med.fits&#39;
==== Processing Step Create Median finished at 20:15:23.526 (17/11/2023)
==== Processing Step  Blot  started at  20:15:23.526 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:15:25.216 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:15:25.216 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fitsCreating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits

Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:15:27.507 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:15:27.518 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.7_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.7_drz.fits
==== Processing Step Final Drizzle finished at 20:15:30.988 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:15:30.989 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.1767 sec.
            Static Mask          0.1261 sec.
           Subtract Sky          0.5102 sec.
       Separate Drizzle          2.0563 sec.
          Create Median          0.4319 sec.
                   Blot          1.6897 sec.
                Driz_CR          2.2907 sec.
          Final Drizzle          3.4700 sec.
   ====================          ====================
                  Total          11.7514 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:15:31.038 (17/11/2023)

==== Processing Step  Initialization  started at  20:15:31.03 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:15:32.23 (17/11/2023)
==== Processing Step  Static Mask  started at  20:15:32.234 (17/11/2023)

==== Processing Step Static Mask finished at 20:15:32.363 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:15:32.363 (17/11/2023)

***** skymatch started on 2023-11-17 20:15:32.465626
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:15:32.773476
TOTAL RUN TIME: 0:00:00.307850
==== Processing Step Subtract Sky finished at 20:15:32.877 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:15:32.87 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk: Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits

Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits-Generating simple FITS output: ib1f19l7q_single_sci.fits

-Generating simple FITS output: ib1f19laq_single_sci.fits-Generating simple FITS output: ib1f19l9q_single_sci.fits

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key A in extensions [0]

Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: Writing out image to disk:ib1f19l7q_single_sci.fits
 Writing out image to disk: ib1f19laq_single_sci.fits
ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_wht.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19l6q_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:15:34.932 (17/11/2023)
==== Processing Step  Create Median  started at  20:15:34.932 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.8_med.fits&#39;
==== Processing Step Create Median finished at 20:15:35.365 (17/11/2023)
==== Processing Step  Blot  started at  20:15:35.366 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:15:37.044 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:15:37.045 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fitsCreating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits

Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:15:39.305 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:15:39.315 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.8_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.8_drz.fits
==== Processing Step Final Drizzle finished at 20:15:42.939 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:15:42.940 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.1949 sec.
            Static Mask          0.1291 sec.
           Subtract Sky          0.5140 sec.
       Separate Drizzle          2.0538 sec.
          Create Median          0.4330 sec.
                   Blot          1.6786 sec.
                Driz_CR          2.2606 sec.
          Final Drizzle          3.6243 sec.
   ====================          ====================
                  Total          11.8884 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:15:42.989 (17/11/2023)

==== Processing Step  Initialization  started at  20:15:42.989 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:15:44.183 (17/11/2023)
==== Processing Step  Static Mask  started at  20:15:44.183 (17/11/2023)

==== Processing Step Static Mask finished at 20:15:44.309 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:15:44.310 (17/11/2023)

***** skymatch started on 2023-11-17 20:15:44.415484
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:15:44.724100
TOTAL RUN TIME: 0:00:00.308616
==== Processing Step Subtract Sky finished at 20:15:44.827 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:15:44.82 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key C in extensions [0]Deleted all instances of WCS with key C in extensions [0]

Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Writing out image to disk:Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk:  hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fitshst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits

Writing out image to disk:Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits 
hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fitshst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits

-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Writing out image to disk: ib1f19l9q_single_sci.fits
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk:Writing out image to disk: ib1f19l6q_single_wht.fits
 ib1f19laq_single_sci.fits
Writing out image to disk: ib1f19l7q_single_wht.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:15:46.881 (17/11/2023)
==== Processing Step  Create Median  started at  20:15:46.882 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_0.9_med.fits&#39;
==== Processing Step Create Median finished at 20:15:47.310 (17/11/2023)
==== Processing Step  Blot  started at  20:15:47.311 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:15:48.877 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:15:48.878 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:15:51.135 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:15:51.146 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_0.9_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_0.9_drz.fits
==== Processing Step Final Drizzle finished at 20:15:55.112 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:15:55.113 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.1939 sec.
            Static Mask          0.1260 sec.
           Subtract Sky          0.5169 sec.
       Separate Drizzle          2.0535 sec.
          Create Median          0.4287 sec.
                   Blot          1.5664 sec.
                Driz_CR          2.2573 sec.
          Final Drizzle          3.9664 sec.
   ====================          ====================
                  Total          12.1091 sec.

No trailer file saved...
No trailer file created...
AstroDrizzle log file: final.tra
AstroDrizzle Version 3.5.1 started at: 20:15:55.16 (17/11/2023)

==== Processing Step  Initialization  started at  20:15:55.16 (17/11/2023)

##############################################################################
#                                                                            #
# “minmed” is highly recommended for three images,                           #
#  and is good for four to six images,                                       #
#  but should be avoided for ten or more images.                             #
#                                                                            #
##############################################################################
WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
********************************************************************************
*
*  Estimated memory usage:  up to 257 Mb.
*  Output image size:       2336 X 2115 pixels. 
*  Output image file:       ~ 56 Mb. 
*  Cores available:         4
*
********************************************************************************
==== Processing Step Initialization finished at 20:15:56.342 (17/11/2023)
==== Processing Step  Static Mask  started at  20:15:56.342 (17/11/2023)

==== Processing Step Static Mask finished at 20:15:56.470 (17/11/2023)
==== Processing Step  Subtract Sky  started at  20:15:56.471 (17/11/2023)

***** skymatch started on 2023-11-17 20:15:56.572007
      Version 1.0.9

&#39;skymatch&#39; task will apply computed sky differences to input image file(s).

NOTE: Computed sky values WILL NOT be subtracted from image data (&#39;subtractsky&#39;=False).
&#39;MDRIZSKY&#39; header keyword will represent sky value *computed* from data.

-----  User specified keywords:  -----
       Sky Value Keyword:  &#39;MDRIZSKY&#39;
       Data Units Keyword: &#39;BUNIT&#39;


-----  Input file list:  -----

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l6_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l7_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19l9_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: hst_11570_19_wfc3_ir_f160w_ib1f19la_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l6q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l6q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l7q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l7q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19l9q_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19l9q_skymatch_mask_sci1.fits[0]

   **  Input image: &#39;ib1f19laq_flt.fits&#39;
       EXT: &#39;SCI&#39;,1;	MASK: ib1f19laq_skymatch_mask_sci1.fits[0]

-----  Sky statistics parameters:  -----
       statistics function: &#39;median&#39;
       lower = None
       upper = None
       nclip = 5
       lsigma = 4.0
       usigma = 4.0
       binwidth = 0.1

-----  Data-&gt;Brightness conversion parameters for input files:  -----

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l6q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l7q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19l9q_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504

   *   Image: ib1f19laq_flt.fits
       EXT = &#39;SCI&#39;,1
             Data units type: COUNT-RATE
             Conversion factor (data-&gt;brightness):  60.797431635711504


-----  Computing sky values requested image extensions (detector chips):  -----

   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
   *   Image:   &#39;ib1f19l6q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 56.203832965924214 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.924444   NEW MDRIZSKY = 0.924444
   *   Image:   &#39;ib1f19l7q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 52.8972627889636 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.870058   NEW MDRIZSKY = 0.870058
   *   Image:   &#39;ib1f19l9q_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.619641705121005 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.849043   NEW MDRIZSKY = 0.849043
   *   Image:   &#39;ib1f19laq_flt.fits[&#39;SCI&#39;,1]&#39;  --  SKY = 51.32938907415446 (brightness units)
       Sky change (data units):
      - EXT = &#39;SCI&#39;,1   delta(MDRIZSKY) = 0.844269   NEW MDRIZSKY = 0.844269
***** skymatch ended on 2023-11-17 20:15:56.878327
TOTAL RUN TIME: 0:00:00.306320
==== Processing Step Subtract Sky finished at 20:15:56.982 (17/11/2023)
==== Processing Step  Separate Drizzle  started at  20:15:56.982 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 544.5  481.5  
CD1_1 CD1_2  : -3.542984305540046e-05  3.7238290366372586e-06  
CD2_1 CD2_2  : 3.7238290366372586e-06  3.542984305540046e-05  
NAXIS : 1089  963
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key C in extensions [0]
Writing out image to disk:Deleted all instances of WCS with key C in extensions [0]
 hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_sci.fits
Deleted all instances of WCS with key C in extensions [0]Writing out image to disk: 
hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_sci.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_single_wht.fits
Writing out image to disk: Writing out image to disk:hst_11570_19_wfc3_ir_f160w_ib1f19l9_single_wht.fits hst_11570_19_wfc3_ir_f160w_ib1f19l7_single_wht.fits

Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_single_wht.fits
-Generating simple FITS output: ib1f19l6q_single_sci.fits
-Generating simple FITS output: ib1f19l7q_single_sci.fits
-Generating simple FITS output: ib1f19l9q_single_sci.fits
-Generating simple FITS output: ib1f19laq_single_sci.fits
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key A in extensions [0]
Deleted all instances of WCS with key B in extensions [0]
Deleted all instances of WCS with key A in extensions [0]Deleted all instances of WCS with key B in extensions [0]

Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l6q_single_sci.fits
Writing out image to disk: ib1f19l7q_single_sci.fits
Deleted all instances of WCS with key B in extensions [0]
Writing out image to disk: ib1f19l9q_single_sci.fits
Writing out image to disk: ib1f19laq_single_sci.fits
Writing out image to disk: Writing out image to disk:ib1f19l6q_single_wht.fits 
ib1f19l7q_single_wht.fits
Writing out image to disk: ib1f19l9q_single_wht.fits
Writing out image to disk: ib1f19laq_single_wht.fits
==== Processing Step Separate Drizzle finished at 20:15:59.035 (17/11/2023)
==== Processing Step  Create Median  started at  20:15:59.036 (17/11/2023)

reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits&#39; is 424.6136825690036
reference sky value for image &#39;ib1f19l6q_flt.fits&#39; is 464.93669456453324
reference sky value for image &#39;ib1f19l7q_flt.fits&#39; is 437.5836524801294
reference sky value for image &#39;ib1f19l9q_flt.fits&#39; is 427.0147483274913
reference sky value for image &#39;ib1f19laq_flt.fits&#39; is 424.6136825690036
Saving output median image to: &#39;f160w_1.0_med.fits&#39;
==== Processing Step Create Median finished at 20:15:59.472 (17/11/2023)
==== Processing Step  Blot  started at  20:15:59.473 (17/11/2023)

    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l6_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l7_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19l9_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_blt.fits
    Blot: creating blotted image:  hst_11570_19_wfc3_ir_f160w_ib1f19la_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
Writing out image to disk: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l6q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l6q_sci1_blt.fits
Writing out image to disk: ib1f19l6q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l7q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l7q_sci1_blt.fits
Writing out image to disk: ib1f19l7q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19l9q_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19l9q_sci1_blt.fits
Writing out image to disk: ib1f19l9q_sci1_blt.fits
    Blot: creating blotted image:  ib1f19laq_flt.fits[sci,1]
Using default C-based coordinate transformation...
-Generating simple FITS output: ib1f19laq_sci1_blt.fits
Writing out image to disk: ib1f19laq_sci1_blt.fits
==== Processing Step Blot finished at 20:16:01.080 (17/11/2023)
==== Processing Step  Driz_CR  started at  20:16:01.081 (17/11/2023)

Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l6_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l7_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19l9_sci1_crmask.fits
Creating output: hst_11570_19_wfc3_ir_f160w_ib1f19la_sci1_crmask.fits
Creating output: ib1f19l6q_sci1_crmask.fits
Creating output: ib1f19l7q_sci1_crmask.fits
Creating output: ib1f19l9q_sci1_crmask.fits
Creating output: ib1f19laq_sci1_crmask.fits
==== Processing Step Driz_CR finished at 20:16:03.331 (17/11/2023)
==== Processing Step  Final Drizzle  started at  20:16:03.342 (17/11/2023)

WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39;  &#39;DEC--TAN&#39;  
CRVAL : 161.76932277076864  17.27336926240212  
CRPIX : 1167.3829659087576  1056.5471233858746  
CD1_1 CD1_2  : -1.805555555555555e-05  3.1902039236663065e-22  
CD2_1 CD2_2  : 5.157799988145019e-22  1.805555555555555e-05  
NAXIS : 2336  2115
-Generating multi-extension output file:  f160w_1.0_drz.fits
Deleted all instances of WCS with key A in extensions [1]
Deleted all instances of WCS with key B in extensions [1]
Deleted all instances of WCS with key C in extensions [1]
Writing out to disk: f160w_1.0_drz.fits
==== Processing Step Final Drizzle finished at 20:16:07.576 (17/11/2023)

AstroDrizzle Version 3.5.1 is finished processing at 20:16:07.577 (17/11/2023).



   --------------------          --------------------
                   Step          Elapsed time
   --------------------          --------------------

         Initialization          1.1813 sec.
            Static Mask          0.1275 sec.
           Subtract Sky          0.5110 sec.
       Separate Drizzle          2.0531 sec.
          Create Median          0.4364 sec.
                   Blot          1.6075 sec.
                Driz_CR          2.2506 sec.
          Final Drizzle          4.2340 sec.
   ====================          ====================
                  Total          12.4015 sec.

No trailer file saved...
</pre></div>
</div>
</div>
</div>
<p>When evaluating what value to use for <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code>, <em>THERE IS NO SINGLE METRIC THAT INDICATES WHAT VALUE TO USE</em>, and several factors should be taken into account. The general philosophy is that the chosen value should improve the resolution of the image as much as possible, without causing any adverse effects.</p>
<p>The first thing to look for is an excessive number of holes in the science and weight images. The figure below shows the central region of the science and weight images produced by three different <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;f160w_0.1_drz.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu1</span><span class="p">:</span>
    <span class="n">sci1</span> <span class="o">=</span> <span class="n">hdu1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wht1</span> <span class="o">=</span> <span class="n">hdu1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;f160w_0.8_drz.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu2</span><span class="p">:</span>
    <span class="n">sci2</span> <span class="o">=</span> <span class="n">hdu2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wht2</span> <span class="o">=</span> <span class="n">hdu2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;f160w_1.0_drz.fits&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu3</span><span class="p">:</span>
    <span class="n">sci3</span> <span class="o">=</span> <span class="n">hdu3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wht3</span> <span class="o">=</span> <span class="n">hdu3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">norm3</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">wht2</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="n">LinearStretch</span><span class="p">())</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci1</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1640</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="s1">&#39;final_pixfrac=0.1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1640</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="s1">&#39;final_pixfrac=0.8&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">sci3</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1640</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="s1">&#39;final_pixfrac=1.0&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;20&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wht1</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wht2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">wht3</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im2wcs</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im2wcs</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1835.4481178795015, 1934.1019662338267)
</pre></div>
</div>
<img alt="../../../_images/dfce71277cff4fa4c9bcd5fb85d179715bd18de4fc3440cc36f9c500b4f33f02.png" src="../../../_images/dfce71277cff4fa4c9bcd5fb85d179715bd18de4fc3440cc36f9c500b4f33f02.png" />
</div>
</div>
<p>This figure above shows the central region of the science and weight images produced by <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> values (left to right) of 0.1, 0.8 and 1.0. The top row is the science frame, the bottom is the weight image. The science image with the smallest <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value of 0.1 shows a noisy background and holes in the image where no input pixels fall into the output grid because pixfrac is too small. Inspection of the weight map corresponding to the smallest <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value shows many places with weights of zero, indicating that a <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value of 0.1 is clearly too small and was only included in this example for illustrative purposes.</p>
<p>Another piece of information that can be useful is the amount of noise in the weight image. As suggested in the <a class="reference external" href="http://www.stsci.edu/hst/HST_overview/documents/dither_handbook">HST Dither Handbook</a> Chapter 5 and in the <a class="reference external" href="http://documents.stsci.edu/hst/HST_overview/documents/DrizzlePac/ch64.html#586267">DrizzlePac Handbook</a> Section 6.3.3, statistics performed on the drizzled weight image should yield a RMS/median value less than ~0.2. This threshold controls the trade-off between improving image resolution versus increasing background noise due to pixel resampling.</p>
<p>The figure below shows the RMS/median as a function of <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code>. One should take care to use the same region in the weight image as the region where the object of interest is located in the science image. If one is using the entire image for scientific analysis, then one should measure the statistics of the weight image where there is more variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">whtlist</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;f160w_0.[0-9]*drz.fits&#39;</span><span class="p">)</span>

<span class="n">std_med</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">whtlist</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">fraclist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">whtlist</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="n">xlims</span> <span class="o">=</span> <span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im1wcs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">ylims</span> <span class="o">=</span> <span class="n">radeclims</span><span class="o">.</span><span class="n">to_pixel</span><span class="p">(</span><span class="n">im1wcs</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1">#Loop that measures statistics, also some information gathering</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">im</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">whtlist</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdu</span><span class="p">:</span>
        <span class="n">hdr</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
        <span class="n">wht</span> <span class="o">=</span> <span class="n">hdu</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;TARGNAME&#39;</span><span class="p">]</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;D001SCAL&#39;</span><span class="p">])</span>
        <span class="n">nimg</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;NDRIZIM&#39;</span><span class="p">]</span>
    <span class="n">wht_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">wht</span><span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">wht_med</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">wht</span><span class="p">[</span><span class="n">ylims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">ylims</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">xlims</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">std_med</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">wht_std</span> <span class="o">/</span> <span class="n">wht_med</span>
    <span class="n">fraclist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;D001PIXF&#39;</span><span class="p">]</span>

<span class="c1">#Plotting commands              </span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.025</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.025</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">fraclist</span><span class="p">,</span> <span class="n">std_med</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;pixfrac&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;rms/median&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.40</span><span class="p">,</span> <span class="s1">&#39;Scale=&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nimg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; images&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.1, 0.35, &#39;8 images&#39;)
</pre></div>
</div>
<img alt="../../../_images/13649411299d9298e8949eb6c1030e3295f5db78fdd4960a9a516a2c980f0377.png" src="../../../_images/13649411299d9298e8949eb6c1030e3295f5db78fdd4960a9a516a2c980f0377.png" />
</div>
</div>
<p>The RMS/median increases steadily up to pixfrac of 0.6, where there is a change in the slope of the function, indicating that something odd might be happening beyond that point. Even though the RMS remains below 20% of the median all the way to <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> of 0.1, the higher slope in the curve combined with the information from inspection of the science images themselvse (the evidence of holes) indicates that the pixfrac should remain &gt;0.6.</p>
</section>
<section id="final-thoughts">
<h2>6. Final thoughts<a class="headerlink" href="#final-thoughts" title="Permalink to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> value has to be small enough to avoid degrading the combined output image, but large enough that when all images are ”dropped” onto the final frame, coverage of the output frame is fairly uniform. In general, <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> should be slightly larger than the final output scale to allow some ”spillover” to adjacent pixels. This will help avoid ”holes” in the final product when a given pixel has been flagged as ”bad” in several frames. As a rule of thumb, statistics performed on the drizzled weight image in the region of interest should yield an RMS value (standard deviation) that is less than 20% of the median value. This threshold is a balance between the benefits of improving the image resolution at the expense of increasing noise in the background.</p>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this heading">#</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Author: R. Avila, STScI ACS Team  
Updated: December 12, 2018
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/hst_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/DrizzlePac/optimize_image_sampling"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../mask_satellite/mask_satellite.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Satellite Trail Masking Techniques</p>
      </div>
    </a>
    <a class="right-next"
       href="../sky_matching/sky_matching.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sky Matching</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#description-of-the-data">1. Description of the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dithering">2. Dithering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#drizzling">3. Drizzling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#results">4. Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimizing-the-final-pixfrac-parameter">5. Optimizing the <code class="docutils literal notranslate"><span class="pre">final_pixfrac</span></code> parameter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-thoughts">6. Final thoughts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022-2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>