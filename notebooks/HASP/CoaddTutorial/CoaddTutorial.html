

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Inputting User Data using the Hubble Advanced Spectral Products Script &#8212; HST Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/HASP/CoaddTutorial/CoaddTutorial';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/stsci_logo2.png" class="logo__image only-light" alt="HST Notebooks - Home"/>
    <script>document.write(`<img src="../../../_static/stsci_logo2.png" class="logo__image only-dark" alt="HST Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    STScI HST Notebook Repository HQ
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ACS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ACS/README.html">ACS Notebooks</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_findsat_mrt/acs_findsat_mrt_example.html">Satellite trail detection in ACS/WFC data using acstools.findsat_mrt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_saturation_trails/acs_saturation_trails.html">ACS Linearity with Saturated Stars</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_cte_forward_model/acs_cte_forward_model_example.html">Pixel-based ACS/WFC CTE Forward Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_subarrays/acs_subarrays.html">ACS Image Reduction for Subarray Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_sbc_dark_analysis/acs_sbc_dark_analysis.html">SBC Dark Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_reduction/acs_reduction.html">ACS/WFC Image Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_pixel_area_maps/acs_pixel_area_maps.html">Obtaining Pixel Area Maps for ACS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ACS/acs_polarization_tools/acs_polarization_tools.html">Using ACS Polarization Tools</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">COS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../COS/README.html">COS Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/Setup/Setup.html">Setting up your computer environment for working with COS data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/DataDl/DataDl.html">Downloading COS Data</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../COS/ViewData/ViewData.html">Viewing COS Data</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/AsnFile/AsnFile.html">Modifying or Creating an Association File</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../COS/CalCOS/CalCOS.html">Running the COS Data Pipeline (<code class="docutils literal notranslate"><span class="pre">CalCOS</span></code>)</a></li>






<li class="toctree-l1"><a class="reference internal" href="../../COS/SplitTag/SplitTag.html">Splitting COS Exposures into sub-exposures with <code class="docutils literal notranslate"><span class="pre">splittag</span></code></a></li>







<li class="toctree-l1"><a class="reference internal" href="../../COS/DayNight/DayNight.html">Filtering out COS Data taken during the Day or Night</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../COS/LSF/LSF.html">Working with the COS Line Spread Function (LSF)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../COS/Extract/Extract.html">Editing the extraction boxes in a spectral extraction file (<code class="docutils literal notranslate"><span class="pre">XTRACTAB</span></code>)</a></li>







</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">DrizzlePac</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/README.html">DrizzlePac Jupyter Notebook Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/Initialization/Initialization.html">DrizzlePac Initialization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_to_catalogs/align_to_catalogs.html">Aligning HST images to an absolute reference catalog</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_multiple_visits/align_multiple_visits.html">Optimizing Image Alignment for Multiple HST Visits</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/align_sparse_fields/align_sparse_fields.html">Aligning Deep Exposures of Sparse Fields</a></li>








<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/drizzle_wfpc2/drizzle_wfpc2.html">Drizzling WFPC2 Images to use a Single Zeropoint</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/mask_satellite/mask_satellite.html">Satellite Trail Masking Techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/optimize_image_sampling/optimize_image_sampling.html">Optimizing the Image Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/sky_matching/sky_matching.html">Sky Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/use_ds9_regions_in_tweakreg/use_ds9_regions_in_tweakreg.html">Using DS9 Regions to Include and Exclude Sources in HST Image Alignment with TWEAKREG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../DrizzlePac/using_updated_astrometry_solutions/using_updated_astrometry_solutions.html">Using updated astrometry solutions</a></li>


</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">HASP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Setup/Setup.html">Inputting User Data using the Hubble Advanced Spectral Products Script</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">NICMOS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../NICMOS/nicmos_unit_conversion/nicmos_unit_conversion.html">Programmatic Replacements for NICMOS Units Conversion Form</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">STIS</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../STIS/README.html">STIS-Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/cross-correlation/cross-correlation.html">Correcting for Missing Wavecals with Cross-Correlation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/custom_ccd_darks/custom_ccd_darks.html">Custom CCD Darks <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/drizpac_notebook/STIS_DrizzlePac_Tutorial.html">STIS DrizzlePac Tutorial <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/CoronagraphyViz/STIS_Coronagraphy_Visualization_v2.html">STIS Coronagraphy Visualization Tool (v2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/calstis/calstis_2d_ccd.html">Calstis 2-D CCD Data Reduction <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/target_acquisition/target_acquisition.html">Evaluating STIS Target Acquisitions <a class="tocSkip"></a></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/view_data/view_data.html">Viewing STIS Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../STIS/extraction/1D_Extraction.html">1D Spectra Extraction <a class="tocSkip"></a></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">WFC3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/README.html">WFC3 Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/calwf3_recalibration/calwf3_recal_tvb.html">Manual Recalibration with calwf3: Turning off the IR Linear Ramp Fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/calwf3_v1.0_cte/calwf3_with_v1.0_PCTE.html">Processing WFC3/UVIS Data with <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> Using the v1.0 CTE-Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/exception_report/wfc3_exception_report.html">Exception Report Checklist - WFC3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/image_displayer_analyzer/wfc3_image_displayer_analyzer.html">WFC3 Image Displayer &amp; Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_ima_visualization/IR_IMA_Visualization_with_an_Example_of_Time_Variable_Background.html">WFC3/IR IMA Visualization Tools with An Example of Time Variable Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_scattered_light_calwf3_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_Using_calwf3_to_Mask_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Using <code class="docutils literal notranslate"><span class="pre">calwf3</span></code> to Mask Bad Reads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/ir_scattered_light_manual_corrections/Correcting_for_Scattered_Light_in_IR_Exposures_by_Manually_Subtracting_Bad_Reads.html">Correcting for Scattered Light in WFC3/IR Exposures: Manually Subtracting Bad Reads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/persistence/wfc3_ir_persistence.html">Masking Persistence in WFC3/IR Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/tvb_flattenramp/TVB_flattenramp_notebook.html">Correcting for Helium Line Emission Background in IR Exposures using the “Flatten-Ramp” Technique</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/photometry_examples/phot_examples.html">Synthetic Photometry Examples for WFC3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/uvis_pam_corrections/WFC3_UVIS_Pixel_Area_Map_Corrections_for_Subarrays.html">WFC3/UVIS Pixel Area Map Corrections for Subarrays</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../WFC3/uvis_time_dependent_photometry/uvis_timedep_phot.html">WFC3/UVIS Time-dependent Photometry</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/spacetelescope/hst_notebooks/blob/main/notebooks/HASP/CoaddTutorial/CoaddTutorial.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/hst_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/HASP/CoaddTutorial/CoaddTutorial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/notebooks/HASP/CoaddTutorial/CoaddTutorial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Inputting User Data using the Hubble Advanced Spectral Products Script</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Inputting User Data using the Hubble Advanced Spectral Products Script</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-font-weight-normal-this-notebook-is-designed-to-walk-you-through-downloading-and-using-the-hubble-advanced-spectral-products-hasp-co-add-script-span"><span style="font-weight:normal">This Notebook is designed to walk you through downloading and using the <strong>Hubble Advanced Spectral Products (HASP)</strong> co-add script.</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">0. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-hst-spectroscopic-data">1. Downloading HST Spectroscopic Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-astroquery-to-download-stis-data">1.1 Using <code class="docutils literal notranslate"><span class="pre">Astroquery</span></code> to Download STIS Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-co-add-script">2. Running the Co-add Script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-co-added-data-products">3. Working with Co-added Data Products</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-output-files">3.1 Understanding the Output Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#viewing-the-co-added-data">3.2 Viewing the Co-added Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together-with-cos-data">3.3 Putting it all together with COS data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-the-threshold-flag">4. Changing the Threshold Flag</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-data">4.1 Downloading the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-co-add-script-with-different-threshold-values">4.2 Running the Co-add Script with Different Threshold Values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-the-different-co-added-spectra-of-different-threshold-values">4.3 Analyzing the Different Co-added Spectra of Different Threshold Values</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#looking-at-snr">Looking at SNR:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#looking-at-flux">Looking at Flux:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#congrats-on-completing-the-notebook">Congrats on completing the notebook!</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#there-are-more-tutorial-notebooks-for-custom-co-addition-cases-in-this-repo-check-them-out">There are more tutorial notebooks for custom co-addition cases in this repo, check them out!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="inputting-user-data-using-the-hubble-advanced-spectral-products-script">
<h1>Inputting User Data using the Hubble Advanced Spectral Products Script<a class="headerlink" href="#inputting-user-data-using-the-hubble-advanced-spectral-products-script" title="Permalink to this heading">#</a></h1>
<section id="span-style-font-weight-normal-this-notebook-is-designed-to-walk-you-through-downloading-and-using-the-hubble-advanced-spectral-products-hasp-co-add-script-span">
<h2><span style="font-weight:normal">This Notebook is designed to walk you through downloading and using the <strong>Hubble Advanced Spectral Products (HASP)</strong> co-add script.</span><a class="headerlink" href="#span-style-font-weight-normal-this-notebook-is-designed-to-walk-you-through-downloading-and-using-the-hubble-advanced-spectral-products-hasp-co-add-script-span" title="Permalink to this heading">#</a></h2>
</section>
<section id="learning-goals">
<h2>Learning Goals:<a class="headerlink" href="#learning-goals" title="Permalink to this heading">#</a></h2>
<p>By the end of this tutorial, you will learn how to:</p>
<ul class="simple">
<li><p>Setup a <code class="docutils literal notranslate"><span class="pre">conda</span></code> environment</p></li>
<li><p>Download the HASP wrapper script</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code> to download COS and STIS data</p></li>
<li><p>Run the co-add script</p></li>
<li><p>Examine the co-added output</p></li>
<li><p>Run the scipt with multiple threshold values and examine output</p></li>
</ul>
</section>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h2>
<p><strong>0. <span class="xref myst">Introduction</span></strong></p>
<p><strong>1. <span class="xref myst">Downloading HST Spectroscopic Data</span></strong></p>
<p>- 1.1 <span class="xref myst">Using <code class="docutils literal notranslate"><span class="pre">Astroquery</span></code> to Download STIS Data</span></p>
<p><strong>2. <span class="xref myst">Running the Co-add Script</span></strong></p>
<p><strong>3. <span class="xref myst">Working with Co-added Data Products</span></strong></p>
<p>- 3.1 <span class="xref myst">Inspecting the Output Files</span></p>
<p>- 3.2 <span class="xref myst">Viewing Co-added STIS Data</span></p>
<p>- 3.3 <span class="xref myst">Putting it all together with COS Data</span></p>
<p><strong>4. <span class="xref myst">Changing the Threshold Flag</span></strong></p>
<p>- 4.1 <span class="xref myst">Using <code class="docutils literal notranslate"><span class="pre">Astroquery</span></code> to Download Additional Data</span></p>
<p>- 4.2 <span class="xref myst">Running the Co-add Script with Multiple Threshold Values</span></p>
<p>- 4.3 <span class="xref myst">Analyzing the Co-added Spectra of Different Threshold Values</span></p>
<p><a id = introduction></a></p>
</section>
<section id="introduction">
<h2>0. Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference external" href="https://github.com/spacetelescope/hasp">Hubble Advanced Spectral Products (HASP) code</a> is a script that co-adds spectra of the same target within programs. This software is able to co-add data taken with the spectrographs onboard the <a class="reference external" href="https://www.stsci.edu/hst">Hubble Space Telescope (HST)</a>; the <a class="reference external" href="https://www.stsci.edu/hst/instrumentation/stis">Space Telescope Imaging Spectrograph (STIS)</a> and the <a class="reference external" href="https://www.stsci.edu/hst/instrumentation/cos">Cosmic Origins Spectrograph (COS)</a>. The <a class="reference external" href="https://archive.stsci.edu/missions-and-data/hst/hasp">Hubble Spectroscopic Legacy Archive (HSLA)</a> uses this script to co-add these instruments’ data from <a class="reference external" href="https://archive.stsci.edu/">The Mikulski Archive for Space Telescopes (MAST)</a> to create high-quality spectra with a broad wavelength coverage (whenever possible from the ultraviolet to the near-infrared) that is publicly available for the scientific community. These custom co-addition notebooks will instruct users on how to produce their own co-adds in cases where the MAST archive data needs special processing or is rejected by the default filters used in the co-add script.</p>
<p>The script first co-adds the observations for each grating for a given program, then it combines all gratings for the observation set. Finally, it co-adds the spectra of each observation set in the program to produce a fully co-added spectra for each target in a program.</p>
<p>This notebook will show users how to download data from MAST, run the co-add script, understand the output files and inspect the abutted data by plotting flux as a function of wavelength. It will also show users how to change the flux threshold flag.</p>
<p><strong>Please check out our <a class="reference external" href="https://github.com/spacetelescope/hst_notebooks/tree/main/notebooks/HASP/Setup">Setup.ipynb</a> notebook before running this tutorial to learn how to install and run the co-add code.</strong></p>
<section id="imports">
<h3>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h3>
<p>We will be using multiple libraries to retrieve and analyze data. We will use:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Path.pathlib</span></code> to create product and data directories</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">astroquery.mast</span> <span class="pre">Observations</span></code> to download COS and STIS data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shutil</span></code> to perform directory and file operations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">os</span></code> to interact with the operating system</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">astropy.io</span> <span class="pre">fits</span></code> to work with FITS files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code> to plot abutted spectra</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">glob</span></code> to work with multiple files in our directories</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subprocesses</span></code> to run our script in the notebook with varying threshold flag values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code> to help analyze our data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scipy.interpolate</span> <span class="pre">interp1d</span></code> to interpolate our data</p></li>
</ul>
<p>We must activate our <code class="docutils literal notranslate"><span class="pre">conda</span></code> environment before we run any code; if you haven’t created one with the HASP dependencies, you can checkout our <a class="reference external" href="https://github.com/spacetelescope/hst_notebooks/tree/main/notebooks/HASP/Setup">Setup.ipynb</a> notebook.</p>
<p>Running the next cell will print your current <code class="docutils literal notranslate"><span class="pre">conda</span></code> environment.</p>
<p><em>Note: if the following cell doesn’t print your hasp environment, you will have to activate the <code class="docutils literal notranslate"><span class="pre">conda</span></code> environment in your terminal or by running the subsequent cell, and then restart the notebook. This is because of how different shells are configured.</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Currently active conda environment:&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;CONDA_PREFIX&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Currently active conda environment: None
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>conda<span class="w"> </span>activate<span class="w"> </span>hasp-env
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>usage: conda [-h] [-v] [--no-plugins] [-V] COMMAND ...
conda: error: argument COMMAND: invalid choice: &#39;activate&#39; (choose from &#39;clean&#39;, &#39;compare&#39;, &#39;config&#39;, &#39;create&#39;, &#39;info&#39;, &#39;init&#39;, &#39;install&#39;, &#39;list&#39;, &#39;notices&#39;, &#39;package&#39;, &#39;remove&#39;, &#39;uninstall&#39;, &#39;rename&#39;, &#39;run&#39;, &#39;search&#39;, &#39;update&#39;, &#39;upgrade&#39;, &#39;content-trust&#39;, &#39;doctor&#39;, &#39;repoquery&#39;, &#39;env&#39;)
</pre></div>
</div>
</div>
</div>
<p>Please make sure the environment that contains the HASP script dependencies is activated, otherwise <strong><em>you will NOT be able to run the co-add code.</em></strong></p>
<p>Let’s import all of our packages that we will use in this notebook:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">astroquery.mast</span> <span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">glob</span> <span class="k">as</span> <span class="nn">glob</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<p>To do our tutorial, we will create data folders that will contain downloaded data from MAST (one for the STIS and the another for COS). We will also create products folders to contain the HASP script output, a.k.a the co-added spectra. We will have one folder for STIS and another for COS too.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating the data download directories for COS and STIS</span>
<span class="n">stis_data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./stis_data/&quot;</span><span class="p">)</span>
<span class="n">cos_data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./cos_data/&quot;</span><span class="p">)</span>

<span class="c1"># Creating the products directory to hold the output</span>
<span class="n">stis_products_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./stis_products/&quot;</span><span class="p">)</span>
<span class="n">cos_products_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./cos_products/&quot;</span><span class="p">)</span>

<span class="c1"># If the directory doesn&#39;t exist, then create it</span>
<span class="n">stis_data_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cos_data_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">stis_products_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">cos_products_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a id = datadownload></a></p>
</section>
</section>
<section id="downloading-hst-spectroscopic-data">
<h2>1. Downloading HST Spectroscopic Data<a class="headerlink" href="#downloading-hst-spectroscopic-data" title="Permalink to this heading">#</a></h2>
<p>Now that we have a <code class="docutils literal notranslate"><span class="pre">conda</span></code> environment created and the co-add code downloaded, we can start downloading data using <code class="docutils literal notranslate"><span class="pre">Observations</span></code> class from the Python package <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code>. Here we will download two datasets, one taken with STIS and the other taken with COS.</p>
<p><a id = stisdownload></a></p>
<section id="using-astroquery-to-download-stis-data">
<h3>1.1 Using <code class="docutils literal notranslate"><span class="pre">Astroquery</span></code> to Download STIS Data<a class="headerlink" href="#using-astroquery-to-download-stis-data" title="Permalink to this heading">#</a></h3>
<p>We will be downloading STIS data for the white dwarf <a class="reference external" href="http://simbad.u-strasbg.fr/simbad/sim-id?Ident=GD+++71">GD71</a>; this object is a well-known primary white dwarf standard. We will specifically download data from Program 7656, which has observations of GD71 using the gratings <code class="docutils literal notranslate"><span class="pre">G230L</span></code> and <code class="docutils literal notranslate"><span class="pre">G140L</span></code>.</p>
<p>We can start with querying the MAST database for the STIS program’s data. This will give us a list of <em>all</em> observations for the program.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Querying the data on MAST for our target</span>
<span class="n">gd71_query</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span>
    <span class="n">proposal_id</span><span class="o">=</span><span class="mi">7656</span><span class="p">,</span>
    <span class="n">target_name</span><span class="o">=</span><span class="s2">&quot;GD71&quot;</span><span class="p">,</span>
    <span class="n">dataproduct_type</span><span class="o">=</span><span class="s2">&quot;SPECTRUM&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have queried the observations for Program 7656, we can get a list that contains the data products for these observations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Getting a product list for our query</span>
<span class="n">gd71_products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span>
    <span class="n">gd71_query</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s print out this list to see the associated data files:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gd71_products</span><span class="p">[</span><span class="s2">&quot;productFilename&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>             productFilename              
------------------------------------------
  hst_7656_stis_gd71_g230lb_o4a5_cspec.png
  hst_7656_stis_gd71_g230lb_o4a5_cspec.png
  hst_7656_stis_gd71_g230lb_o4a5_cspec.png
hst_7656_stis_gd71_g230lb_o4a520_cspec.png
hst_7656_stis_gd71_g230lb_o4a520_cspec.png
hst_7656_stis_gd71_g230lb_o4a520_cspec.png
hst_7656_stis_gd71_g230lb_o4a551_cspec.png
hst_7656_stis_gd71_g230lb_o4a551_cspec.png
hst_7656_stis_gd71_g230lb_o4a551_cspec.png
   hst_7656_stis_gd71_g430l_o4a5_cspec.png
                                       ...
                        o4a551060_spt.fits
                        o4a551060_trl.fits
                        o4a551060_wav.fits
                        o4a551060_wsp.fits
                        o4a551060_asn.fits
                         o4a551060_log.txt
                         o4a551060_x1d.png
                        o4a551060_raw.fits
                        o4a551060_x1d.fits
                        o4a551060_x2d.fits
                        o4a551060_flt.fits
Length = 296 rows
</pre></div>
</div>
</div>
</div>
<p>As you can see, we have a very long list of different type of data products for our program. Luckily, we don’t need all of these files to run the wrapper. We only need to download the following COS and/or STIS files:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://hst-docs.stsci.edu/cosdhb/chapter-2-cos-data-files/2-4-cos-data-products#:~:text=in%20the%20association.-,One%2DDimensional%20Extracted%20Spectra%20(x1d%2C%20x1dsum),-The%20COS%20pipeline">X1D</a> - the one-dimensional extracted product spectra.</p></li>
<li><p><a class="reference external" href="https://hst-docs.stsci.edu/stisdhb/chapter-2-stis-data-structure/2-2-types-of-stis-files#:~:text=corrected%20imaging%20data.-,_sx1,-table">SX1</a> - the one-dimensional extracted spectra from combined or cosmic-ray rejected images. This file is only produced with STIS data.</p></li>
</ul>
<p>We will specify that we want to download <em>only</em> these files with the <code class="docutils literal notranslate"><span class="pre">productSubGroupDescription</span></code> parameter. We will also specify the directory that will contain the downloaded data products. Below, we download the STIS files for the progam.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span>
    <span class="n">gd71_products</span><span class="p">,</span>
    <span class="n">download_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">stis_data_dir</span><span class="p">),</span>
    <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X1D&quot;</span><span class="p">,</span> <span class="s2">&quot;SX1&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o4a520020_sx1.fits to stis_data/mastDownload/HST/o4a520020/o4a520020_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o4a520030_sx1.fits to stis_data/mastDownload/HST/o4a520030/o4a520030_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o4a520040_sx1.fits to stis_data/mastDownload/HST/o4a520040/o4a520040_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file stis_data/mastDownload/HST/o4a520040/o4a520040_sx1.fits with expected size 80640. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o4a520050_x1d.fits to stis_data/mastDownload/HST/o4a520050/o4a520050_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o4a520060_x1d.fits to stis_data/mastDownload/HST/o4a520060/o4a520060_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o4a551020_sx1.fits to stis_data/mastDownload/HST/o4a551020/o4a551020_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o4a551030_sx1.fits to stis_data/mastDownload/HST/o4a551030/o4a551030_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o4a551040_sx1.fits to stis_data/mastDownload/HST/o4a551040/o4a551040_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file stis_data/mastDownload/HST/o4a551040/o4a551040_sx1.fits with expected size 80640. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o4a551050_x1d.fits to stis_data/mastDownload/HST/o4a551050/o4a551050_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o4a551060_x1d.fits to stis_data/mastDownload/HST/o4a551060/o4a551060_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=12</i>
<table id="table140007164544912" class="table-striped table-bordered table-condensed">
<thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
<thead><tr><th>str55</th><th>str8</th><th>object</th><th>object</th></tr></thead>
<tr><td>stis_data/mastDownload/HST/o4a520020/o4a520020_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a520030/o4a520030_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a520040/o4a520040_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a520040/o4a520040_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a520050/o4a520050_x1d.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a520060/o4a520060_x1d.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a551020/o4a551020_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a551030/o4a551030_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a551040/o4a551040_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a551040/o4a551040_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a551050/o4a551050_x1d.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>stis_data/mastDownload/HST/o4a551060/o4a551060_x1d.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
</table></div></div></div>
</div>
<p>When we downloaded the data using <code class="docutils literal notranslate"><span class="pre">astroquery</span></code>, it created a directory <code class="docutils literal notranslate"><span class="pre">./stis_data/mastDownload/HST</span></code>, with separate folders for each different dataset ID. The script will need all of our newly downloaded data product files in a single directory, so we must move all STIS files to our <code class="docutils literal notranslate"><span class="pre">./stis_data</span></code> directory. We will create a function to consolidate our data, since we will be utilizing it for two additional datasets later on in the tutorial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">consolidate_files</span><span class="p">(</span><span class="n">data_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Consolidate all files to single directory; necessary for HASP script run.</span>
<span class="sd">    ---------------</span>
<span class="sd">    Input:</span>
<span class="sd">    str data_path : ./mastDownload/HST folders paths; files to be moved here</span>
<span class="sd">    ---------------</span>
<span class="sd">    Output:</span>
<span class="sd">    None. Files moved to data_path. ./mastDownload/HST directory is deleted.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># The path to all obs_id folders</span>
    <span class="n">mast_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_path</span><span class="si">}</span><span class="s2">/mastDownload/HST/&quot;</span>

    <span class="c1"># Getting a list of all obs_id folders. Each folder contains the data files</span>
    <span class="n">obs_id_dirs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">mast_path</span><span class="p">)</span>

    <span class="c1"># Iterating through each sub-folder to change the path of each FITS file</span>
    <span class="k">for</span> <span class="n">obs_id</span> <span class="ow">in</span> <span class="n">obs_id_dirs</span><span class="p">:</span>
        <span class="c1"># This is the path to each obs_id folder</span>
        <span class="n">obs_id_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mast_path</span><span class="p">,</span> <span class="n">obs_id</span><span class="p">)</span>

        <span class="c1"># Getting a list of files in current ./mastDownload/HST/&lt;obs_id&gt; folder</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">obs_id_path</span> <span class="o">+</span> <span class="s2">&quot;/*fits&quot;</span><span class="p">)</span>

        <span class="c1"># Iterating through each file to change their path individually:</span>
        <span class="c1"># We will be moving them to ./data_data</span>
        <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="n">new_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">new_path</span><span class="p">)</span>

    <span class="c1"># Now we can remove the mastDownload directory</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_path</span><span class="si">}</span><span class="s2">/mastDownload&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, using the function to move our STIS files to a single directory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">consolidate_files</span><span class="p">(</span><span class="n">stis_data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can run the co-add script!</p>
<p><a id = runscript></a></p>
</section>
</section>
<section id="running-the-co-add-script">
<h2>2. Running the Co-add Script<a class="headerlink" href="#running-the-co-add-script" title="Permalink to this heading">#</a></h2>
<p>Now that we’ve downloaded the GD71 STIS data, we can run the co-add script. Currently, the co-add code abuts spectra for a single program. Run the script by using the next cell’s command.</p>
<p><strong>Note: Make sure that you are in the <code class="docutils literal notranslate"><span class="pre">hasp-env</span></code> <code class="docutils literal notranslate"><span class="pre">conda</span></code> environment that we created at the beginning of the <a class="reference external" href="https://github.com/spacetelescope/hst_notebooks/tree/main/notebooks/HASP/Setup">Setup.ipynb</a> notebook.</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">-i</span></code> parameter is the input directory (i.e, where the FITS files are located). <code class="docutils literal notranslate"><span class="pre">-o</span></code> is the directory that will contain the newly created co-added products. Note that if you want to exclude certain data files from the co-add, you can just remove them from the input directory. There is more information about this (and the other flags) in our <a class="reference external" href="https://github.com/spacetelescope/hst_notebooks/tree/main/notebooks/HASP/Setup">Setup.ipynb</a> notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>swrapper<span class="w"> </span>-i<span class="w"> </span>./stis_data<span class="w"> </span>-o<span class="w"> </span>./stis_products
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HASP version 0.9.6
Ullyses version 4.1.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Creating list of unique modes from these files:
./stis_data/o4a520020_sx1.fits GD71 STIS CCD G750L 52X2 7656 (7656, &#39;20&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./stis_data/o4a520030_sx1.fits GD71 STIS CCD G430L 52X2 7656 (7656, &#39;20&#39;)
./stis_data/o4a520040_sx1.fits GD71 STIS CCD G230LB 52X2 7656 (7656, &#39;20&#39;)
./stis_data/o4a520050_x1d.fits GD71 STIS NUV-MAMA G230L 52X2 7656 (7656, &#39;20&#39;)
./stis_data/o4a520060_x1d.fits GD71 STIS FUV-MAMA G140L 52X2 7656 (7656, &#39;20&#39;)
./stis_data/o4a551020_sx1.fits GD71 STIS CCD G750L 52X2 7656 (7656, &#39;51&#39;)
./stis_data/o4a551030_sx1.fits GD71 STIS CCD G430L 52X2 7656 (7656, &#39;51&#39;)
./stis_data/o4a551040_sx1.fits GD71 STIS CCD G230LB 52X2 7656 (7656, &#39;51&#39;)
./stis_data/o4a551050_x1d.fits GD71 STIS NUV-MAMA G230L 52X2 7656 (7656, &#39;51&#39;)
./stis_data/o4a551060_x1d.fits GD71 STIS FUV-MAMA G140L 52X2 7656 (7656, &#39;51&#39;)
Looping over visits
Processing product (7656, &#39;20&#39;)
Targets in visit (7656, &#39;20&#39;): [&#39;GD71&#39;]
Processing target GD71 in visit (7656, &#39;20&#39;)
Processing grating STIS/G750L
Importing files [&#39;./stis_data/o4a520020_sx1.fits&#39;]
Processing file ./stis_data/o4a520020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_g750l_o4a520_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_g750l_o4a520_cspec.fits
Processing grating STIS/G430L
Importing files [&#39;./stis_data/o4a520030_sx1.fits&#39;]
Processing file ./stis_data/o4a520030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_g430l_o4a520_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_g430l_o4a520_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;./stis_data/o4a520040_sx1.fits&#39;]
Processing file ./stis_data/o4a520040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_g230lb_o4a520_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_g230lb_o4a520_cspec.fits
Processing grating STIS/G230L
Importing files [&#39;./stis_data/o4a520050_x1d.fits&#39;]
Processing file ./stis_data/o4a520050_x1d.fits
/usr/share/miniconda/lib/python3.11/site-packages/ullyses/coadd.py:550: RuntimeWarning: divide by zero encountered in divide
  weighted_gross = weight_function[self.weighting_method](gross, exptime, net/flux)
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_sg230l_o4a520_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_sg230l_o4a520_cspec.fits
Processing grating STIS/G140L
Importing files [&#39;./stis_data/o4a520060_x1d.fits&#39;]
Processing file ./stis_data/o4a520060_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_sg140l_o4a520_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_sg140l_o4a520_cspec.fits
Making a product from these gratings
STIS/G140L 1138.4-1716.4 (Actual: 1138.4-1711.7)
STIS/G230L 1582.0-3158.7 (Actual: 1583.8-3152.0)
STIS/G230LB 1667.1-3071.6 (Actual: 1670.9-3072.7)
STIS/G430L 2895.9-5704.4 (Actual: 2983.7-5708.0)
STIS/G750L 5261.3-10252.3 (Actual: 5318.5-10256.6)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G140L
Abutting STIS/G230L product to current result
With a transition wavelength of 1711.673614241657
Abutting STIS/G430L product to current result
With a transition wavelength of 3151.9512669041987
Abutting STIS/G750L product to current result
With a transition wavelength of 5704.4
Truncating current grating at 10252.3
./stis_products/hst_7656_stis_gd71_sg140l-sg230l-g430l-g750l_o4a520_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_sg140l-sg230l-g430l-g750l_o4a520_cspec.fits
Processing product (7656, &#39;51&#39;)
Targets in visit (7656, &#39;51&#39;): [&#39;GD71&#39;]
Processing target GD71 in visit (7656, &#39;51&#39;)
Processing grating STIS/G750L
Importing files [&#39;./stis_data/o4a551020_sx1.fits&#39;]
Processing file ./stis_data/o4a551020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_g750l_o4a551_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_g750l_o4a551_cspec.fits
Processing grating STIS/G430L
Importing files [&#39;./stis_data/o4a551030_sx1.fits&#39;]
Processing file ./stis_data/o4a551030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_g430l_o4a551_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_g430l_o4a551_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;./stis_data/o4a551040_sx1.fits&#39;]
Processing file ./stis_data/o4a551040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_g230lb_o4a551_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_g230lb_o4a551_cspec.fits
Processing grating STIS/G230L
Importing files [&#39;./stis_data/o4a551050_x1d.fits&#39;]
Processing file ./stis_data/o4a551050_x1d.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_sg230l_o4a551_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_sg230l_o4a551_cspec.fits
Processing grating STIS/G140L
Importing files [&#39;./stis_data/o4a551060_x1d.fits&#39;]
Processing file ./stis_data/o4a551060_x1d.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_sg140l_o4a551_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_sg140l_o4a551_cspec.fits
Making a product from these gratings
STIS/G140L 1138.4-1716.4 (Actual: 1138.8-1717.1)
STIS/G230L 1582.0-3158.7 (Actual: 1581.8-3150.2)
STIS/G230LB 1667.1-3071.6 (Actual: 1670.4-3072.5)
STIS/G430L 2895.9-5704.4 (Actual: 2982.9-5707.7)
STIS/G750L 5261.3-10252.3 (Actual: 5315.9-10254.7)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G140L
Abutting STIS/G230L product to current result
With a transition wavelength of 1716.4
Abutting STIS/G430L product to current result
With a transition wavelength of 3150.199723521522
Abutting STIS/G750L product to current result
With a transition wavelength of 5704.4
Truncating current grating at 10252.3
./stis_products/hst_7656_stis_gd71_sg140l-sg230l-g430l-g750l_o4a551_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_sg140l-sg230l-g430l-g750l_o4a551_cspec.fits
Looping over proposals
Processing product 7656
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Targets in proposal 7656: [&#39;GD71&#39;]
Processing target GD71 in proposal 7656
Processing grating STIS/G750L
Importing files [&#39;./stis_data/o4a520020_sx1.fits&#39;, &#39;./stis_data/o4a551020_sx1.fits&#39;]
Processing file ./stis_data/o4a520020_sx1.fits
Processing file ./stis_data/o4a551020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_g750l_o4a5_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_g750l_o4a5_cspec.fits
Processing grating STIS/G430L
Importing files [&#39;./stis_data/o4a520030_sx1.fits&#39;, &#39;./stis_data/o4a551030_sx1.fits&#39;]
Processing file ./stis_data/o4a520030_sx1.fits
Processing file ./stis_data/o4a551030_sx1.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_g430l_o4a5_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_g430l_o4a5_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;./stis_data/o4a520040_sx1.fits&#39;, &#39;./stis_data/o4a551040_sx1.fits&#39;]
Processing file ./stis_data/o4a520040_sx1.fits
Processing file ./stis_data/o4a551040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./stis_products/hst_7656_stis_gd71_g230lb_o4a5_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_g230lb_o4a5_cspec.fits
Processing grating STIS/G230L
Importing files [&#39;./stis_data/o4a520050_x1d.fits&#39;, &#39;./stis_data/o4a551050_x1d.fits&#39;]
Processing file ./stis_data/o4a520050_x1d.fits
Processing file ./stis_data/o4a551050_x1d.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_sg230l_o4a5_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_sg230l_o4a5_cspec.fits
Processing grating STIS/G140L
Importing files [&#39;./stis_data/o4a520060_x1d.fits&#39;, &#39;./stis_data/o4a551060_x1d.fits&#39;]
Processing file ./stis_data/o4a520060_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./stis_data/o4a551060_x1d.fits
Using a maximum SNR of 20.0 in flux-based filtering
./stis_products/hst_7656_stis_gd71_sg140l_o4a5_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_sg140l_o4a5_cspec.fits
Making a product from these gratings
STIS/G140L 1138.4-1716.4 (Actual: 1138.4-1717.4)
STIS/G230L 1582.0-3158.7 (Actual: 1581.8-3151.8)
STIS/G230LB 1667.1-3071.6 (Actual: 1670.4-3072.5)
STIS/G430L 2895.9-5704.4 (Actual: 2982.5-5707.6)
STIS/G750L 5261.3-10252.3 (Actual: 5315.9-10254.7)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G140L
Abutting STIS/G230L product to current result
With a transition wavelength of 1716.4
Abutting STIS/G430L product to current result
With a transition wavelength of 3151.7526296530705
Abutting STIS/G750L product to current result
With a transition wavelength of 5704.4
Truncating current grating at 10252.3
./stis_products/hst_7656_stis_gd71_sg140l-sg230l-g430l-g750l_o4a5_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./stis_products/hst_7656_stis_gd71_sg140l-sg230l-g430l-g750l_o4a5_cspec.fits
</pre></div>
</div>
</div>
</div>
<p>We have now created the co-added products for Program 7656 using the wrapper!</p>
<p><a id = workwithoutput></a></p>
</section>
<section id="working-with-co-added-data-products">
<h2>3. Working with Co-added Data Products<a class="headerlink" href="#working-with-co-added-data-products" title="Permalink to this heading">#</a></h2>
<p>With the newly co-added files in the <code class="docutils literal notranslate"><span class="pre">./stis_products/output</span></code> directory, we can begin to inspect the data.</p>
<p><a id = inspectoutput></a></p>
<section id="understanding-the-output-files">
<h3>3.1 Understanding the Output Files<a class="headerlink" href="#understanding-the-output-files" title="Permalink to this heading">#</a></h3>
<p><strong><em>The following information about the output file naming conventions is in our <a class="reference external" href="https://github.com/spacetelescope/hst_notebooks/tree/main/notebooks/HASP/Setup">Setup.ipynb</a> notebook. If you’re already familiar with this, you can skip to <span class="xref myst">Section 4.2</span>, where we view our co-added spectra.</em></strong></p>
<p>Let’s look at the <code class="docutils literal notranslate"><span class="pre">./stis_products/output</span></code> directory to look at the newly abutted spectra. Currently, the script outputs abutted products for a single program.</p>
<p>The script produces multiple different files with abutted spectra. Currently, the script outputs abutted products for a single program. It first creates co-added spectra for each grating of a single observation set:</p>
<p><code class="docutils literal notranslate"><span class="pre">hst_programID_instrument_targetname_grating_obset_cspec.fits</span></code></p>
<p>It then co-adds the spectra of all gratings for a single observation set:</p>
<p><code class="docutils literal notranslate"><span class="pre">hst_programID_instrument_targetname_allGratings_obset_cspec.fits</span></code></p>
<p>Finally, it co-adds all abutted observation sets’ spectra to create a final co-added product for a single target:</p>
<p><code class="docutils literal notranslate"><span class="pre">hst_programID_instrument_targetname_allGratings_cspec.fits</span></code></p>
<p>An example of this is below. These filenames are the output files for our STIS GD71 dataset that is co-added in this notebook. Here, the <code class="docutils literal notranslate"><span class="pre">programID</span></code> is <code class="docutils literal notranslate"><span class="pre">7656</span></code>, the <code class="docutils literal notranslate"><span class="pre">instrument</span></code> is <code class="docutils literal notranslate"><span class="pre">STIS</span></code>, and the <code class="docutils literal notranslate"><span class="pre">targetname</span></code> is <code class="docutils literal notranslate"><span class="pre">gd71</span></code>.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Step</p></th>
<th class="head"><p>Filename</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hst_7656_stis_gd71_g140l_o4a520_cspec.fits</span></code></p></td>
<td><p>Co-adding all <code class="docutils literal notranslate"><span class="pre">G140L</span></code> observations for the observation set, <code class="docutils literal notranslate"><span class="pre">O4A520</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hst_7656_stis_gd71_g140l-g230l-g430l-g750l_o4a520_cspec.fits</span></code></p></td>
<td><p>Co-adding all observations taken at every grating for the observation set, <code class="docutils literal notranslate"><span class="pre">O4A520</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">hst_7656_stis_gd71_g140l-g230l-g430l-g750l_o4a5_cspec.fits</span></code></p></td>
<td><p>Co-adding all GD71 observations at each grating for this program, <code class="docutils literal notranslate"><span class="pre">O4A5</span></code>.</p></td>
</tr>
</tbody>
</table>
<p><em><strong>Note: HST file naming conventions use a combination of three letters and/or numbers to have a unique association between a PI’s proposal ID and program ID, meaning that <code class="docutils literal notranslate"><span class="pre">o4a5</span></code> at the end of <code class="docutils literal notranslate"><span class="pre">hst_7656_stis_gd71_g140l-g230l-g430l-g750l_o4a5_cspec.fits</span></code> is essentially the program ID for our example. Check out more information on the <a class="reference external" href="https://archive.stsci.edu/hlsp/ipppssoot.html">MAST HST file naming convention page</a></strong></em></p>
<p><a id = viewstis></a></p>
</section>
<section id="viewing-the-co-added-data">
<h3>3.2 Viewing the Co-added Data<a class="headerlink" href="#viewing-the-co-added-data" title="Permalink to this heading">#</a></h3>
<p>Let’s take a look at the co-added spectra that we just created. We will create a plot of flux as a function of wavelength using <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code>.</p>
<p>With the current version of the HASP script, the fully abutted filename should be:</p>
<p><code class="docutils literal notranslate"><span class="pre">hst_7656_stis_gd71_sg140l-sg230l-g430l-g750l_o4a5_cspec.fits</span></code></p>
<p>Double check your products folder to make sure the name of your fully co-added spectra is the same as above, otherwise the subsequent cells in this notebook will not run since the pathname won’t exist. Update and run the cell below with the full co-add filename.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stis_coadd_filename</span> <span class="o">=</span> <span class="s2">&quot;hst_7656_stis_gd71_sg140l-sg230l-g430l-g750l_o4a5_cspec.fits&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We are plotting wavelength vs flux for our co-added spectra</span>
<span class="c1"># Getting the file&#39;s data</span>
<span class="n">gd71_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;./</span><span class="si">{</span><span class="n">stis_products_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">stis_coadd_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># Getting the wavelength and flux data for the abutted file</span>
<span class="n">wavelength</span> <span class="o">=</span> <span class="n">gd71_data</span><span class="p">[</span><span class="s2">&quot;WAVELENGTH&quot;</span><span class="p">]</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">gd71_data</span><span class="p">[</span><span class="s2">&quot;FLUX&quot;</span><span class="p">]</span>

<span class="c1"># Plotting the spectra</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span>
            <span class="c1"># Setting the size of the data points</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Formatting the plot by adding titles</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;STIS GD71, abutted&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux [$erg\ s^{-1}\ cm^{-2}\ \AA^{-1}$]&#39;</span><span class="p">)</span>

<span class="c1"># Saving the figure to the ./stis_products_dir</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stis_products_dir</span><span class="si">}</span><span class="s2">/gd71_stis.png&quot;</span><span class="p">)</span>

<span class="c1"># Showing the plot below</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/b13d6ccefe45419d864d5fa2e0e9d069430cbb71b7e48b60aaed2511b53e5005.png" src="../../../_images/b13d6ccefe45419d864d5fa2e0e9d069430cbb71b7e48b60aaed2511b53e5005.png" />
</div>
</div>
<p><a id = cos></a></p>
</section>
<section id="putting-it-all-together-with-cos-data">
<h3>3.3 Putting it all together with COS data<a class="headerlink" href="#putting-it-all-together-with-cos-data" title="Permalink to this heading">#</a></h3>
<p>Let’s combine all of the STIS work from above and do another example, but this time using COS data instead of STIS. We will use the same target, GD71, and download the data from Program 11479. This has observations of GD71 using the gratings <code class="docutils literal notranslate"><span class="pre">G230L</span></code>, <code class="docutils literal notranslate"><span class="pre">G185M</span></code>, <code class="docutils literal notranslate"><span class="pre">G225M</span></code>, and <code class="docutils literal notranslate"><span class="pre">G285M</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Querying the COS data in MAST and getting the product list</span>
<span class="n">gd71_products</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span>
    <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span>
        <span class="n">proposal_id</span><span class="o">=</span><span class="mi">11479</span><span class="p">,</span>
        <span class="n">target_name</span><span class="o">=</span><span class="s2">&quot;GD71&quot;</span><span class="p">,</span>
        <span class="n">dataproduct_type</span><span class="o">=</span><span class="s2">&quot;SPECTRUM&quot;</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Downloading the data to the ./cos_data directory</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span>
    <span class="n">gd71_products</span><span class="p">,</span>
    <span class="n">download_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">cos_data_dir</span><span class="p">),</span>
    <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X1D&quot;</span><span class="p">,</span> <span class="s2">&quot;SX1&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Consolidating all of our files to a single directory</span>
<span class="n">consolidate_files</span><span class="p">(</span><span class="n">cos_data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02d9q_x1d.fits to cos_data/mastDownload/HST/laad02d9q/laad02d9q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02d9q/laad02d9q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02dcq_x1d.fits to cos_data/mastDownload/HST/laad02dcq/laad02dcq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02dcq/laad02dcq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02deq_x1d.fits to cos_data/mastDownload/HST/laad02deq/laad02deq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02deq/laad02deq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02dgq_x1d.fits to cos_data/mastDownload/HST/laad02dgq/laad02dgq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02dgq/laad02dgq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02diq_x1d.fits to cos_data/mastDownload/HST/laad02diq/laad02diq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02diq/laad02diq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02dkq_x1d.fits to cos_data/mastDownload/HST/laad02dkq/laad02dkq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02dkq/laad02dkq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02dmq_x1d.fits to cos_data/mastDownload/HST/laad02dmq/laad02dmq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02dmq/laad02dmq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02doq_x1d.fits to cos_data/mastDownload/HST/laad02doq/laad02doq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02doq/laad02doq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02dqq_x1d.fits to cos_data/mastDownload/HST/laad02dqq/laad02dqq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02dqq/laad02dqq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02dsq_x1d.fits to cos_data/mastDownload/HST/laad02dsq/laad02dsq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02dsq/laad02dsq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02duq_x1d.fits to cos_data/mastDownload/HST/laad02duq/laad02duq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02duq/laad02duq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02dwq_x1d.fits to cos_data/mastDownload/HST/laad02dwq/laad02dwq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02dwq/laad02dwq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02dyq_x1d.fits to cos_data/mastDownload/HST/laad02dyq/laad02dyq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02dyq/laad02dyq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02e0q_x1d.fits to cos_data/mastDownload/HST/laad02e0q/laad02e0q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02e0q/laad02e0q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02e6q_x1d.fits to cos_data/mastDownload/HST/laad02e6q/laad02e6q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02e6q/laad02e6q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02e8q_x1d.fits to cos_data/mastDownload/HST/laad02e8q/laad02e8q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02e8q/laad02e8q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02eaq_x1d.fits to cos_data/mastDownload/HST/laad02eaq/laad02eaq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02eaq/laad02eaq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02edq_x1d.fits to cos_data/mastDownload/HST/laad02edq/laad02edq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02edq/laad02edq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02efq_x1d.fits to cos_data/mastDownload/HST/laad02efq/laad02efq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02efq/laad02efq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02ehq_x1d.fits to cos_data/mastDownload/HST/laad02ehq/laad02ehq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02ehq/laad02ehq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02ejq_x1d.fits to cos_data/mastDownload/HST/laad02ejq/laad02ejq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02ejq/laad02ejq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02elq_x1d.fits to cos_data/mastDownload/HST/laad02elq/laad02elq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02elq/laad02elq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02enq_x1d.fits to cos_data/mastDownload/HST/laad02enq/laad02enq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02enq/laad02enq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02epq_x1d.fits to cos_data/mastDownload/HST/laad02epq/laad02epq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02epq/laad02epq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02erq_x1d.fits to cos_data/mastDownload/HST/laad02erq/laad02erq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02erq/laad02erq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02etq_x1d.fits to cos_data/mastDownload/HST/laad02etq/laad02etq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02etq/laad02etq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02evq_x1d.fits to cos_data/mastDownload/HST/laad02evq/laad02evq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02evq/laad02evq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02exq_x1d.fits to cos_data/mastDownload/HST/laad02exq/laad02exq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02exq/laad02exq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02ezq_x1d.fits to cos_data/mastDownload/HST/laad02ezq/laad02ezq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02ezq/laad02ezq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02f1q_x1d.fits to cos_data/mastDownload/HST/laad02f1q/laad02f1q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02f1q/laad02f1q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02f3q_x1d.fits to cos_data/mastDownload/HST/laad02f3q/laad02f3q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02f3q/laad02f3q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02f5q_x1d.fits to cos_data/mastDownload/HST/laad02f5q/laad02f5q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02f5q/laad02f5q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02f7q_x1d.fits to cos_data/mastDownload/HST/laad02f7q/laad02f7q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02f7q/laad02f7q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02fdq_x1d.fits to cos_data/mastDownload/HST/laad02fdq/laad02fdq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02fdq/laad02fdq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02ffq_x1d.fits to cos_data/mastDownload/HST/laad02ffq/laad02ffq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02ffq/laad02ffq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02fhq_x1d.fits to cos_data/mastDownload/HST/laad02fhq/laad02fhq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02fhq/laad02fhq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02foq_x1d.fits to cos_data/mastDownload/HST/laad02foq/laad02foq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02foq/laad02foq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02frq_x1d.fits to cos_data/mastDownload/HST/laad02frq/laad02frq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02frq/laad02frq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad02fwq_x1d.fits to cos_data/mastDownload/HST/laad02fwq/laad02fwq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad02fwq/laad02fwq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03vxq_x1d.fits to cos_data/mastDownload/HST/laad03vxq/laad03vxq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03vxq/laad03vxq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03vzq_x1d.fits to cos_data/mastDownload/HST/laad03vzq/laad03vzq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03vzq/laad03vzq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03w4q_x1d.fits to cos_data/mastDownload/HST/laad03w4q/laad03w4q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03w4q/laad03w4q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03w7q_x1d.fits to cos_data/mastDownload/HST/laad03w7q/laad03w7q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03w7q/laad03w7q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03w9q_x1d.fits to cos_data/mastDownload/HST/laad03w9q/laad03w9q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03w9q/laad03w9q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03wbq_x1d.fits to cos_data/mastDownload/HST/laad03wbq/laad03wbq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03wbq/laad03wbq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03wdq_x1d.fits to cos_data/mastDownload/HST/laad03wdq/laad03wdq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03wdq/laad03wdq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03wfq_x1d.fits to cos_data/mastDownload/HST/laad03wfq/laad03wfq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03wfq/laad03wfq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03wmq_x1d.fits to cos_data/mastDownload/HST/laad03wmq/laad03wmq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03wmq/laad03wmq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03woq_x1d.fits to cos_data/mastDownload/HST/laad03woq/laad03woq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03woq/laad03woq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03wqq_x1d.fits to cos_data/mastDownload/HST/laad03wqq/laad03wqq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03wqq/laad03wqq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03wyq_x1d.fits to cos_data/mastDownload/HST/laad03wyq/laad03wyq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03wyq/laad03wyq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03xuq_x1d.fits to cos_data/mastDownload/HST/laad03xuq/laad03xuq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03xuq/laad03xuq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03xyq_x1d.fits to cos_data/mastDownload/HST/laad03xyq/laad03xyq_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03xyq/laad03xyq_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03y0q_x1d.fits to cos_data/mastDownload/HST/laad03y0q/laad03y0q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03y0q/laad03y0q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03y3q_x1d.fits to cos_data/mastDownload/HST/laad03y3q/laad03y3q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03y3q/laad03y3q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03y5q_x1d.fits to cos_data/mastDownload/HST/laad03y5q/laad03y5q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03y5q/laad03y5q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/laad03y7q_x1d.fits to cos_data/mastDownload/HST/laad03y7q/laad03y7q_x1d.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file cos_data/mastDownload/HST/laad03y7q/laad03y7q_x1d.fits with expected size 429120. [astroquery.query]
</pre></div>
</div>
</div>
</div>
<p>Now we run the wrapper script:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>swrapper<span class="w"> </span>-i<span class="w"> </span>./cos_data<span class="w"> </span>-o<span class="w"> </span>./cos_products
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HASP version 0.9.6
Ullyses version 4.1.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Creating list of unique modes from these files:
./cos_data/laad02d9q_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02dcq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02deq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02dgq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02diq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02dkq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02dmq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02doq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02dqq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02dsq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02duq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02dwq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02dyq_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02e0q_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02e6q_x1d.fits GD71 COS NUV G225M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02e8q_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02eaq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02edq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02efq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02ehq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02ejq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02elq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02enq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02epq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02erq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02etq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02evq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02exq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02ezq_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02f1q_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02f3q_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02f5q_x1d.fits GD71 COS NUV G185M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02f7q_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02fdq_x1d.fits GD71 COS NUV G230L PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02ffq_x1d.fits GD71 COS NUV G230L PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02fhq_x1d.fits GD71 COS NUV G230L PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02foq_x1d.fits GD71 COS NUV G230L PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02frq_x1d.fits GD71 COS NUV G230L PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad02fwq_x1d.fits GD71 COS NUV G230L PSA 11479 (11479, &#39;02&#39;)
./cos_data/laad03vxq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03vzq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03w4q_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03w7q_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03w9q_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03wbq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03wdq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03wfq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03wmq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03woq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03wqq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03wyq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03xuq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03xyq_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03y0q_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./cos_data/laad03y3q_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03y5q_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
./cos_data/laad03y7q_x1d.fits GD71 COS NUV G285M PSA 11479 (11479, &#39;03&#39;)
Looping over visits
Processing product (11479, &#39;02&#39;)
Targets in visit (11479, &#39;02&#39;): [&#39;GD71&#39;]
Processing target GD71 in visit (11479, &#39;02&#39;)
Processing grating COS/G225M
Importing files [&#39;./cos_data/laad02d9q_x1d.fits&#39;, &#39;./cos_data/laad02dcq_x1d.fits&#39;, &#39;./cos_data/laad02deq_x1d.fits&#39;, &#39;./cos_data/laad02dgq_x1d.fits&#39;, &#39;./cos_data/laad02diq_x1d.fits&#39;, &#39;./cos_data/laad02dkq_x1d.fits&#39;, &#39;./cos_data/laad02dmq_x1d.fits&#39;, &#39;./cos_data/laad02doq_x1d.fits&#39;, &#39;./cos_data/laad02dqq_x1d.fits&#39;, &#39;./cos_data/laad02dsq_x1d.fits&#39;, &#39;./cos_data/laad02duq_x1d.fits&#39;, &#39;./cos_data/laad02dwq_x1d.fits&#39;, &#39;./cos_data/laad02dyq_x1d.fits&#39;, &#39;./cos_data/laad02e0q_x1d.fits&#39;, &#39;./cos_data/laad02e6q_x1d.fits&#39;]
Processing file ./cos_data/laad02d9q_x1d.fits
Processing file ./cos_data/laad02dcq_x1d.fits
Processing file ./cos_data/laad02deq_x1d.fits
Processing file ./cos_data/laad02dgq_x1d.fits
Processing file ./cos_data/laad02diq_x1d.fits
Processing file ./cos_data/laad02dkq_x1d.fits
Processing file ./cos_data/laad02dmq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02doq_x1d.fits
Processing file ./cos_data/laad02dqq_x1d.fits
Processing file ./cos_data/laad02dsq_x1d.fits
Processing file ./cos_data/laad02duq_x1d.fits
Processing file ./cos_data/laad02dwq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02dyq_x1d.fits
Processing file ./cos_data/laad02e0q_x1d.fits
Processing file ./cos_data/laad02e6q_x1d.fits
/usr/share/miniconda/lib/python3.11/site-packages/ullyses/coadd.py:563: RuntimeWarning: invalid value encountered in divide
  thru_nans = segment.data[&#39;net&#39;] / segment.data[&#39;flux&#39;]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using a maximum SNR of 20.0 in flux-based filtering
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./cos_products/hst_11479_cos_gd71_g225m_laad02_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_g225m_laad02_cspec.fits
Processing grating COS/G185M
Importing files [&#39;./cos_data/laad02e8q_x1d.fits&#39;, &#39;./cos_data/laad02eaq_x1d.fits&#39;, &#39;./cos_data/laad02edq_x1d.fits&#39;, &#39;./cos_data/laad02efq_x1d.fits&#39;, &#39;./cos_data/laad02ehq_x1d.fits&#39;, &#39;./cos_data/laad02ejq_x1d.fits&#39;, &#39;./cos_data/laad02elq_x1d.fits&#39;, &#39;./cos_data/laad02enq_x1d.fits&#39;, &#39;./cos_data/laad02epq_x1d.fits&#39;, &#39;./cos_data/laad02erq_x1d.fits&#39;, &#39;./cos_data/laad02etq_x1d.fits&#39;, &#39;./cos_data/laad02evq_x1d.fits&#39;, &#39;./cos_data/laad02exq_x1d.fits&#39;, &#39;./cos_data/laad02ezq_x1d.fits&#39;, &#39;./cos_data/laad02f1q_x1d.fits&#39;, &#39;./cos_data/laad02f3q_x1d.fits&#39;, &#39;./cos_data/laad02f5q_x1d.fits&#39;]
Processing file ./cos_data/laad02e8q_x1d.fits
Processing file ./cos_data/laad02eaq_x1d.fits
Processing file ./cos_data/laad02edq_x1d.fits
Processing file ./cos_data/laad02efq_x1d.fits
Processing file ./cos_data/laad02ehq_x1d.fits
Processing file ./cos_data/laad02ejq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02elq_x1d.fits
Processing file ./cos_data/laad02enq_x1d.fits
Processing file ./cos_data/laad02epq_x1d.fits
Processing file ./cos_data/laad02erq_x1d.fits
Processing file ./cos_data/laad02etq_x1d.fits
Processing file ./cos_data/laad02evq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02exq_x1d.fits
Processing file ./cos_data/laad02ezq_x1d.fits
Processing file ./cos_data/laad02f1q_x1d.fits
Processing file ./cos_data/laad02f3q_x1d.fits
Processing file ./cos_data/laad02f5q_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using a maximum SNR of 20.0 in flux-based filtering
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./cos_products/hst_11479_cos_gd71_g185m_laad02_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_g185m_laad02_cspec.fits
Processing grating COS/G285M
Importing files [&#39;./cos_data/laad02f7q_x1d.fits&#39;]
Processing file ./cos_data/laad02f7q_x1d.fits
Using a maximum SNR of 20.0 in flux-based filtering
./cos_products/hst_11479_cos_gd71_g285m_laad02_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_g285m_laad02_cspec.fits
Processing grating COS/G230L
Importing files [&#39;./cos_data/laad02fdq_x1d.fits&#39;, &#39;./cos_data/laad02ffq_x1d.fits&#39;, &#39;./cos_data/laad02fhq_x1d.fits&#39;, &#39;./cos_data/laad02foq_x1d.fits&#39;, &#39;./cos_data/laad02frq_x1d.fits&#39;, &#39;./cos_data/laad02fwq_x1d.fits&#39;]
Processing file ./cos_data/laad02fdq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02ffq_x1d.fits
Processing file ./cos_data/laad02fhq_x1d.fits
Processing file ./cos_data/laad02foq_x1d.fits
Processing file ./cos_data/laad02frq_x1d.fits
Processing file ./cos_data/laad02fwq_x1d.fits
Segment NUVC removed from product for setting COS/G230L
Segment NUVC removed from product for setting COS/G230L
Segment NUVC removed from product for setting COS/G230L
Segment NUVC removed from product for setting COS/G230L
Segment NUVC removed from product for setting COS/G230L
Segment NUVC removed from product for setting COS/G230L
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using a maximum SNR of 20.0 in flux-based filtering
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./cos_products/hst_11479_cos_gd71_cg230l_laad02_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_cg230l_laad02_cspec.fits
Making a product from these gratings
COS/G185M 1664-2134 (Actual: 1662.1-2135.4)
COS/G225M 2069-2526 (Actual: 2068.4-2526.4)
COS/G285M 2474-3221 (Actual: 2967.5-3226.9)
COS/G230L 1650-3200 (Actual: 1327.3-3620.0)
Transition wavelengths tweaked
Starting at the short wavelength end with grating COS/G230L
Abutting COS/G185M product to current result
With a transition wavelength of 1664
Abutting COS/G225M product to current result
With a transition wavelength of 2134
Abutting COS/G230L product to current result
With a transition wavelength of 2526
Abutting COS/G285M product to current result
With a transition wavelength of 2967.5105517364136
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Truncating current grating at 3221
./cos_products/hst_11479_cos_gd71_cg230l-g185m-g225m-g285m_laad02_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_cg230l-g185m-g225m-g285m_laad02_cspec.fits
Processing product (11479, &#39;03&#39;)
Targets in visit (11479, &#39;03&#39;): [&#39;GD71&#39;]
Processing target GD71 in visit (11479, &#39;03&#39;)
Processing grating COS/G285M
Importing files [&#39;./cos_data/laad03vxq_x1d.fits&#39;, &#39;./cos_data/laad03vzq_x1d.fits&#39;, &#39;./cos_data/laad03w4q_x1d.fits&#39;, &#39;./cos_data/laad03w7q_x1d.fits&#39;, &#39;./cos_data/laad03w9q_x1d.fits&#39;, &#39;./cos_data/laad03wbq_x1d.fits&#39;, &#39;./cos_data/laad03wdq_x1d.fits&#39;, &#39;./cos_data/laad03wfq_x1d.fits&#39;, &#39;./cos_data/laad03wmq_x1d.fits&#39;, &#39;./cos_data/laad03woq_x1d.fits&#39;, &#39;./cos_data/laad03wqq_x1d.fits&#39;, &#39;./cos_data/laad03wyq_x1d.fits&#39;, &#39;./cos_data/laad03xuq_x1d.fits&#39;, &#39;./cos_data/laad03xyq_x1d.fits&#39;, &#39;./cos_data/laad03y0q_x1d.fits&#39;, &#39;./cos_data/laad03y3q_x1d.fits&#39;, &#39;./cos_data/laad03y5q_x1d.fits&#39;, &#39;./cos_data/laad03y7q_x1d.fits&#39;]
Processing file ./cos_data/laad03vxq_x1d.fits
Processing file ./cos_data/laad03vzq_x1d.fits
Processing file ./cos_data/laad03w4q_x1d.fits
Processing file ./cos_data/laad03w7q_x1d.fits
Processing file ./cos_data/laad03w9q_x1d.fits
Processing file ./cos_data/laad03wbq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad03wdq_x1d.fits
Processing file ./cos_data/laad03wfq_x1d.fits
Processing file ./cos_data/laad03wmq_x1d.fits
Processing file ./cos_data/laad03woq_x1d.fits
Processing file ./cos_data/laad03wqq_x1d.fits
Processing file ./cos_data/laad03wyq_x1d.fits
Processing file ./cos_data/laad03xuq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad03xyq_x1d.fits
Processing file ./cos_data/laad03y0q_x1d.fits
Processing file ./cos_data/laad03y3q_x1d.fits
Processing file ./cos_data/laad03y5q_x1d.fits
Processing file ./cos_data/laad03y7q_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using a maximum SNR of 20.0 in flux-based filtering
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./cos_products/hst_11479_cos_gd71_g285m_laad03_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_g285m_laad03_cspec.fits
No need to create abutted product as &lt; 2 single grating products
Looping over proposals
Processing product 11479
Targets in proposal 11479: [&#39;GD71&#39;]
Processing target GD71 in proposal 11479
Processing grating COS/G225M
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Importing files [&#39;./cos_data/laad02d9q_x1d.fits&#39;, &#39;./cos_data/laad02dcq_x1d.fits&#39;, &#39;./cos_data/laad02deq_x1d.fits&#39;, &#39;./cos_data/laad02dgq_x1d.fits&#39;, &#39;./cos_data/laad02diq_x1d.fits&#39;, &#39;./cos_data/laad02dkq_x1d.fits&#39;, &#39;./cos_data/laad02dmq_x1d.fits&#39;, &#39;./cos_data/laad02doq_x1d.fits&#39;, &#39;./cos_data/laad02dqq_x1d.fits&#39;, &#39;./cos_data/laad02dsq_x1d.fits&#39;, &#39;./cos_data/laad02duq_x1d.fits&#39;, &#39;./cos_data/laad02dwq_x1d.fits&#39;, &#39;./cos_data/laad02dyq_x1d.fits&#39;, &#39;./cos_data/laad02e0q_x1d.fits&#39;, &#39;./cos_data/laad02e6q_x1d.fits&#39;]
Processing file ./cos_data/laad02d9q_x1d.fits
Processing file ./cos_data/laad02dcq_x1d.fits
Processing file ./cos_data/laad02deq_x1d.fits
Processing file ./cos_data/laad02dgq_x1d.fits
Processing file ./cos_data/laad02diq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02dkq_x1d.fits
Processing file ./cos_data/laad02dmq_x1d.fits
Processing file ./cos_data/laad02doq_x1d.fits
Processing file ./cos_data/laad02dqq_x1d.fits
Processing file ./cos_data/laad02dsq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02duq_x1d.fits
Processing file ./cos_data/laad02dwq_x1d.fits
Processing file ./cos_data/laad02dyq_x1d.fits
Processing file ./cos_data/laad02e0q_x1d.fits
Processing file ./cos_data/laad02e6q_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using a maximum SNR of 20.0 in flux-based filtering
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./cos_products/hst_11479_cos_gd71_g225m_laad_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_g225m_laad_cspec.fits
Processing grating COS/G185M
Importing files [&#39;./cos_data/laad02e8q_x1d.fits&#39;, &#39;./cos_data/laad02eaq_x1d.fits&#39;, &#39;./cos_data/laad02edq_x1d.fits&#39;, &#39;./cos_data/laad02efq_x1d.fits&#39;, &#39;./cos_data/laad02ehq_x1d.fits&#39;, &#39;./cos_data/laad02ejq_x1d.fits&#39;, &#39;./cos_data/laad02elq_x1d.fits&#39;, &#39;./cos_data/laad02enq_x1d.fits&#39;, &#39;./cos_data/laad02epq_x1d.fits&#39;, &#39;./cos_data/laad02erq_x1d.fits&#39;, &#39;./cos_data/laad02etq_x1d.fits&#39;, &#39;./cos_data/laad02evq_x1d.fits&#39;, &#39;./cos_data/laad02exq_x1d.fits&#39;, &#39;./cos_data/laad02ezq_x1d.fits&#39;, &#39;./cos_data/laad02f1q_x1d.fits&#39;, &#39;./cos_data/laad02f3q_x1d.fits&#39;, &#39;./cos_data/laad02f5q_x1d.fits&#39;]
Processing file ./cos_data/laad02e8q_x1d.fits
Processing file ./cos_data/laad02eaq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02edq_x1d.fits
Processing file ./cos_data/laad02efq_x1d.fits
Processing file ./cos_data/laad02ehq_x1d.fits
Processing file ./cos_data/laad02ejq_x1d.fits
Processing file ./cos_data/laad02elq_x1d.fits
Processing file ./cos_data/laad02enq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02epq_x1d.fits
Processing file ./cos_data/laad02erq_x1d.fits
Processing file ./cos_data/laad02etq_x1d.fits
Processing file ./cos_data/laad02evq_x1d.fits
Processing file ./cos_data/laad02exq_x1d.fits
Processing file ./cos_data/laad02ezq_x1d.fits
Processing file ./cos_data/laad02f1q_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02f3q_x1d.fits
Processing file ./cos_data/laad02f5q_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using a maximum SNR of 20.0 in flux-based filtering
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./cos_products/hst_11479_cos_gd71_g185m_laad_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_g185m_laad_cspec.fits
Processing grating COS/G285M
Importing files [&#39;./cos_data/laad02f7q_x1d.fits&#39;, &#39;./cos_data/laad03vxq_x1d.fits&#39;, &#39;./cos_data/laad03vzq_x1d.fits&#39;, &#39;./cos_data/laad03w4q_x1d.fits&#39;, &#39;./cos_data/laad03w7q_x1d.fits&#39;, &#39;./cos_data/laad03w9q_x1d.fits&#39;, &#39;./cos_data/laad03wbq_x1d.fits&#39;, &#39;./cos_data/laad03wdq_x1d.fits&#39;, &#39;./cos_data/laad03wfq_x1d.fits&#39;, &#39;./cos_data/laad03wmq_x1d.fits&#39;, &#39;./cos_data/laad03woq_x1d.fits&#39;, &#39;./cos_data/laad03wqq_x1d.fits&#39;, &#39;./cos_data/laad03wyq_x1d.fits&#39;, &#39;./cos_data/laad03xuq_x1d.fits&#39;, &#39;./cos_data/laad03xyq_x1d.fits&#39;, &#39;./cos_data/laad03y0q_x1d.fits&#39;, &#39;./cos_data/laad03y3q_x1d.fits&#39;, &#39;./cos_data/laad03y5q_x1d.fits&#39;, &#39;./cos_data/laad03y7q_x1d.fits&#39;]
Processing file ./cos_data/laad02f7q_x1d.fits
Processing file ./cos_data/laad03vxq_x1d.fits
Processing file ./cos_data/laad03vzq_x1d.fits
Processing file ./cos_data/laad03w4q_x1d.fits
Processing file ./cos_data/laad03w7q_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad03w9q_x1d.fits
Processing file ./cos_data/laad03wbq_x1d.fits
Processing file ./cos_data/laad03wdq_x1d.fits
Processing file ./cos_data/laad03wfq_x1d.fits
Processing file ./cos_data/laad03wmq_x1d.fits
Processing file ./cos_data/laad03woq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad03wqq_x1d.fits
Processing file ./cos_data/laad03wyq_x1d.fits
Processing file ./cos_data/laad03xuq_x1d.fits
Processing file ./cos_data/laad03xyq_x1d.fits
Processing file ./cos_data/laad03y0q_x1d.fits
Processing file ./cos_data/laad03y3q_x1d.fits
Processing file ./cos_data/laad03y5q_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad03y7q_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using a maximum SNR of 20.0 in flux-based filtering
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./cos_products/hst_11479_cos_gd71_g285m_laad_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_g285m_laad_cspec.fits
Processing grating COS/G230L
Importing files [&#39;./cos_data/laad02fdq_x1d.fits&#39;, &#39;./cos_data/laad02ffq_x1d.fits&#39;, &#39;./cos_data/laad02fhq_x1d.fits&#39;, &#39;./cos_data/laad02foq_x1d.fits&#39;, &#39;./cos_data/laad02frq_x1d.fits&#39;, &#39;./cos_data/laad02fwq_x1d.fits&#39;]
Processing file ./cos_data/laad02fdq_x1d.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing file ./cos_data/laad02ffq_x1d.fits
Processing file ./cos_data/laad02fhq_x1d.fits
Processing file ./cos_data/laad02foq_x1d.fits
Processing file ./cos_data/laad02frq_x1d.fits
Processing file ./cos_data/laad02fwq_x1d.fits
Segment NUVC removed from product for setting COS/G230L
Segment NUVC removed from product for setting COS/G230L
Segment NUVC removed from product for setting COS/G230L
Segment NUVC removed from product for setting COS/G230L
Segment NUVC removed from product for setting COS/G230L
Segment NUVC removed from product for setting COS/G230L
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using a maximum SNR of 20.0 in flux-based filtering
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./cos_products/hst_11479_cos_gd71_cg230l_laad_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_cg230l_laad_cspec.fits
Making a product from these gratings
COS/G185M 1664-2134 (Actual: 1662.1-2135.4)
COS/G225M 2069-2526 (Actual: 2068.4-2526.4)
COS/G285M 2474-3221 (Actual: 2473.8-3226.9)
COS/G230L 1650-3200 (Actual: 1327.3-3620.0)
Starting at the short wavelength end with grating COS/G230L
Abutting COS/G185M product to current result
With a transition wavelength of 1664
Abutting COS/G225M product to current result
With a transition wavelength of 2134
Abutting COS/G285M product to current result
With a transition wavelength of 2526
Truncating current grating at 3221
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./cos_products/hst_11479_cos_gd71_cg230l-g185m-g225m-g285m_laad_cspec.fits already exists and overwrite=False, skipping write
   Wrote ./cos_products/hst_11479_cos_gd71_cg230l-g185m-g225m-g285m_laad_cspec.fits
</pre></div>
</div>
</div>
</div>
<p>Similar to our STIS example, ensure that the filename is updated to the current HASP version by running and/or updating the next cell, then plot the newly abutted COS spectra:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cos_coadd_filename</span> <span class="o">=</span> <span class="s2">&quot;hst_11479_cos_gd71_cg230l-g185m-g225m-g285m_laad_cspec.fits&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Getting the file&#39;s data</span>
<span class="n">gd71_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cos_products_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">cos_coadd_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># Getting the wavelength and flux data for the abutted file</span>
<span class="n">wavelength</span> <span class="o">=</span> <span class="n">gd71_data</span><span class="p">[</span><span class="s2">&quot;WAVELENGTH&quot;</span><span class="p">]</span>
<span class="n">flux</span> <span class="o">=</span> <span class="n">gd71_data</span><span class="p">[</span><span class="s2">&quot;FLUX&quot;</span><span class="p">]</span>

<span class="c1"># Plotting the spectra</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Formatting the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;COS GD71, abutted&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux [$erg\ s^{-1}\ cm^{-2}\ \AA^{-1}$]&#39;</span><span class="p">)</span>

<span class="c1"># Saving the figure to ./cos_products</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cos_products_dir</span><span class="si">}</span><span class="s2">/gd71_cos.png&quot;</span><span class="p">)</span>

<span class="c1"># Showing the figure below</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/e03ff56cb6f32d981d7f5812df681237dba9c225427120b0598b157ecc2e8ab9.png" src="../../../_images/e03ff56cb6f32d981d7f5812df681237dba9c225427120b0598b157ecc2e8ab9.png" />
</div>
</div>
<p>We have now created and plotted the abutted COS spectra. Just for fun, let’s compare the abutted STIS and COS products!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Getting the COS and STIS data</span>
<span class="n">stis_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stis_products_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">stis_coadd_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">cos_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cos_products_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">cos_coadd_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># Getting the flux and wavelengths for both files</span>
<span class="n">stis_wavelength</span> <span class="o">=</span> <span class="n">stis_data</span><span class="p">[</span><span class="s2">&quot;WAVELENGTH&quot;</span><span class="p">]</span>
<span class="n">stis_flux</span> <span class="o">=</span> <span class="n">stis_data</span><span class="p">[</span><span class="s2">&quot;FLUX&quot;</span><span class="p">]</span>

<span class="n">cos_wavelength</span> <span class="o">=</span> <span class="n">cos_data</span><span class="p">[</span><span class="s2">&quot;WAVELENGTH&quot;</span><span class="p">]</span>
<span class="n">cos_flux</span> <span class="o">=</span> <span class="n">cos_data</span><span class="p">[</span><span class="s2">&quot;FLUX&quot;</span><span class="p">]</span>

<span class="c1"># Plotting datapoints for STIS</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">stis_wavelength</span><span class="p">,</span> <span class="n">stis_flux</span><span class="p">,</span>
            <span class="c1"># Setting the size of the datapoints</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="c1"># Setting the color for the STIS datapoints</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span>
            <span class="c1"># Adding a label for the legend</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;STIS&quot;</span><span class="p">)</span>

<span class="c1"># Plotting the datapoints for COS</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cos_wavelength</span><span class="p">,</span> <span class="n">cos_flux</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;COS&quot;</span><span class="p">)</span>

<span class="c1"># Formatting the plot by adding labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;STIS &amp; COS GD71, abutted&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux [$erg\ s^{-1}\ cm^{-2}\ \AA^{-1}$]&#39;</span><span class="p">)</span>

<span class="c1"># Adding a legend to the plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Saving the figure to our general directory</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;./gd71_cos_stis.png&quot;</span><span class="p">)</span>

<span class="c1"># Showing the plot below</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/edd6c848329cb7ff9092191168c293fc74104d484a4ed453356ae88aa9f21393.png" src="../../../_images/edd6c848329cb7ff9092191168c293fc74104d484a4ed453356ae88aa9f21393.png" />
</div>
</div>
<p><a id = threshold></a></p>
</section>
</section>
<section id="changing-the-threshold-flag">
<h2>4. Changing the Threshold Flag<a class="headerlink" href="#changing-the-threshold-flag" title="Permalink to this heading">#</a></h2>
<p>The flux threshold flag is an optional flag that can be used to change the number of files that are co-added based on the flux of each spectra. When determining which files to abut, the script first creates a general co-add using all of the input files, and then iterates through each file to calculate the scaled median deviation. The script rejects a file if:</p>
<p>$$
\left\langle{\frac{F_{x1d}(i) - F_{coadd(i)}}{\sigma_{x1d}(i)}}\right\rangle{} &lt; \frac{C_{thresh}}{\sqrt{N_{pix}}}
$$</p>
<p>In the equation, the median deviation from the co-add is $F_{x1d}(i) - F_{coadd(i)}$, the uncertainty per
wavelength bin of the input spectrum is $\sigma_{x1d}(i)$ and $N_{pix}$ is the number of wavelength bins for a given mode. Essentially, the scaled median deviation is the dispersion that quantifies the data quality (DQ) flag pixel spread for a spectrum that is less sensitive to outliers and size variations. The script will reject all files containing segments with scaled median deviation less than (i.e. more negative than) the threshold (the default is -50). For example, raising the threshold to -25 will abut less files than the default threshold of -50. Likewise, lowering the threshold to -100 will include more files in the dataset to be co-added.</p>
<p>An important thing to note about changing the threshold is that including more files increases the SNR of your co-added spectra but decreases the flux accuracy. The threshold value may be altered if a user’s science case is not dependent on the accuracy of a dataset’s absolute flux. For example, if you have a large dataset of a bright target (i.e. a standard star), then you can lower the threshold to include more files in the abutment since the spread of data quality between each file is minimal. Conversely, if you have a dataset of a dim target, or a dataset with many poor observations, then you will want to raise the threshold to only include the best data out of the dataset.</p>
<p>More information about the flux checking algorithm can be found in <a class="reference external" href="https://www.stsci.edu/files/live/sites/www/files/home/hst/instrumentation/cos/documentation/instrument-science-reports-isrs/_documents/ISR2024-01.pdf">ISR COS 2024-01</a>.</p>
<p><a id = downloadthresh></a></p>
</section>
<section id="downloading-the-data">
<h2>4.1 Downloading the Data<a class="headerlink" href="#downloading-the-data" title="Permalink to this heading">#</a></h2>
<p>We will first download an additional dataset to illustrate how the co-add code changes abutment when the threshold flag is changed. We will download data for the spectroscopic binary, <a class="reference external" href="https://simbad.cds.unistra.fr/simbad/sim-coo?Coord=332.88126259897996+18.092873506782&amp;CooFrame=FK5&amp;CooEpoch=2000&amp;CooEqui=2000&amp;CooDefinedFrames=none&amp;Radius=2&amp;Radius.unit=arcmin&amp;submit=submit+query&amp;CoordList=">BD+17D4708</a> from Program 9631. We will run the script with three different threshold values: <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">-1,</span> <span class="pre">-2,</span> <span class="pre">-50</span></code>.</p>
<p>First we will query and download the data using <code class="docutils literal notranslate"><span class="pre">Observations</span></code> from <code class="docutils literal notranslate"><span class="pre">astroquery.mast</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Querying out data from MAST</span>
<span class="n">bd_query</span> <span class="o">=</span> <span class="n">query</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_criteria</span><span class="p">(</span>
            <span class="n">proposal_id</span><span class="o">=</span><span class="mi">9631</span><span class="p">,</span>
            <span class="n">target_name</span><span class="o">=</span><span class="s2">&quot;BD+17D4708&quot;</span><span class="p">,</span>
            <span class="n">dataproduct_type</span><span class="o">=</span><span class="s2">&quot;SPECTRUM&quot;</span><span class="p">,</span>
            <span class="n">provenance_name</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;CALCOS&quot;</span><span class="p">,</span> <span class="s2">&quot;CALSTIS&quot;</span><span class="p">]</span>
        <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The number of datasets queried is </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bd_query</span><span class="p">))</span><span class="si">}</span><span class="s2"> datasets. </span><span class="se">\</span>
<span class="s2">      The query list is printed below:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bd_query</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The number of datasets queried is 12 datasets.       The query list is printed below:
intentType obs_collection provenance_name ... srcDen  obsid     objID  
---------- -------------- --------------- ... ------ -------- ---------
   science            HST         CALSTIS ...    nan 24947039 361629326
   science            HST         CALSTIS ...    nan 24947037 361629331
   science            HST         CALSTIS ...    nan 24947036 361629335
   science            HST         CALSTIS ...    nan 24947038 361629336
   science            HST         CALSTIS ...    nan 24947034 361629339
   science            HST         CALSTIS ...    nan 24947033 361629342
   science            HST         CALSTIS ...    nan 24947031 361629346
   science            HST         CALSTIS ...    nan 24947028 361629348
   science            HST         CALSTIS ...    nan 24947026 361629365
   science            HST         CALSTIS ...    nan 24947027 361629366
   science            HST         CALSTIS ...    nan 24947032 361629369
   science            HST         CALSTIS ...    nan 24947029 361629375
</pre></div>
</div>
</div>
</div>
<p>Let’s create a new directory and download our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating the data download directories</span>
<span class="n">bd_data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./bd_data/&quot;</span><span class="p">)</span>
<span class="n">bd_products_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./bd_products/&quot;</span><span class="p">)</span>

<span class="c1"># If the directory doesn&#39;t exist, then create it</span>
<span class="n">bd_data_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bd_products_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we get the product list and download our data to our directory <code class="docutils literal notranslate"><span class="pre">./bd_products</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Getting the product list from our query</span>
<span class="n">bd_prod</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span>
            <span class="n">bd_query</span>
        <span class="p">)</span>

<span class="c1"># Downloading the products, but only the necessary X1D and SX1 files</span>
<span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span>
            <span class="n">bd_prod</span><span class="p">,</span>
            <span class="n">download_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">bd_data_dir</span><span class="p">),</span>
            <span class="n">productSubGroupDescription</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;X1D&quot;</span><span class="p">,</span> <span class="s2">&quot;SX1&quot;</span><span class="p">]</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h101010_sx1.fits to bd_data/mastDownload/HST/o8h101010/o8h101010_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h101020_sx1.fits to bd_data/mastDownload/HST/o8h101020/o8h101020_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h101030_sx1.fits to bd_data/mastDownload/HST/o8h101030/o8h101030_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h101040_sx1.fits to bd_data/mastDownload/HST/o8h101040/o8h101040_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h102010_sx1.fits to bd_data/mastDownload/HST/o8h102010/o8h102010_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h102020_sx1.fits to bd_data/mastDownload/HST/o8h102020/o8h102020_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h102030_sx1.fits to bd_data/mastDownload/HST/o8h102030/o8h102030_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h102040_sx1.fits to bd_data/mastDownload/HST/o8h102040/o8h102040_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h103010_sx1.fits to bd_data/mastDownload/HST/o8h103010/o8h103010_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h103020_sx1.fits to bd_data/mastDownload/HST/o8h103020/o8h103020_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h103030_sx1.fits to bd_data/mastDownload/HST/o8h103030/o8h103030_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading URL https://mast.stsci.edu/api/v0.1/Download/file?uri=mast:HST/product/o8h103040_sx1.fits to bd_data/mastDownload/HST/o8h103040/o8h103040_sx1.fits ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [Done]
</pre></div>
</div>
<div class="output text_html"><div><i>Table length=12</i>
<table id="table140007543840976" class="table-striped table-bordered table-condensed">
<thead><tr><th>Local Path</th><th>Status</th><th>Message</th><th>URL</th></tr></thead>
<thead><tr><th>str53</th><th>str8</th><th>object</th><th>object</th></tr></thead>
<tr><td>bd_data/mastDownload/HST/o8h101010/o8h101010_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h101020/o8h101020_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h101030/o8h101030_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h101040/o8h101040_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h102010/o8h102010_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h102020/o8h102020_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h102030/o8h102030_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h102040/o8h102040_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h103010/o8h103010_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h103020/o8h103020_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h103030/o8h103030_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
<tr><td>bd_data/mastDownload/HST/o8h103040/o8h103040_sx1.fits</td><td>COMPLETE</td><td>None</td><td>None</td></tr>
</table></div></div></div>
</div>
<p><a id = threshscriptrun></a></p>
</section>
<section id="running-the-co-add-script-with-different-threshold-values">
<h2>4.2 Running the Co-add Script with Different Threshold Values<a class="headerlink" href="#running-the-co-add-script-with-different-threshold-values" title="Permalink to this heading">#</a></h2>
<p>Let’s first organize our data so that all data files are in a single directory instead of separate observation set directories.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">consolidate_files</span><span class="p">(</span><span class="n">bd_data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we’ve downloaded our data and organized it to be properly run by the script, we can run the code using different threshold values. Below is a function that runs the script using inputted threshold values, which will allow us to run the code in a single cell rather than multiple.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_script</span><span class="p">(</span><span class="n">indir</span><span class="p">,</span> <span class="n">outdir</span><span class="p">,</span> <span class="n">thresh</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Run the hasp wrapper script with different thresholds.</span>
<span class="sd">    -------------------</span>
<span class="sd">    Input:</span>
<span class="sd">    str indir : Directory that holds all un-abutted data.</span>
<span class="sd">    str outdir : Directory that will store output folders and files.</span>
<span class="sd">    list thresh : List of threshold values used for script.</span>
<span class="sd">    --------------------</span>
<span class="sd">    Output:</span>
<span class="sd">    Wrapper script is run using different threshold values.</span>
<span class="sd">    A folder will be created for each value used, containing abutted products.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Looping through thresh vals to run through script</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">thresh</span><span class="p">:</span>
        <span class="c1"># Creating a folder for each thresh val</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span> <span class="s2">&quot;out&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running script where threshold = </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Specifying the arguments for the scipt</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">indir</span><span class="p">,</span> <span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="s2">&quot;-t&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">]</span>

        <span class="c1"># Creating a list composed of the script commands and arguments</span>
        <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;python&quot;</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;hasp.wrapper&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">arguments</span>

        <span class="c1"># Running the script with the arguments above</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s create a variable called <code class="docutils literal notranslate"><span class="pre">thresholds</span></code> that will consist of the different threshold values that we will use to help us visualize the relationship between number of files co-added and the final co-added product. We will run the script using each of these values.</p>
<p><em>Note: feel free to run the cells with more threshold values!</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remember that the default value is t = -50</span>
<span class="n">thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-1&quot;</span><span class="p">,</span> <span class="s2">&quot;-2&quot;</span><span class="p">,</span> <span class="s2">&quot;-50&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s run the script on our data now using the <code class="docutils literal notranslate"><span class="pre">run_script</span></code> function, using the thresholds defined above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">run_script</span><span class="p">(</span><span class="n">bd_data_dir</span><span class="p">,</span> <span class="n">bd_products_dir</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running script where threshold = -1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HASP version 0.9.6
Ullyses version 4.1.0
Creating list of unique modes from these files:
bd_data/o8h101010_sx1.fits BD+17D4708 STIS CCD G430L 52X2E1 9631 (9631, &#39;01&#39;)
bd_data/o8h101020_sx1.fits BD+17D4708 STIS CCD G430L 52X2 9631 (9631, &#39;01&#39;)
bd_data/o8h101030_sx1.fits BD+17D4708 STIS CCD G230LB 52X2 9631 (9631, &#39;01&#39;)
bd_data/o8h101040_sx1.fits BD+17D4708 STIS CCD G750L 52X2 9631 (9631, &#39;01&#39;)
bd_data/o8h102010_sx1.fits BD+17D4708 STIS CCD G430L 52X2E1 9631 (9631, &#39;02&#39;)
bd_data/o8h102020_sx1.fits BD+17D4708 STIS CCD G430L 52X2 9631 (9631, &#39;02&#39;)
bd_data/o8h102030_sx1.fits BD+17D4708 STIS CCD G230LB 52X2 9631 (9631, &#39;02&#39;)
bd_data/o8h102040_sx1.fits BD+17D4708 STIS CCD G750L 52X2 9631 (9631, &#39;02&#39;)
bd_data/o8h103010_sx1.fits BD+17D4708 STIS CCD G430L 52X2E1 9631 (9631, &#39;03&#39;)
bd_data/o8h103020_sx1.fits BD+17D4708 STIS CCD G430L 52X2 9631 (9631, &#39;03&#39;)
bd_data/o8h103030_sx1.fits BD+17D4708 STIS CCD G230LB 52X2 9631 (9631, &#39;03&#39;)
bd_data/o8h103040_sx1.fits BD+17D4708 STIS CCD G750L 52X2 9631 (9631, &#39;03&#39;)
Looping over visits
Processing product (9631, &#39;01&#39;)
Targets in visit (9631, &#39;01&#39;): [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in visit (9631, &#39;01&#39;)
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h101010_sx1.fits&#39;, &#39;bd_data/o8h101020_sx1.fits&#39;]
Processing file bd_data/o8h101010_sx1.fits
Processing file bd_data/o8h101020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h101010_sx1.fits has scaled median = -2.9336734976820438
Removing file bd_data/o8h101010_sx1.fits from product
Removing files from list:
[&#39;bd_data/o8h101010_sx1.fits&#39;]
Importing files [&#39;bd_data/o8h101020_sx1.fits&#39;]
Processing file bd_data/o8h101020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g430l_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g430l_o8h101_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h101030_sx1.fits&#39;]
Processing file bd_data/o8h101030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb_o8h101_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h101040_sx1.fits&#39;]
Processing file bd_data/o8h101040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g750l_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g750l_o8h101_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1667.8-3069.7)
STIS/G430L 2895.9-5704.4 (Actual: 2976.8-5701.3)
STIS/G750L 5261.3-10252.3 (Actual: 5305.8-10244.1)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.734992255102
Abutting STIS/G750L product to current result
With a transition wavelength of 5701.265694234849
Truncating current grating at 10244.073931818537
bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h101_cspec.fits
Processing product (9631, &#39;02&#39;)
Targets in visit (9631, &#39;02&#39;): [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in visit (9631, &#39;02&#39;)
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h102010_sx1.fits&#39;, &#39;bd_data/o8h102020_sx1.fits&#39;]
Processing file bd_data/o8h102010_sx1.fits
Processing file bd_data/o8h102020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h102010_sx1.fits has scaled median = -3.071526539591649
Removing file bd_data/o8h102010_sx1.fits from product
Removing files from list:
[&#39;bd_data/o8h102010_sx1.fits&#39;]
Importing files [&#39;bd_data/o8h102020_sx1.fits&#39;]
Processing file bd_data/o8h102020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g430l_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g430l_o8h102_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h102030_sx1.fits&#39;]
Processing file bd_data/o8h102030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb_o8h102_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h102040_sx1.fits&#39;]
Processing file bd_data/o8h102040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g750l_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g750l_o8h102_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1668.1-3070.0)
STIS/G430L 2895.9-5704.4 (Actual: 2977.4-5701.7)
STIS/G750L 5261.3-10252.3 (Actual: 5306.5-10244.6)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.968660763374
Abutting STIS/G750L product to current result
With a transition wavelength of 5701.719693687126
Truncating current grating at 10244.598050895449
bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h102_cspec.fits
Processing product (9631, &#39;03&#39;)
Targets in visit (9631, &#39;03&#39;): [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in visit (9631, &#39;03&#39;)
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h103010_sx1.fits&#39;, &#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h103010_sx1.fits
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h103010_sx1.fits has scaled median = -1.4156082473370053
Removing file bd_data/o8h103010_sx1.fits from product
Removing files from list:
[&#39;bd_data/o8h103010_sx1.fits&#39;]
Importing files [&#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g430l_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g430l_o8h103_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h103030_sx1.fits&#39;]
Processing file bd_data/o8h103030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb_o8h103_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h103040_sx1.fits&#39;]
Processing file bd_data/o8h103040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g750l_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g750l_o8h103_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1668.0-3069.9)
STIS/G430L 2895.9-5704.4 (Actual: 2977.0-5701.4)
STIS/G750L 5261.3-10252.3 (Actual: 5305.9-10243.9)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.8870475823132
Abutting STIS/G750L product to current result
With a transition wavelength of 5701.370321533011
Truncating current grating at 10243.943530724338
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h103_cspec.fits
Looping over proposals
Processing product 9631
Targets in proposal 9631: [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in proposal 9631
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h101010_sx1.fits&#39;, &#39;bd_data/o8h101020_sx1.fits&#39;, &#39;bd_data/o8h102010_sx1.fits&#39;, &#39;bd_data/o8h102020_sx1.fits&#39;, &#39;bd_data/o8h103010_sx1.fits&#39;, &#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h101010_sx1.fits
Processing file bd_data/o8h101020_sx1.fits
Processing file bd_data/o8h102010_sx1.fits
Processing file bd_data/o8h102020_sx1.fits
Processing file bd_data/o8h103010_sx1.fits
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h101010_sx1.fits has scaled median = -4.852887374265663
Removing file bd_data/o8h101010_sx1.fits from product
Segment #0 from file bd_data/o8h102010_sx1.fits has scaled median = -3.759874284435761
Removing file bd_data/o8h102010_sx1.fits from product
Importing files [&#39;bd_data/o8h101020_sx1.fits&#39;, &#39;bd_data/o8h102020_sx1.fits&#39;, &#39;bd_data/o8h103010_sx1.fits&#39;, &#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h101020_sx1.fits
Processing file bd_data/o8h102020_sx1.fits
Processing file bd_data/o8h103010_sx1.fits
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h101020_sx1.fits has scaled median = -1.0774592868482187
Removing file bd_data/o8h101020_sx1.fits from product
Importing files [&#39;bd_data/o8h102020_sx1.fits&#39;, &#39;bd_data/o8h103010_sx1.fits&#39;, &#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h102020_sx1.fits
Processing file bd_data/o8h103010_sx1.fits
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h103010_sx1.fits has scaled median = -1.1716874258981
Removing file bd_data/o8h103010_sx1.fits from product
Importing files [&#39;bd_data/o8h102020_sx1.fits&#39;, &#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h102020_sx1.fits
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g430l_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g430l_o8h1_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h101030_sx1.fits&#39;, &#39;bd_data/o8h102030_sx1.fits&#39;, &#39;bd_data/o8h103030_sx1.fits&#39;]
Processing file bd_data/o8h101030_sx1.fits
Processing file bd_data/o8h102030_sx1.fits
Processing file bd_data/o8h103030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h103030_sx1.fits has scaled median = -3.320959711748654
Removing file bd_data/o8h103030_sx1.fits from product
Importing files [&#39;bd_data/o8h101030_sx1.fits&#39;, &#39;bd_data/o8h102030_sx1.fits&#39;]
Processing file bd_data/o8h101030_sx1.fits
Processing file bd_data/o8h102030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb_o8h1_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h101040_sx1.fits&#39;, &#39;bd_data/o8h102040_sx1.fits&#39;, &#39;bd_data/o8h103040_sx1.fits&#39;]
Processing file bd_data/o8h101040_sx1.fits
Processing file bd_data/o8h102040_sx1.fits
Processing file bd_data/o8h103040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h101040_sx1.fits has scaled median = -1.9044224950003772
Removing file bd_data/o8h101040_sx1.fits from product
Importing files [&#39;bd_data/o8h102040_sx1.fits&#39;, &#39;bd_data/o8h103040_sx1.fits&#39;]
Processing file bd_data/o8h102040_sx1.fits
Processing file bd_data/o8h103040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-1/hst_9631_stis_bdp17d4708_g750l_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g750l_o8h1_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1667.4-3069.4)
STIS/G430L 2895.9-5704.4 (Actual: 2976.5-5701.2)
STIS/G750L 5261.3-10252.3 (Actual: 5305.8-10244.0)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.357664783157
Abutting STIS/G750L product to current result
With a transition wavelength of 5701.160686001296
Truncating current grating at 10243.995300787725
bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-1/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h1_cspec.fits
Running script where threshold = -2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HASP version 0.9.6
Ullyses version 4.1.0
Creating list of unique modes from these files:
bd_data/o8h101010_sx1.fits BD+17D4708 STIS CCD G430L 52X2E1 9631 (9631, &#39;01&#39;)
bd_data/o8h101020_sx1.fits BD+17D4708 STIS CCD G430L 52X2 9631 (9631, &#39;01&#39;)
bd_data/o8h101030_sx1.fits BD+17D4708 STIS CCD G230LB 52X2 9631 (9631, &#39;01&#39;)
bd_data/o8h101040_sx1.fits BD+17D4708 STIS CCD G750L 52X2 9631 (9631, &#39;01&#39;)
bd_data/o8h102010_sx1.fits BD+17D4708 STIS CCD G430L 52X2E1 9631 (9631, &#39;02&#39;)
bd_data/o8h102020_sx1.fits BD+17D4708 STIS CCD G430L 52X2 9631 (9631, &#39;02&#39;)
bd_data/o8h102030_sx1.fits BD+17D4708 STIS CCD G230LB 52X2 9631 (9631, &#39;02&#39;)
bd_data/o8h102040_sx1.fits BD+17D4708 STIS CCD G750L 52X2 9631 (9631, &#39;02&#39;)
bd_data/o8h103010_sx1.fits BD+17D4708 STIS CCD G430L 52X2E1 9631 (9631, &#39;03&#39;)
bd_data/o8h103020_sx1.fits BD+17D4708 STIS CCD G430L 52X2 9631 (9631, &#39;03&#39;)
bd_data/o8h103030_sx1.fits BD+17D4708 STIS CCD G230LB 52X2 9631 (9631, &#39;03&#39;)
bd_data/o8h103040_sx1.fits BD+17D4708 STIS CCD G750L 52X2 9631 (9631, &#39;03&#39;)
Looping over visits
Processing product (9631, &#39;01&#39;)
Targets in visit (9631, &#39;01&#39;): [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in visit (9631, &#39;01&#39;)
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h101010_sx1.fits&#39;, &#39;bd_data/o8h101020_sx1.fits&#39;]
Processing file bd_data/o8h101010_sx1.fits
Processing file bd_data/o8h101020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h101010_sx1.fits has scaled median = -2.9336734976820438
Removing file bd_data/o8h101010_sx1.fits from product
Removing files from list:
[&#39;bd_data/o8h101010_sx1.fits&#39;]
Importing files [&#39;bd_data/o8h101020_sx1.fits&#39;]
Processing file bd_data/o8h101020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g430l_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g430l_o8h101_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h101030_sx1.fits&#39;]
Processing file bd_data/o8h101030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb_o8h101_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h101040_sx1.fits&#39;]
Processing file bd_data/o8h101040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g750l_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g750l_o8h101_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1667.8-3069.7)
STIS/G430L 2895.9-5704.4 (Actual: 2976.8-5701.3)
STIS/G750L 5261.3-10252.3 (Actual: 5305.8-10244.1)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.734992255102
Abutting STIS/G750L product to current result
With a transition wavelength of 5701.265694234849
Truncating current grating at 10244.073931818537
bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h101_cspec.fits
Processing product (9631, &#39;02&#39;)
Targets in visit (9631, &#39;02&#39;): [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in visit (9631, &#39;02&#39;)
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h102010_sx1.fits&#39;, &#39;bd_data/o8h102020_sx1.fits&#39;]
Processing file bd_data/o8h102010_sx1.fits
Processing file bd_data/o8h102020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h102010_sx1.fits has scaled median = -3.071526539591649
Removing file bd_data/o8h102010_sx1.fits from product
Removing files from list:
[&#39;bd_data/o8h102010_sx1.fits&#39;]
Importing files [&#39;bd_data/o8h102020_sx1.fits&#39;]
Processing file bd_data/o8h102020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g430l_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g430l_o8h102_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h102030_sx1.fits&#39;]
Processing file bd_data/o8h102030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb_o8h102_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h102040_sx1.fits&#39;]
Processing file bd_data/o8h102040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g750l_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g750l_o8h102_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1668.1-3070.0)
STIS/G430L 2895.9-5704.4 (Actual: 2977.4-5701.7)
STIS/G750L 5261.3-10252.3 (Actual: 5306.5-10244.6)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.968660763374
Abutting STIS/G750L product to current result
With a transition wavelength of 5701.719693687126
Truncating current grating at 10244.598050895449
bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h102_cspec.fits
Processing product (9631, &#39;03&#39;)
Targets in visit (9631, &#39;03&#39;): [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in visit (9631, &#39;03&#39;)
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h103010_sx1.fits&#39;, &#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h103010_sx1.fits
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g430l_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g430l_o8h103_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h103030_sx1.fits&#39;]
Processing file bd_data/o8h103030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb_o8h103_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h103040_sx1.fits&#39;]
Processing file bd_data/o8h103040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g750l_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g750l_o8h103_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1668.0-3069.9)
STIS/G430L 2895.9-5704.4 (Actual: 2970.5-5700.6)
STIS/G750L 5261.3-10252.3 (Actual: 5305.9-10243.9)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.8870475823132
Abutting STIS/G750L product to current result
With a transition wavelength of 5700.648567462054
Truncating current grating at 10243.943530724338
bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h103_cspec.fits
Looping over proposals
Processing product 9631
Targets in proposal 9631: [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in proposal 9631
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h101010_sx1.fits&#39;, &#39;bd_data/o8h101020_sx1.fits&#39;, &#39;bd_data/o8h102010_sx1.fits&#39;, &#39;bd_data/o8h102020_sx1.fits&#39;, &#39;bd_data/o8h103010_sx1.fits&#39;, &#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h101010_sx1.fits
Processing file bd_data/o8h101020_sx1.fits
Processing file bd_data/o8h102010_sx1.fits
Processing file bd_data/o8h102020_sx1.fits
Processing file bd_data/o8h103010_sx1.fits
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h101010_sx1.fits has scaled median = -4.852887374265663
Removing file bd_data/o8h101010_sx1.fits from product
Segment #0 from file bd_data/o8h102010_sx1.fits has scaled median = -3.759874284435761
Removing file bd_data/o8h102010_sx1.fits from product
Importing files [&#39;bd_data/o8h101020_sx1.fits&#39;, &#39;bd_data/o8h102020_sx1.fits&#39;, &#39;bd_data/o8h103010_sx1.fits&#39;, &#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h101020_sx1.fits
Processing file bd_data/o8h102020_sx1.fits
Processing file bd_data/o8h103010_sx1.fits
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g430l_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g430l_o8h1_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h101030_sx1.fits&#39;, &#39;bd_data/o8h102030_sx1.fits&#39;, &#39;bd_data/o8h103030_sx1.fits&#39;]
Processing file bd_data/o8h101030_sx1.fits
Processing file bd_data/o8h102030_sx1.fits
Processing file bd_data/o8h103030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
Segment #0 from file bd_data/o8h103030_sx1.fits has scaled median = -3.320959711748654
Removing file bd_data/o8h103030_sx1.fits from product
Importing files [&#39;bd_data/o8h101030_sx1.fits&#39;, &#39;bd_data/o8h102030_sx1.fits&#39;]
Processing file bd_data/o8h101030_sx1.fits
Processing file bd_data/o8h102030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb_o8h1_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h101040_sx1.fits&#39;, &#39;bd_data/o8h102040_sx1.fits&#39;, &#39;bd_data/o8h103040_sx1.fits&#39;]
Processing file bd_data/o8h101040_sx1.fits
Processing file bd_data/o8h102040_sx1.fits
Processing file bd_data/o8h103040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-2/hst_9631_stis_bdp17d4708_g750l_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g750l_o8h1_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1667.4-3069.4)
STIS/G430L 2895.9-5704.4 (Actual: 2970.5-5700.8)
STIS/G750L 5261.3-10252.3 (Actual: 5305.8-10244.2)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.357664783157
Abutting STIS/G750L product to current result
With a transition wavelength of 5700.765716054397
Truncating current grating at 10244.181165082162
bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-2/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h1_cspec.fits
Running script where threshold = -50
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HASP version 0.9.6
Ullyses version 4.1.0
Creating list of unique modes from these files:
bd_data/o8h101010_sx1.fits BD+17D4708 STIS CCD G430L 52X2E1 9631 (9631, &#39;01&#39;)
bd_data/o8h101020_sx1.fits BD+17D4708 STIS CCD G430L 52X2 9631 (9631, &#39;01&#39;)
bd_data/o8h101030_sx1.fits BD+17D4708 STIS CCD G230LB 52X2 9631 (9631, &#39;01&#39;)
bd_data/o8h101040_sx1.fits BD+17D4708 STIS CCD G750L 52X2 9631 (9631, &#39;01&#39;)
bd_data/o8h102010_sx1.fits BD+17D4708 STIS CCD G430L 52X2E1 9631 (9631, &#39;02&#39;)
bd_data/o8h102020_sx1.fits BD+17D4708 STIS CCD G430L 52X2 9631 (9631, &#39;02&#39;)
bd_data/o8h102030_sx1.fits BD+17D4708 STIS CCD G230LB 52X2 9631 (9631, &#39;02&#39;)
bd_data/o8h102040_sx1.fits BD+17D4708 STIS CCD G750L 52X2 9631 (9631, &#39;02&#39;)
bd_data/o8h103010_sx1.fits BD+17D4708 STIS CCD G430L 52X2E1 9631 (9631, &#39;03&#39;)
bd_data/o8h103020_sx1.fits BD+17D4708 STIS CCD G430L 52X2 9631 (9631, &#39;03&#39;)
bd_data/o8h103030_sx1.fits BD+17D4708 STIS CCD G230LB 52X2 9631 (9631, &#39;03&#39;)
bd_data/o8h103040_sx1.fits BD+17D4708 STIS CCD G750L 52X2 9631 (9631, &#39;03&#39;)
Looping over visits
Processing product (9631, &#39;01&#39;)
Targets in visit (9631, &#39;01&#39;): [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in visit (9631, &#39;01&#39;)
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h101010_sx1.fits&#39;, &#39;bd_data/o8h101020_sx1.fits&#39;]
Processing file bd_data/o8h101010_sx1.fits
Processing file bd_data/o8h101020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g430l_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g430l_o8h101_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h101030_sx1.fits&#39;]
Processing file bd_data/o8h101030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb_o8h101_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h101040_sx1.fits&#39;]
Processing file bd_data/o8h101040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g750l_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g750l_o8h101_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1667.8-3069.7)
STIS/G430L 2895.9-5704.4 (Actual: 2970.5-5700.8)
STIS/G750L 5261.3-10252.3 (Actual: 5305.8-10244.1)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.734992255102
Abutting STIS/G750L product to current result
With a transition wavelength of 5700.765716054397
Truncating current grating at 10244.073931818537
bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h101_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h101_cspec.fits
Processing product (9631, &#39;02&#39;)
Targets in visit (9631, &#39;02&#39;): [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in visit (9631, &#39;02&#39;)
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h102010_sx1.fits&#39;, &#39;bd_data/o8h102020_sx1.fits&#39;]
Processing file bd_data/o8h102010_sx1.fits
Processing file bd_data/o8h102020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g430l_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g430l_o8h102_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h102030_sx1.fits&#39;]
Processing file bd_data/o8h102030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb_o8h102_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h102040_sx1.fits&#39;]
Processing file bd_data/o8h102040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g750l_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g750l_o8h102_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1668.1-3070.0)
STIS/G430L 2895.9-5704.4 (Actual: 2971.5-5701.7)
STIS/G750L 5261.3-10252.3 (Actual: 5306.5-10244.6)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.968660763374
Abutting STIS/G750L product to current result
With a transition wavelength of 5701.659531615402
Truncating current grating at 10244.598050895449
bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h102_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h102_cspec.fits
Processing product (9631, &#39;03&#39;)
Targets in visit (9631, &#39;03&#39;): [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in visit (9631, &#39;03&#39;)
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h103010_sx1.fits&#39;, &#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h103010_sx1.fits
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g430l_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g430l_o8h103_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h103030_sx1.fits&#39;]
Processing file bd_data/o8h103030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb_o8h103_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h103040_sx1.fits&#39;]
Processing file bd_data/o8h103040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g750l_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g750l_o8h103_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1668.0-3069.9)
STIS/G430L 2895.9-5704.4 (Actual: 2970.5-5700.6)
STIS/G750L 5261.3-10252.3 (Actual: 5305.9-10243.9)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.8870475823132
Abutting STIS/G750L product to current result
With a transition wavelength of 5700.648567462054
Truncating current grating at 10243.943530724338
bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h103_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h103_cspec.fits
Looping over proposals
Processing product 9631
Targets in proposal 9631: [&#39;BD+17D4708&#39;]
Processing target BD+17D4708 in proposal 9631
Processing grating STIS/G430L
Importing files [&#39;bd_data/o8h101010_sx1.fits&#39;, &#39;bd_data/o8h101020_sx1.fits&#39;, &#39;bd_data/o8h102010_sx1.fits&#39;, &#39;bd_data/o8h102020_sx1.fits&#39;, &#39;bd_data/o8h103010_sx1.fits&#39;, &#39;bd_data/o8h103020_sx1.fits&#39;]
Processing file bd_data/o8h101010_sx1.fits
Processing file bd_data/o8h101020_sx1.fits
Processing file bd_data/o8h102010_sx1.fits
Processing file bd_data/o8h102020_sx1.fits
Processing file bd_data/o8h103010_sx1.fits
Processing file bd_data/o8h103020_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g430l_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g430l_o8h1_cspec.fits
Processing grating STIS/G230LB
Importing files [&#39;bd_data/o8h101030_sx1.fits&#39;, &#39;bd_data/o8h102030_sx1.fits&#39;, &#39;bd_data/o8h103030_sx1.fits&#39;]
Processing file bd_data/o8h101030_sx1.fits
Processing file bd_data/o8h102030_sx1.fits
Processing file bd_data/o8h103030_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb_o8h1_cspec.fits
Processing grating STIS/G750L
Importing files [&#39;bd_data/o8h101040_sx1.fits&#39;, &#39;bd_data/o8h102040_sx1.fits&#39;, &#39;bd_data/o8h103040_sx1.fits&#39;]
Processing file bd_data/o8h101040_sx1.fits
Processing file bd_data/o8h102040_sx1.fits
Processing file bd_data/o8h103040_sx1.fits
Using a maximum SNR of 20.0 in flux-based filtering
bd_products/out-50/hst_9631_stis_bdp17d4708_g750l_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g750l_o8h1_cspec.fits
Making a product from these gratings
STIS/G230LB 1667.1-3071.6 (Actual: 1667.4-3069.4)
STIS/G430L 2895.9-5704.4 (Actual: 2970.5-5700.8)
STIS/G750L 5261.3-10252.3 (Actual: 5305.8-10244.2)
Transition wavelengths tweaked
Transition wavelengths tweaked
Transition wavelengths tweaked
Starting at the short wavelength end with grating STIS/G230LB
Abutting STIS/G430L product to current result
With a transition wavelength of 3069.357664783157
Abutting STIS/G750L product to current result
With a transition wavelength of 5700.765716054397
Truncating current grating at 10244.181165082162
bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h1_cspec.fits already exists and overwrite=False, skipping write
   Wrote bd_products/out-50/hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h1_cspec.fits
</pre></div>
</div>
</div>
</div>
<p><a id = analyzethresh></a></p>
</section>
<section id="analyzing-the-different-co-added-spectra-of-different-threshold-values">
<h2>4.3 Analyzing the Different Co-added Spectra of Different Threshold Values<a class="headerlink" href="#analyzing-the-different-co-added-spectra-of-different-threshold-values" title="Permalink to this heading">#</a></h2>
<p>Now that we’ve run the script on our dataset using differnet threshold values, we can start to analyze the differences between them.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">run_script</span></code> function created multiple folders for the abutted products; one folder for each threshold value (ex. <code class="docutils literal notranslate"><span class="pre">./out-50</span></code>). In each folder is the fully co-added spectra. At the time of this notebook, the fully co-added filename is:</p>
<p><code class="docutils literal notranslate"><span class="pre">hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h1_cspec.fits</span></code></p>
<p>Before you continue, make sure that the fully co-added filename is valid, as the filenaming structure may have changed since this notebook was published. Update and run the cell below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bd_coadd_name</span> <span class="o">=</span> <span class="s2">&quot;hst_9631_stis_bdp17d4708_g230lb-g430l-g750l_o8h1_cspec.fits&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>We can see how many files were used in the co-add by running next the cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Iterating through the threshold values</span>
<span class="k">for</span> <span class="n">thresh</span> <span class="ow">in</span> <span class="n">thresholds</span><span class="p">:</span>
    <span class="c1"># Path to the co-added file</span>
    <span class="n">path_to_coadd</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bd_products_dir</span><span class="si">}</span><span class="s2">/out</span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">bd_coadd_name</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Opening the file to check num files, and printing</span>
    <span class="n">numfiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path_to_coadd</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">])</span>

    <span class="c1"># Printing the number of files for the given threshold value</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The number of files co-added for t = </span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">numfiles</span><span class="si">}</span><span class="s2"> files&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The number of files co-added for t = -1 is 6 files
The number of files co-added for t = -2 is 9 files
The number of files co-added for t = -50 is 12 files
</pre></div>
</div>
</div>
</div>
<p>As we can see, as we increase the threshold value (<code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">-50</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">-1</span></code>) we went from 12 files being used to only 6. Since we are using more data with the lower threshold (<code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">-50</span></code>), we should see an increase in SNR.</p>
<section id="looking-at-snr">
<h3>Looking at SNR:<a class="headerlink" href="#looking-at-snr" title="Permalink to this heading">#</a></h3>
<p>We’ll plot the SNR of both coadds below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A list of the the non-default thresholds used.</span>
<span class="n">nondefault_thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="n">thresh</span> <span class="k">for</span> <span class="n">thresh</span> <span class="ow">in</span> <span class="n">thresholds</span> <span class="k">if</span> <span class="n">thresh</span> <span class="o">!=</span> <span class="s2">&quot;-50&quot;</span><span class="p">]</span>

<span class="c1"># List of colors to be used when plotting</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
          <span class="s1">&#39;red&#39;</span><span class="p">]</span>

<span class="c1"># Creating our figure: 1 column and len(thresholds) rows</span>
<span class="n">figure</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nondefault_thresholds</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span>
                          <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="c1"># Iterating through threshold values to compare their SNR to default output</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">thresh</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nondefault_thresholds</span><span class="p">):</span>

    <span class="c1"># The SNR and wavelength data for the default threshold co-add output</span>
    <span class="n">default_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bd_products_dir</span><span class="si">}</span><span class="s2">/out-50/</span><span class="si">{</span><span class="n">bd_coadd_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">data50</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">default_path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wavelength50</span> <span class="o">=</span> <span class="n">data50</span><span class="p">[</span><span class="s2">&quot;WAVELENGTH&quot;</span><span class="p">]</span>
    <span class="n">snr50</span> <span class="o">=</span> <span class="n">data50</span><span class="p">[</span><span class="s2">&quot;SNR&quot;</span><span class="p">]</span>

    <span class="c1"># Getting wavelength and SNR for the current iteration&#39;s threshold value</span>
    <span class="n">curr_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bd_products_dir</span><span class="si">}</span><span class="s2">/out</span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">bd_coadd_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">curr_path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
    <span class="n">wavelength</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;WAVELENGTH&quot;</span><span class="p">]</span>
    <span class="n">snr</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;SNR&quot;</span><span class="p">]</span>

    <span class="c1"># This is the number of files used in the particular co-add</span>
    <span class="n">numfiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">curr_path</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">])</span>
    <span class="n">numfiles_default</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">default_path</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">])</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wavelength50</span><span class="p">,</span> <span class="n">snr50</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;t = -50, </span><span class="si">{</span><span class="n">numfiles_default</span><span class="si">}</span><span class="s2"> files co-added&quot;</span><span class="p">,</span>
                  <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">snr</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;t = </span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">numfiles</span><span class="si">}</span><span class="s2"> files co-added&quot;</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                  <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Highlighting the region of the plot with the biggest SNR change</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="mi">3050</span><span class="p">,</span> <span class="mi">5700</span><span class="p">,</span>
                  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                  <span class="n">color</span><span class="o">=</span><span class="s2">&quot;grey&quot;</span><span class="p">)</span>

    <span class="c1"># Adding formatting</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SNR vs Wavelength for t = </span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">, -50&quot;</span><span class="p">,</span>
                    <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;SNR&quot;</span><span class="p">)</span>

<span class="n">figure</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># Saving the figure to ./bd_products</span>
<span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bd_products_dir</span><span class="si">}</span><span class="s2">/snr_wavelength.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ccba0998afded4c1db09ae3e464894f8948faf11452f0b5896ed2e75d90c0afa.png" src="../../../_images/ccba0998afded4c1db09ae3e464894f8948faf11452f0b5896ed2e75d90c0afa.png" />
</div>
</div>
<p>We can clearly see above that using more files in the co-add substantially increases SNR. This is especially prevalent in the grey highlighted section of the top plot, where we set <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">-1</span></code>. The number of files used with that threshold value were 6 files, whereas the default threshold value of <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">-50</span></code> used 12 files.</p>
</section>
<section id="looking-at-flux">
<h3>Looking at Flux:<a class="headerlink" href="#looking-at-flux" title="Permalink to this heading">#</a></h3>
<p>We’re going to create two diffrent plots to analyze our flux data: a standard flux vs wavelength plot, and a differential plot. We will also calculate the percent change in flux between the threshold values vs the default.</p>
<p>A differential plot shows the absolute differences between two datasets; in our case, we will be seeing the flux difference at each wavelength between one threshold value’s co-add and the default co-add. However, we will first need to interpolate the spectra to a common wavelength grid. Essentially, we will be adjusting the wavelength values so the two datasets can share the same wavelength points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Thresholds used that aren&#39;t the default</span>
<span class="n">nondefault_thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="n">thresh</span> <span class="k">for</span> <span class="n">thresh</span> <span class="ow">in</span> <span class="n">thresholds</span> <span class="k">if</span> <span class="n">thresh</span> <span class="o">!=</span> <span class="s2">&quot;-50&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">thresh</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nondefault_thresholds</span><span class="p">):</span>
    <span class="c1"># Getting the data for the co-add that uses default threshold of t = -50</span>
    <span class="n">default_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bd_products_dir</span><span class="si">}</span><span class="s2">/out-50/</span><span class="si">{</span><span class="n">bd_coadd_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">thresh_data50</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">default_path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

    <span class="n">wavelength50</span> <span class="o">=</span> <span class="n">thresh_data50</span><span class="p">[</span><span class="s2">&quot;WAVELENGTH&quot;</span><span class="p">]</span>
    <span class="n">flux50</span> <span class="o">=</span> <span class="n">thresh_data50</span><span class="p">[</span><span class="s2">&quot;FLUX&quot;</span><span class="p">]</span>

    <span class="c1"># Getting data for the co-add that uses the current iteration&#39;s threshold</span>
    <span class="n">curr_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bd_products_dir</span><span class="si">}</span><span class="s2">/out</span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">bd_coadd_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">thresh_data_curr</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">curr_path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

    <span class="n">wavelength_curr</span> <span class="o">=</span> <span class="n">thresh_data_curr</span><span class="p">[</span><span class="s2">&quot;WAVELENGTH&quot;</span><span class="p">]</span>
    <span class="n">flux_curr</span> <span class="o">=</span> <span class="n">thresh_data_curr</span><span class="p">[</span><span class="s2">&quot;FLUX&quot;</span><span class="p">]</span>

    <span class="c1"># Getting the number of files used in co-add, will put this in the plot</span>
    <span class="n">numfiles</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">curr_path</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">])</span>
    <span class="n">numfiles_default</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">default_path</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;FILENAME&quot;</span><span class="p">])</span>

    <span class="c1"># Minimum wavelength value in dataset</span>
    <span class="n">minwave</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">wavelength50</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">wavelength_curr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>

    <span class="c1"># Maximum wavelength value in dataset</span>
    <span class="n">maxwave</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">wavelength50</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">wavelength_curr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="c1"># Creating a common wavelength grid using shape of default wavelength axis</span>
    <span class="n">common_wavelength</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">minwave</span><span class="p">,</span>
                                  <span class="n">stop</span><span class="o">=</span><span class="n">maxwave</span><span class="p">,</span>
                                  <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Interpolating the default + current threshold co-add onto new grid</span>
    <span class="n">interp_flux50</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">wavelength50</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                             <span class="n">flux50</span><span class="p">,</span>
                             <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                             <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">common_wavelength</span><span class="p">)</span>
    
    <span class="n">interp_flux_curr</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">wavelength_curr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                <span class="n">flux_curr</span><span class="p">,</span>
                                <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                                <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">common_wavelength</span><span class="p">)</span>

    <span class="c1"># Creating two subplots, one flux vs wavelength and one differential plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
                                   <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

    <span class="c1"># Plotting the top plot, a.k.a. the flux vs wavelength for t = -50</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">common_wavelength</span><span class="p">,</span> <span class="n">interp_flux50</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;t = -50, </span><span class="si">{</span><span class="n">numfiles_default</span><span class="si">}</span><span class="s2"> files&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Plotting flux vs wavelength on same plot for current co-add</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">common_wavelength</span><span class="p">,</span> <span class="n">interp_flux_curr</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;t = </span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">numfiles</span><span class="si">}</span><span class="s2"> files&quot;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Calculating difference between current co-add and default flux values</span>
    <span class="n">flux_diff</span> <span class="o">=</span> <span class="n">interp_flux_curr</span> <span class="o">-</span> <span class="n">interp_flux50</span>

    <span class="c1"># Plotting the differential plot</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">common_wavelength</span><span class="p">,</span> <span class="n">flux_diff</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Calculating the percent difference and putting it on the plot</span>
    <span class="n">percent_difference</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">interp_flux50</span> <span class="o">-</span> <span class="n">interp_flux_curr</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">interp_flux50</span> <span class="o">+</span> <span class="n">interp_flux_curr</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># Calculating the mean percent difference (ignoring NaNs)</span>
    <span class="n">percent_difference</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">percent_difference</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Adding text box onto plot that displays newly calculated 5 difference</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span>
             <span class="sa">f</span><span class="s2">&quot;Average percent difference: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">percent_difference</span><span class="p">)</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
             <span class="n">transform</span><span class="o">=</span><span class="n">ax0</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
             <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">))</span>
    
    <span class="c1"># Setting the y axis limits on both plots to be the same</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">)</span>

    <span class="c1"># Adding formatting</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Flux vs Wavelength for t = </span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">, -50&quot;</span><span class="p">,</span>
                  <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux [$erg\ s^{-1}\ cm^{-2}\ \AA^{-1}$]&#39;</span><span class="p">)</span>

    <span class="c1"># Putting the legend on the flux plot</span>
    <span class="n">ax0</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absolute Difference for t = </span><span class="si">{</span><span class="n">thresh</span><span class="si">}</span><span class="s2">, -50&quot;</span><span class="p">,</span>
                  <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wavelength [$\AA$]&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Flux Difference [$erg\ s^{-1}\ cm^{-2}\ \AA^{-1}$]&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bd_products_dir</span><span class="si">}</span><span class="s2">/flux_differential.png&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/da8e121276bf2fff76f3811017807cb8249d9e6e9ef37648fe81d0ba2eca5b30.png" src="../../../_images/da8e121276bf2fff76f3811017807cb8249d9e6e9ef37648fe81d0ba2eca5b30.png" />
<img alt="../../../_images/09dfd1a2d79b9d94a309a8391e2df5de878e792fd6eeef5d4985050ea449ea48.png" src="../../../_images/09dfd1a2d79b9d94a309a8391e2df5de878e792fd6eeef5d4985050ea449ea48.png" />
</div>
</div>
</section>
</section>
</section>
<section id="congrats-on-completing-the-notebook">
<h1>Congrats on completing the notebook!<a class="headerlink" href="#congrats-on-completing-the-notebook" title="Permalink to this heading">#</a></h1>
<section id="there-are-more-tutorial-notebooks-for-custom-co-addition-cases-in-this-repo-check-them-out">
<h2>There are more tutorial notebooks for custom co-addition cases in <a class="reference external" href="https://github.com/spacetelescope/hst_notebooks/tree/main/notebooks/HASP">this repo</a>, check them out!<a class="headerlink" href="#there-are-more-tutorial-notebooks-for-custom-co-addition-cases-in-this-repo-check-them-out" title="Permalink to this heading">#</a></h2>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this heading">#</a></h2>
<p><strong>Author:</strong> Sierra Gomez (sigomez&#64;stsci.edu)</p>
<p><strong>Updated on:</strong> 01/02/2024</p>
<p><em>This tutorial was generated to be in compliance with the <a class="reference external" href="https://github.com/spacetelescope/style-guides">STScI style guides</a> and would like to cite the <a class="reference external" href="https://github.com/spacetelescope/style-guides/blob/master/templates/example_notebook.ipynb">Jupyter guide</a> in particular.</em></p>
</section>
<section id="citations">
<h2>Citations<a class="headerlink" href="#citations" title="Permalink to this heading">#</a></h2>
<p>If you use the following packages for published research, please cite the authors. Follow these links for more information about citations:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.astropy.org/en/stable/index.html">Citing <code class="docutils literal notranslate"><span class="pre">astropy</span></code></a></p></li>
<li><p><a class="reference external" href="https://astroquery.readthedocs.io/en/latest/">Citing <code class="docutils literal notranslate"><span class="pre">astroquery</span></code></a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/stable/users/project/citing.html">Citing <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></p></li>
<li><p><a class="reference external" href="https://numpy.org/citing-numpy/">Citing <code class="docutils literal notranslate"><span class="pre">numpy</span></code></a></p></li>
<li><p><a class="reference external" href="https://scipy.org/citing-scipy/">Citing <code class="docutils literal notranslate"><span class="pre">scipy</span></code></a></p></li>
</ul>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png"><img alt="Space Telescope Logo" src="https://raw.githubusercontent.com/spacetelescope/notebooks/master/assets/stsci_pri_combo_mark_horizonal_white_bkgd.png" style="width: 200px;" /></a>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/hst_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/HASP/CoaddTutorial"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Inputting User Data using the Hubble Advanced Spectral Products Script</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-font-weight-normal-this-notebook-is-designed-to-walk-you-through-downloading-and-using-the-hubble-advanced-spectral-products-hasp-co-add-script-span"><span style="font-weight:normal">This Notebook is designed to walk you through downloading and using the <strong>Hubble Advanced Spectral Products (HASP)</strong> co-add script.</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-goals">Learning Goals:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">0. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-hst-spectroscopic-data">1. Downloading HST Spectroscopic Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-astroquery-to-download-stis-data">1.1 Using <code class="docutils literal notranslate"><span class="pre">Astroquery</span></code> to Download STIS Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-co-add-script">2. Running the Co-add Script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-co-added-data-products">3. Working with Co-added Data Products</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#understanding-the-output-files">3.1 Understanding the Output Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#viewing-the-co-added-data">3.2 Viewing the Co-added Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together-with-cos-data">3.3 Putting it all together with COS data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#changing-the-threshold-flag">4. Changing the Threshold Flag</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#downloading-the-data">4.1 Downloading the Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-co-add-script-with-different-threshold-values">4.2 Running the Co-add Script with Different Threshold Values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-the-different-co-added-spectra-of-different-threshold-values">4.3 Analyzing the Different Co-added Spectra of Different Threshold Values</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#looking-at-snr">Looking at SNR:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#looking-at-flux">Looking at Flux:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#congrats-on-completing-the-notebook">Congrats on completing the notebook!</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#there-are-more-tutorial-notebooks-for-custom-co-addition-cases-in-this-repo-check-them-out">There are more tutorial notebooks for custom co-addition cases in this repo, check them out!</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#citations">Citations</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>